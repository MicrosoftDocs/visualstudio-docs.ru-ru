---
title: В пакете SDK для Visual Studio | Документация Майкрософт
description: Сведения о расширениях в пакете SDK для Visual Studio, включая архитектуру Visual Studio, компоненты, службы, схемы и служебные программы.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- roadmap, Visual Studio integration SDK
- Visual Studio integration SDK roadmap
- integration roadmap, Visual Studio SDK
ms.assetid: 9118eaa4-0453-4dc5-9e16-c7062d254869
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: e11ee862f43ead3605d8e07dc159e18da13413b8
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105074708"
---
# <a name="inside-the-visual-studio-sdk"></a>Компоненты пакета SDK для Visual Studio

В этом разделе содержатся подробные сведения о расширениях Visual Studio, включая архитектуру Visual Studio, компоненты, службы, схемы, служебные программы и т. д.

## <a name="extensibility-architecture"></a>Архитектура расширяемости
 На следующем рисунке показана архитектура расширяемости Visual Studio. Пакеты VSPackage предоставляют функциональные возможности приложения, которые совместно используются в IDE как службы. Стандартная интегрированная среда разработки также предлагает широкий спектр служб, таких как <xref:Microsoft.VisualStudio.Shell.Interop.SVsUIShell> , которые предоставляют доступ к функциональности окон интегрированной среды разработки.

 ![График архитектуры среды](../../extensibility/internals/media/environment.gif "среда") Обобщенное представление архитектуры Visual Studio

## <a name="vspackages"></a>VSPackages
 Пакеты VSPackage — это программные модули, которые образуют и расширяют среду Visual Studio с помощью элементов пользовательского интерфейса, служб, проектов, редакторов и конструкторов. Пакеты VSPackage являются центральной структурной единицей Visual Studio. Дополнительные сведения см. в разделе [VSPackages](../../extensibility/internals/vspackages.md).

## <a name="visual-studio-shell"></a>Visual Studio Shell
 Оболочка Visual Studio предоставляет базовые функциональные возможности и поддерживает перекрестную связь между компонентами VSPackage и расширениями MEF. Дополнительные сведения см. в разделе [оболочка Visual Studio](../../extensibility/internals/visual-studio-shell.md).

## <a name="user-experience-guidelines"></a>Руководство по работе пользователей
 Если вы планируете разрабатывать новые функции для Visual Studio, ознакомьтесь с рекомендациями по проектированию и удобства использования в [Visual Studio](../../extensibility/ux-guidelines/visual-studio-user-experience-guidelines.md).

## <a name="commands"></a>Команды
 Команды — это функции, которые выполняют задачи, например печать документа, обновление представления или создание нового файла.

 При расширении Visual Studio можно создавать команды и регистрировать их с помощью оболочки Visual Studio. Можно указать, как эти команды будут отображаться в интегрированной среде разработки, например, в меню или на панели инструментов. Обычно пользовательская команда отображается в меню **Сервис** , а команда для отображения окна инструментов отображается в подменю **другие окна** меню **вид** .

 При создании команды необходимо также создать для нее обработчик событий. Обработчик событий определяет, когда команда является видимой или включенной, позволяет изменить ее текст и гарантирует, что команда будет отвечать правильно при ее активации. В большинстве случаев интегрированная среда разработки обрабатывает команды с помощью <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейса. Команды в Visual Studio обрабатываются начиная с самого внутреннего контекста команды, в зависимости от локального выбора и перехода к самому внешнему контексту на основе глобального выбора. Команды, добавленные в главное меню, становятся сразу доступными для использования в сценариях.

 Дополнительные сведения см. в разделе [команды, меню и панели инструментов](../../extensibility/internals/commands-menus-and-toolbars.md).

## <a name="menus-and-toolbars"></a>Меню и панели инструментов
 Меню и панели инструментов дают пользователям возможность вызывать команды. Меню — это строки или столбцы команд, которые обычно отображаются как отдельные текстовые элементы в верхней части окна инструментов. Подменю — это вторичные меню, которые появляются, когда пользователь щелкает команды, которые содержат маленькую стрелку. Контекстные меню появляются, когда пользователь щелкает правой кнопкой мыши определенные элементы пользовательского интерфейса. Некоторые распространенные имена меню: **файл**, **Правка**, **вид** и **окно**. Дополнительные сведения см. в разделе [Расширение меню и команд](../../extensibility/extending-menus-and-commands.md).

 Панели инструментов — это строки или столбцы кнопок и других элементов управления, таких как поля со списком, списки и текстовые поля. Кнопки панели инструментов обычно имеют значки изображений, например значок папки для команды **Открыть файл** или принтер для команды **Печать** . Все элементы панели инструментов связаны с командами. При нажатии кнопки на панели инструментов выполняется связанная с ней команда. В случае с элементом управления "раскрывающийся список" каждый элемент в раскрывающемся списке связан с другой командой. Некоторые элементы управления панели инструментов, например элемент управления "разделитель", являются гибридными. Одной из сторон элемента управления является кнопка панели инструментов, а другая — стрелка вниз, на которой отображается несколько команд при ее нажатии.

## <a name="tool-windows"></a>Окна инструментов
 Окна инструментов используются в интегрированной среде разработки для вывода сведений. Примерами окон инструментов могут быть **панель элементов**, **Обозреватель решений**, окно **свойств** и **веб-браузер** .

 Окна инструментов обычно предлагают различные элементы управления, с которыми пользователь может взаимодействовать. Например, окно **Свойства** позволяет пользователю задавать свойства объектов, которые служат конкретной цели. В этом смысле окно **свойств** является специализированным, но также общим, поскольку его можно использовать во многих разных ситуациях. Аналогичным образом, окно **вывода** является специализированным, так как оно предоставляет текстовый вывод, но, в целом, так как многие подсистемы в Visual Studio могут использовать его для предоставления выходных данных пользователю Visual Studio.

 Рассмотрим следующую картину Visual Studio, которая содержит несколько окон инструментов:

 ![Снимок экрана](../../extensibility/internals/media/t1gui.png "T1gui")

 Некоторые окна инструментов закреплены на одной панели, которая отображает окно инструментов обозреватель решений и скрывает другие окна инструментов, но делает их доступными, щелкая вкладки. На рисунке показаны два других окна инструментов: окно **Список ошибок** и **вывод** , закрепленное на одной панели.

 Также показана основная область документа, в которой показано несколько окон редактора. Хотя окна инструментов обычно имеют только один экземпляр (например, можно открыть только один **Обозреватель решений**), окна редактора могут иметь несколько экземпляров, каждый из которых используется для редактирования отдельного документа, но все они закреплены в одной и той же области. На рисунке изображена область документа с двумя окнами редактора, одним окном конструктора форм. Все окна в области документа доступны, если щелкнуть вкладки, но окно редактора, содержащее файл Едиторпане. cs, является видимым и активным.

 При расширении Visual Studio можно создавать окна инструментов, которые позволяют пользователям Visual Studio взаимодействовать с расширением. Вы также можете создавать собственные редакторы, позволяющие пользователям Visual Studio редактировать документы. Так как окна инструментов и редакторы будут интегрированы в Visual Studio, вам не нужно программировать их для закрепления или появления на вкладке правильно. Если они правильно зарегистрированы в Visual Studio, они будут автоматически иметь стандартные возможности окон инструментов и окон документов в Visual Studio. Дополнительные сведения см. в разделе [расширение и настройка окон инструментов](../../extensibility/extending-and-customizing-tool-windows.md).

## <a name="document-windows"></a>Окна документов
 Окно документа — это дочернее окно с фреймами в окне многодокументного интерфейса (MDI). Окна документов обычно используются для размещения текстовых редакторов, редакторов форм (также известных как конструкторы) или редактирования элементов управления, но они также могут размещать другие функциональные типы. Диалоговое окно **новый файл** содержит примеры окон документов, предоставляемых Visual Studio.

 Большинство редакторов относятся к языку программирования или к типу файлов, например к HTML-страницам, наборам рамок, файлам C++ или файлам заголовков. Если выбрать шаблон в диалоговом окне « **новый файл** », то пользователь динамически создаст окно документа для редактора для типа файлов, связанного с шаблоном. Окно документа также создается, когда пользователь открывает существующий файл.

 Окна документов ограничены клиентской областью MDI. Каждое окно документа содержит вкладку сверху, а порядок табуляции связан с другими окнами, которые могут быть открыты в области MDI. Если щелкнуть правой кнопкой мыши вкладку в окне документа, откроется контекстное меню, содержащее параметры разделения области MDI на несколько горизонтальных или вертикальных групп вкладок. Разделение области MDI позволяет одновременно просматривать несколько файлов. Дополнительные сведения см. в разделе [окна документов](../../extensibility/internals/document-windows.md).

## <a name="editors"></a>Редакторы
 Редактор Visual Studio позволяет настроить и использовать его для собственного типа содержимого с помощью Managed Extensibility Framework (MEF). Во многих случаях не требуется создавать пакет VSPackage для расширения редактора, хотя если требуется включить функции из оболочки (например, команду меню или сочетание клавиш), можно объединить расширение MEF с пакетом VSPackage.

 Можно также создать пользовательский редактор, например, если вы хотите выполнять чтение и запись в базу данных или использовать конструктор. Также можно использовать внешний редактор, например Блокнот или Microsoft WordPad. Дополнительные сведения см. в разделе [расширения редактора и языковой службы](../../extensibility/editor-and-language-service-extensions.md).

## <a name="language-services"></a>Языковые службы
 Если требуется, чтобы редактор Visual Studio поддерживал новые ключевые слова программирования или даже новый язык программирования, вы создадите языковую службу. Каждая языковая служба может полностью, частично или вообще реализовывать определенные функции редактора. В зависимости от того, как оно настроено, языковая служба может выделять синтаксические конструкции, подсветка синтаксиса, поддержку IntelliSense и другие функции редактора.

 Основой языковой службы являются средства синтаксического анализа и сканера. Сканер (или лексический анализатор) делит исходный файл на элементы, известные как маркеры, а средство синтаксического анализа устанавливает связи между этими маркерами. При создании языковой службы необходимо реализовать средство синтаксического анализа и сканер, чтобы Visual Studio могла понять маркеры и грамматику языка. Можно создать управляемые или неуправляемые языковые службы. Дополнительные сведения см. в разделе [устаревшая расширяемость языковой службы](../../extensibility/internals/legacy-language-service-extensibility.md).

## <a name="projects"></a>Проекты

В Visual Studio проекты — это контейнеры, используемые разработчиками для Организации и построения исходного кода и других ресурсов. Проекты позволяют упорядочивать, собирать, отлаживать и развертывать исходный код, ссылки на веб-службы и базы данных, а также другие ресурсы. Пакеты VSPackage могут расширять систему проектов Visual Studio, предоставляя типы проектов, подтипы проектов и пользовательские инструменты.

Проекты также можно собирать вместе в *решении*, которое представляет собой группу из одного или нескольких проектов, совместно работающих с созданием приложения. Сведения о проекте и состоянии, относящиеся к решению, хранятся в двух файлах решения: файле решения на основе текста [(SLN)](solution-dot-sln-file.md) и файле двоичного [параметра пользователя решения (. suo)](solution-user-options-dot-suo-file.md). Эти файлы похожи на файлы группы (. ВБГ), которые использовались в более ранних версиях Visual Basic, а также файлы рабочей области (DSW) и параметры пользователя (. opt), которые использовались в более ранних версиях C++.

Дополнительные сведения см. в разделе [проекты](../../extensibility/internals/projects.md) и [решения](../../extensibility/internals/solutions-overview.md).

## <a name="project-and-item-templates"></a>Шаблоны проектов и элементов
 Visual Studio включает стандартные шаблоны проектов и шаблоны элементов проектов. Вы также можете создавать собственные шаблоны или получать шаблоны из сообщества, а затем интегрировать их в Visual Studio. [Коллекция кода MSDN](https://code.msdn.microsoft.com/site/search?query=visual%20studio) — это место для шаблонов и расширений.

 Шаблоны содержат структуру проекта и основные файлы, необходимые для построения определенного типа приложения, элемента управления, библиотеки или класса. Если вы хотите разрабатывать программное обеспечение, похожее на один из шаблонов, создайте проект на основе шаблона, а затем измените файлы в этом проекте.

> [!NOTE]
> Эта архитектура шаблонов не поддерживается для [!INCLUDE[vcprvc](../../code-quality/includes/vcprvc_md.md)] проектов.

 Дополнительные сведения см. в разделе [Добавление шаблонов проектов и элементов проектов](../../extensibility/internals/adding-project-and-project-item-templates.md).

## <a name="properties-and-options"></a>Свойства и параметры
 В окне **Свойства** отображаются свойства одного или нескольких выбранных элементов: [расширение свойств](../../extensibility/internals/extending-properties.md) страницы параметры содержат наборы параметров, относящихся к конкретному компоненту, например язык программирования или страницы пакета VSPackage: [Options и Options](../../extensibility/internals/options-and-options-pages.md). Параметры обычно могут быть импортированы и экспортированы с учетом пользовательского интерфейса: [Поддержка параметров пользователя](../../extensibility/internals/support-for-user-settings.md).

## <a name="visual-studio-services"></a>Службы Visual Studio
 Служба предоставляет конкретный набор интерфейсов для использования компонентами. Visual Studio предоставляет набор служб, которые могут использоваться любыми компонентами, включая расширения. Например, службы Visual Studio позволяют динамически отображать или скрывать окна инструментов, предоставлять доступ к справке, строке состояния или событиям пользовательского интерфейса. Редактор Visual Studio также предоставляет службы, которые можно импортировать с помощью расширений редактора. Дополнительные сведения см. [в разделе Использование и предоставление служб](../../extensibility/using-and-providing-services.md).

## <a name="debugger"></a>Отладчик
 Отладчик — это пользовательский интерфейс для компонентов отладки, зависящих от языка. Если вы создали новую языковую службу, необходимо будет создать конкретный модуль отладки для подключения к отладчику. Дополнительные сведения см. в разделе [расширяемость отладчика Visual Studio](../../extensibility/debugger/visual-studio-debugger-extensibility.md).

## <a name="source-control"></a>Система управления версиями
 Сведения о реализации подключаемого модуля системы управления версиями или VSPackage см. в разделе [система управления](../../extensibility/internals/source-control.md)версиями.

## <a name="wizards"></a>Мастера
 Мастер можно создать в сочетании с новым типом проекта, чтобы мастер мог помочь пользователям принять правильные решения при создании нового проекта этого типа. Дополнительные сведения см. в разделе [мастера](../../extensibility/internals/wizards.md).

## <a name="custom-tools"></a>Настраиваемые средства
 Пользовательские средства позволяют связать средство с элементом в проекте и запускать его при каждом сохранении файла. Дополнительные сведения см. в разделе [Custom Tools](../../extensibility/internals/custom-tools.md).

## <a name="vssdk-utilities"></a>Служебные программы VSSDK
 VSSDK включает набор служебных программ, которые могут потребоваться для работы с различными аспектами пакетов VSPackage. Дополнительные сведения см. в статье [VSSDK Utilities](../../extensibility/internals/vssdk-utilities.md).

## <a name="using-windows-installer"></a>Использование установщик Windows
 В некоторых случаях может потребоваться использовать установщик Windows, а не установщик VSIX. Например, может потребоваться запись в реестр. Сведения об использовании установщик Windows с расширениями см. в разделе [Установка пакетов VSPackage с помощью установщик Windows](../../extensibility/internals/installing-vspackages-with-windows-installer.md).

## <a name="help-viewer"></a>Help Viewer
 Вы можете интегрировать собственную справку и страницы F1 в окно справки. Дополнительные сведения см. в разделе [окно справки (Майкрософт) SDK](../../extensibility/internals/microsoft-help-viewer-sdk.md).
