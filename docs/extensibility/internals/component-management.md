---
title: Управление компонентами | Документация Майкрософт
description: Узнайте, как управлять компонентами установщик Windows при создании установщика VSPackage в Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- installation [Visual Studio SDK], components
- installation [Visual Studio SDK], file management
ms.assetid: 029bffa2-6841-4caa-a41a-442467e1aedc
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 9767af4c30957111526303600f9e8eda815b42f0
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105057095"
---
# <a name="component-management"></a>Управление компонентами
Единицы задач в установщик Windows называются установщик Windows компонентами (иногда называются Викс или просто компонентами). Идентификатор GUID определяет каждый компонент WIC, который является базовой единицей установки и подсчетом ссылок для настроек, использующих установщик Windows.

 Хотя для создания установщика VSPackage можно использовать несколько продуктов, в этом обсуждении предполагается использование файлов установщик Windows (*. msi*). При создании установщика необходимо правильно управлять развертыванием файлов, чтобы обеспечить правильное подсчет ссылок. Следовательно, разные версии продукта не мешают друг другу в сочетании сценариев установки и удаления.

 В установщик Windows подсчет ссылок выполняется на уровне компонентов. Необходимо тщательно организовать ресурсы (файлы, записи реестра и т. д.) в компоненты. Существуют и другие уровни Организации, такие как модули, функции и продукты, которые могут помочь в различных сценариях. Дополнительные сведения см. в статье [установщик Windows основы](../../extensibility/internals/windows-installer-basics.md).

## <a name="guidelines-of-authoring-setup-for-side-by-side-installation"></a>Рекомендации по созданию программы установки для параллельной установки

- Файлы и ключи реестра, которые являются общими для всех версий, входят в их собственные компоненты.

     Это позволяет легко использовать их в следующей версии. Например, библиотеки типов, которые зарегистрированы глобально, расширения файлов, другие элементы, зарегистрированные в **HKEY_CLASSES_ROOT** и т. д.

- Сгруппируйте общие компоненты в отдельные модули слияния.

     Эта стратегия поможет вам правильно разработать параллельную установку.

- Установите общие файлы и разделы реестра, используя одни и те же компоненты установщик Windows в разных версиях.

     Если используется другой компонент, то файлы и записи реестра удаляются при удалении одного пакета VSPackage, но другой пакет VSPackage по-прежнему устанавливается.

- Не следует смешивать элементы с версиями и общие в одном и том же компоненте.

     Это делает невозможным установку общих элементов в глобальном расположении и элементов с версиями в изолированные расположения.

- Не имеют общих разделов реестра, указывающих на файлы с версиями.

     В противном случае общие ключи будут перезаписаны при установке другой версии VSPackage. После удаления второй версии файл, на который указывает ключ, исчезнет.

## <a name="see-also"></a>См. также
- [Выбор между общими и версиями пакетов VSPackage](../../extensibility/choosing-between-shared-and-versioned-vspackages.md)
- [Сценарии установки VSPackage](../../extensibility/internals/vspackage-setup-scenarios.md)
