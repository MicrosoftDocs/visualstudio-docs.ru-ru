---
title: Выбор каталога установки для VSPackage | Документация Майкрософт
description: Узнайте, как выбрать каталог установки для VSPackage и его вспомогательных файлов, используя такие факторы, как управление и управление.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- VSPackages, installation directory
ms.assetid: 01fbbb5b-f747-446c-afe0-2a081626a945
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 6442a8475c862693b851be783ae85bbb0a2e90af
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105082118"
---
# <a name="choose-the-installation-directory-for-a-vspackage"></a>Выберите каталог установки для VSPackage
Пакет VSPackage и его вспомогательные файлы должны находиться в файловой системе пользователя. Расположение зависит от того, является ли VSPackage управляемым или неуправляемым, вашей параллельной схемой управления версиями и выбором пользователя.

## <a name="unmanaged-vspackages"></a>Неуправляемые пакеты VSPackage
 Неуправляемый пакет VSPackage — это COM-сервер, который можно установить в любом расположении. Сведения о регистрации должны точно отражать свое расположение. Пользовательский интерфейс установщика должен предоставлять расположение по умолчанию в качестве подкаталога для `ProgramFilesFolder` значения свойства установщик Windows. Пример:

*&lt;ProgramFilesFolder &gt; \\ &lt; MyCompany &gt; \\ &lt; мивспаккажепродукт &gt; \V1.0\\*

 Пользователю следует разрешить изменять каталог по умолчанию для размещения пользователей, которые хранят небольшой загрузочный раздел и предпочитают устанавливать приложения и средства на другой том.

 Если ваша Параллельная схема использует пакет VSPackage с версией, можно использовать подкаталоги для хранения разных версий. Пример:

 *&lt;ProgramFilesFolder &gt; \\ &lt; MyCompany &gt; \\ &lt; мивспаккажепродукт &gt; \\ v 1.0 \\ 2002\\*

 *&lt;ProgramFilesFolder &gt; \\ &lt; MyCompany &gt; \\ &lt; мивспаккажепродукт &gt; \\ v 1.0 \\ 2003\\*

 *&lt;ProgramFilesFolder &gt; \\ &lt; MyCompany &gt; \\ &lt; мивспаккажепродукт &gt; \\ v 1.0 \\ 2005\\*

## <a name="managed-vspackages"></a>Управляемые пакеты VSPackage
 Управляемые пакеты VSPackage также можно установить в любом расположении. Однако рекомендуется всегда устанавливать их в глобальный кэш сборок (GAC), чтобы сократить время загрузки сборки. Поскольку управляемые пакеты VSPackage всегда являются сборками со строгими именами, их установка в глобальном кэше сборок означает, что их проверка с помощью подписи строгих имен выполняется только во время установки. Сборки со строгими именами, установленные где-либо в файловой системе, должны проверять свои подписи при каждой загрузке. При установке управляемых пакетов VSPackage в глобальный кэш сборок используйте параметр **/Assembly** средства regpkg для записи записей реестра, указывающих на строгое имя сборки.

 Если управляемые пакеты VSPackage устанавливаются в расположении, отличном от GAC, следуйте предыдущему Совету, указанному для неуправляемых пакетов VSPackage, для выбора иерархий каталогов. Используйте параметр **/CodeBase** средства regpkg для записи записей реестра, указывающих на путь сборки VSPackage.

 Дополнительные сведения см. в разделе [Регистрация и Отмена регистрации пакетов VSPackage](../../extensibility/registering-and-unregistering-vspackages.md).

## <a name="satellite-dlls"></a>вспомогательные библиотеки DLL
 По соглашению вспомогательные DLL-библиотеки VSPackage, которые содержат ресурсы для определенного языкового стандарта, находятся в подкаталогах каталога *VSPackage* . Подкаталоги соответствуют значениям кода локали (LCID).

 В статье Управление пакетами [VSPackage](../../extensibility/managing-vspackages.md) указано, что записи реестра определяют, где [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] фактически ищет вспомогательную библиотеку DLL VSPackage. Однако [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] пытается загрузить вспомогательную библиотеку DLL в подкаталог, имя которого имеет значение LCID, в следующем порядке:

1. LCID по умолчанию (код языка Visual Studio, например, *\ 1033* для английского языка)

2. LCID по умолчанию с подязыковым языком по умолчанию.

3. КОД по умолчанию для системы.

4. Системный LCID по умолчанию с подязыковым языком по умолчанию.

5. Американский английский (*. \ 1033* или *.\0x409*).

Если библиотека DLL VSPackage содержит ресурсы, а запись реестра **сателлитедлл\дллнаме** указывает на него, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] пытается загрузить их в указанном порядке.

## <a name="see-also"></a>См. также
- [Выбор между общими и версиями пакетов VSPackage](../../extensibility/choosing-between-shared-and-versioned-vspackages.md)
- [Управление пакетами VSPackage](../../extensibility/managing-vspackages.md)
- [Управление регистрацией пакетов](/previous-versions/bb166783(v=vs.100))