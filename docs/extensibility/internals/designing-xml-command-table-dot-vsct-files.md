---
title: Создание XML-таблицы команд (. Vsct) файлы | Документация Майкрософт
description: Узнайте, как спроектировать файл XML-таблицы команд (. vsct), описывающий макет и внешний вид элементов команд, включая кнопки, поля со списком, меню и панели инструментов.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- VSCT files, designing
ms.assetid: bb87a322-bac4-4258-92bc-9a876f05d653
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 3d6409b5e624cd8596e669f191b2644aaf27a88c
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105090932"
---
# <a name="design-xml-command-table-vsct-files"></a>Разработка файлов XML-таблицы команд (. vsct)
Файл XML-таблицы команд (*. vsct*) описывает макет и внешний вид элементов команд для VSPackage. К элементам команды относятся кнопки, поля со списком, меню, панели инструментов и группы элементов команд. В этой статье описываются XML-файлы командных таблиц, их влияние на элементы команд и меню, а также способы их создания.

## <a name="commands-menus-groups-and-the-vsct-file"></a>Команды, меню, группы и файл. vsct
 *Vsct* файлы организованы вокруг команд, меню и групп команд. XML-теги в файле *. vsct* представляют каждый из этих элементов вместе с другими связанными элементами, такими как кнопки команд, размещение команд и точечные рисунки.

 Когда вы создаете новый пакет VSPackage, запустив [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] шаблон пакета, шаблон создает *vsct* -файл с необходимыми элементами для команды меню, окна инструментов или пользовательского редактора в зависимости от выбранных параметров. Этот *vsct* -файл можно изменить в соответствии с требованиями конкретного пакета VSPackage. Примеры изменения *vsct* -файла см. в разделе [Расширение меню и команд](../../extensibility/extending-menus-and-commands.md).

 Сведения о создании нового пустого *vsct* -файла см. в разделе [как создать файл *vsct*](../../extensibility/internals/how-to-create-a-dot-vsct-file.md). После создания в файл добавляются XML-элементы, атрибуты и значения, описывающие макет элемента команды. Подробную схему XML см. в [справочнике по XML-схеме VSCT](../../extensibility/vsct-xml-schema-reference.md).

## <a name="differences-between-ctc-and-vsct-files"></a>Различия между файлами. CTC и. vsct
 Хотя смысл тегов XML в *vsct* -файле совпадает с тегами в устаревшем формате файла *. CTC* , их реализация немного отличается:

- Новый **\<extern>** тег — это место, где вы ссылаетесь на другие *h* -файлы для компиляции, например файлы для [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] панели инструментов.

- Несмотря на то, что файлы *. vsct* поддерживают инструкцию **/include** , как и файлы *CTC* , он также включает в себя новый **\<import>** элемент. Разница заключается в том, что **/include** переносит *всю* информацию, в то же время **\<import>** выводит только имена.

- Хотя для файлов *. CTC* требуется файл заголовка, в котором определяются директивы препроцессора, он не требуется для *vsct* -файлов. Вместо этого поместите директивы в таблицу символов, расположенную в **\<Symbol>** элементах, расположенном в нижней части файла *vsct* .

- файлы *. vsct* имеют **\<Annotation>** тег, который позволяет внедрять любые нужные сведения, например примечания или даже изображения.

- Значения хранятся в качестве атрибутов элемента.

- Флаги команд можно хранить по отдельности или с пометкой.  Однако технология IntelliSense не работает для флагов команд с накоплением. Дополнительные сведения о флагах команд см. в описании [элемента CommandFlag](../../extensibility/command-flag-element.md).

- Можно указать несколько типов, например разделенные раскрывающиеся списки, КомБОС и т. д.

- Идентификаторы GUID не проверяются.

- Каждый элемент пользовательского интерфейса имеет строку, представляющую отображаемый текст.

- Родительский элемент является необязательным. Если этот параметр опущен, используется *неизвестная группа* значений.

- Аргумент *Icon* является необязательным.

- Раздел точечного рисунка. Этот раздел аналогичен в файле *CTC* , за исключением того, что теперь можно указать имя файла через href, которое будет запрошено компилятором *vsct.exe* во время компиляции.

- ResID: можно использовать старый идентификатор ресурса точечного рисунка, который по-прежнему работает так же, как в *CTC* -файлах.

- HRef: новый метод, позволяющий указать имя файла для ресурса точечного рисунка. Предполагается, что используются все, поэтому можно опустить использованный раздел. Компилятор сначала ищет локальные ресурсы для файла, а затем на всех общих ресурсах и ресурсах, определенных параметром **/i** .

- Настраиваемое сочетание клавиш: вам больше не нужно указывать эмулятор. Если указать один из них, компилятор считает, что редактор и эмулятор одинаковы.

- Кэйчорд: Кэйчорд был удален. Новый формат: *Key1, Mod1, Key2, Mod2*.  Можно указать символьную, шестнадцатеричную или VK константу.

Новый компилятор, *vsct.exe*, компилирует файлы *. CTC* и *. vsct* . Однако старый компилятор *ctc.exe* не распознает и не компилирует файлы *vsct* .

Для преобразования существующего *CTO* -файла в *vsct* -файл можно использовать компилятор *vsct.exe* . Дополнительные сведения см. в разделе [инструкции. Создание vsct-файла из существующего CTO-файла](../../extensibility/internals/how-to-create-a-dot-vsct-file.md#how-to-create-a-dot-vsct-file-from-an-existing-dot-cto-file).

## <a name="the-vsct-file-elements"></a>Элементы файла. vsct
 Командная таблица имеет следующую иерархию и элементы:

- [Элемент коммандтабле](../../extensibility/commandtable-element.md): представляет все команды, группы меню и меню, связанные с VSPackage.

- [Внешний элемент](../../extensibility/extern-element.md): ссылается на все внешние h файлы, которые необходимо объединить с *vsct* .

- [Включить элемент](../../extensibility/include-element.md): ссылается на любые дополнительные файлы заголовка (h), которые необходимо скомпилировать вместе с *vsct* -файлом. Файл *. vsct* может включать *h* -файлы, содержащие константы, определяющие команды, группы меню и меню, предоставляемые интегрированной средой разработки или другим пакетом VSPackage.

- [Элемент Commands](../../extensibility/commands-element.md): представляет все отдельные команды, которые могут быть выполнены. У каждой команды есть следующие четыре дочерних элемента:

- [Элемент Menus](../../extensibility/menus-element.md): представляет все меню и панели инструментов в VSPackage. Меню — это контейнеры для групп команд.

- [Элемент Groups](../../extensibility/groups-element.md): представляет все группы в VSPackage. Группы представляют собой коллекции отдельных команд.

- [Элемент Buttons](../../extensibility/buttons-element.md): представляет все кнопки команд и пункты меню в VSPackage. Кнопки — это визуальные элементы управления, которые могут быть связаны с командами.

- [Растровый элемент](../../extensibility/bitmaps-element.md): представляет все растровые изображения для всех кнопок в VSPackage. Точечные рисунки — это изображения, отображаемые рядом с кнопками или на их кнопке в зависимости от контекста.

- [Элемент CommandPlacements](../../extensibility/commandplacements-element.md): указывает дополнительные расположения, в которых отдельные команды должны быть размещены в меню VSPackage.

- [Элемент висибилитиконстраинтс](../../extensibility/visibilityconstraints-element.md): определяет, отображается ли команда в любое время или только в определенных контекстах, например при отображении определенного диалогового окна или окна. Меню и команды со значением для этого элемента будут отображаться только в том случае, если указан активный контекст. По умолчанию команда отображается всегда.

- [Элемент сочетания клавиш](../../extensibility/keybindings-element.md): задает все сочетания клавиш для команд. Это значит, что одно или несколько сочетаний клавиш, которые необходимо нажать для выполнения команды, например **CTRL** + **S**.

- [Элемент уседкоммандс](../../extensibility/usedcommands-element.md): информирует [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] среду о том, что хотя указанная команда реализована другим кодом, когда текущий пакет VSPackage активен, он предоставляет реализацию команды.

- [Элемент Symbols](../../extensibility/symbols-element.md): содержит имена символов и идентификаторы GUID для всех команд в пакете.

## <a name="vsct-file-design-guidelines"></a>рекомендации по проектированию файлов vsct
 Для успешного проектирования *vsct* -файла следуйте приведенным ниже рекомендациям.

- Команды могут размещаться только в группах, группы могут быть помещены только в меню, а меню могут быть помещены только в группы. В интегрированной среде разработки отображаются только меню, а группы и команды — нет.

- Подменю не могут быть непосредственно назначены меню, но должны быть назначены группе, которая, в свою очередь, назначена меню.

- Команды, подменю и группы могут быть назначены одной родительской группе или меню с помощью родительского поля их определяющей директивы.

- Упорядочение командной таблицы исключительно через родительские поля в директивах имеет значительное ограничение. Директивы, определяющие объекты, могут принимать только один родительский аргумент.

- Повторное использование команд, групп или подменю требует использования новой директивы для создания нового экземпляра объекта с собственной `GUID:ID` парой.

- Каждая `GUID:ID` пара должна быть уникальной. Повторное использование команды, которая, например, была размещена в меню, на панели инструментов или в контекстном меню, обрабатывается <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейсом.

- Команды и подменю также могут быть назначены нескольким группам, а группы могут быть назначены нескольким меню с помощью [элемента Commands](../../extensibility/commands-element.md).

## <a name="vsct-file-notes"></a>Заметки о файле. vsct
 Если вы вносите изменения в *vsct* -файл после компиляции и помещаете его во встроенную ВСПОМОГАТЕЛЬНУЮ библиотеку DLL, следует запустить **devenv.exe/Setup/носетупвстемплатес**. Это приводит к принудительному повторному считыванию ресурсов VSPackage, указанных в экспериментальном реестре, и внутренней базы данных, которая описывает [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Перестроение.

 Во время разработки несколько проектов VSPackage можно создать и зарегистрировать в экспериментальном кусте реестра, что может привести к путанице в интегрированной среде разработки. Чтобы устранить эту проблему, можно сбросить экспериментальный куст до параметров по умолчанию, чтобы удалить все зарегистрированные пакеты VSPackage и изменения, которые они могли внести в интегрированную среду разработки. Чтобы сбросить экспериментальный куст, используйте средство CreateExpInstance.exe, поставляемое с пакетом SDK для Visual Studio. Его можно найти по адресу:

 *% PROGRAMFILES (x86)% \ SDK\VisualStudioIntegration\Tools\Bin\CreateExpInstance.exeVisual Studio \\ \<version>*

 Запустите средство с помощью команды **CreateExpInstance/Reset**. Помните, что это средство удаляет из экспериментального Hive все зарегистрированные пакеты VSPackage, которые обычно не устанавливаются вместе с [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] .

## <a name="see-also"></a>См. также
- [Расширение меню и команд](../../extensibility/extending-menus-and-commands.md)
