---
title: Как установить подключаемый модуль системы управления версиями | Документация Майкрософт
description: Узнайте, как установить подключаемый модуль системы управления версиями в Visual Studio, интегрируя его с помощью API подключаемого модуля системы управления версиями Visual Studio и зарегистрировав его библиотеку DLL.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
helpviewer_keywords:
- installation [Visual Studio SDK], source control plug-ins
- source control plug-ins, installing
ms.assetid: 9e2e01d9-7beb-42b2-99b2-86995578afda
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 4a0798cb7763ff2766d2de2bb00a80759be8fd3e
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105078816"
---
# <a name="how-to-install-a-source-control-plug-in"></a>Как установить подключаемый модуль системы управления версиями
Создание подключаемого модуля системы управления версиями состоит из трех этапов:

1. Создайте библиотеку DLL с функциями, определенными в разделе Справочник по API подключаемого модуля системы управления версиями этой документации.

2. Реализуйте определяемые API-функции подключаемого модуля системы управления версиями. При [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] вызове для него интерфейсы и диалоговые окна можно сделать доступными из подключаемого модуля.

3. Зарегистрируйте библиотеку DLL, сделав соответствующие записи в реестре.

## <a name="integration-with-visual-studio"></a>Интеграция с Visual Studio
 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] поддерживает подключаемые модули системы управления версиями, которые соответствуют интерфейсу API подключаемого модуля системы управления версиями.

### <a name="register-the-source-control-plug-in"></a>Регистрация подключаемого модуля системы управления версиями
 Прежде чем запустить интегрированную среду разработки (IDE) в системе управления версиями, сначала необходимо найти библиотеку DLL подключаемого модуля системы управления версиями, которая экспортирует API.

#### <a name="to-register-the-source-control-plug-in-dll"></a>Регистрация библиотеки DLL подключаемого модуля системы управления версиями

1. Добавьте две записи в раздел **HKEY_LOCAL_MACHINE** в подразделе **программного обеспечения** , в котором указан подраздел названия организации, а затем — подраздел Product Name. Шаблон имеет **\\ \<company name> \\HKEY_LOCAL_MACHINE\SOFTWARE\<product name> \\ значение \<entry>**  =  . Две записи всегда называются **скксервернаме** и **скксерверпас**. Каждый является обычной строкой.

    Например, если название компании — Microsoft, а продукт системы управления версиями имеет имя SourceSafe, то этот путь реестра будет **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe**. В этом подразделе первая запись, **скксервернаме**, является понятным для пользователя строковым именем вашего продукта. Вторая запись, **скксерверпас**, представляет собой полный путь к библиотеке DLL подключаемого модуля системы управления версиями, к которой должна подключаться интегрированная среда разработки. Ниже приведены примеры записей реестра.

   |Пример записи реестра|Образец значения|
   |---------------------------|------------------|
   |HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\SCCServerName|Microsoft Visual SourceSafe|
   |HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\SCCServerPath|*c:\vss\win32\ssscc.dll*|

   > [!NOTE]
   > Скксерверпас — это полный путь к подключаемому модулю SourceSafe. Подключаемый модуль системы управления версиями будет использовать разные названия компаний и продуктов, но те же пути к записям реестра.

2. Для изменения поведения подключаемого модуля системы управления версиями можно использовать следующие необязательные записи реестра. Эти записи попадают в тот же подраздел, что и **скксервернаме** и **скксерверпас**.

   - Запись **хидеинвисуалстудиорегистри** можно использовать, если не требуется, чтобы подключаемый модуль системы управления версиями отображался в списке **выбора подключаемых модулей** [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] . Эта запись также влияет на автоматическое переключение на подключаемый модуль системы управления версиями. Один из возможных вариантов использования этой записи заключается в том, что вы предоставляете пакет управления версиями, который заменяет подключаемый модуль системы управления версиями, но вы хотите упростить миграцию пользователя из использования подключаемого модуля системы управления версиями в пакет управления версиями. После установки пакета системы управления версиями он задает эту запись реестра, которая скрывает подключаемый модуль.

      **Хидеинвисуалстудио** является значением типа DWORD и имеет значение *1* , чтобы скрыть подключаемый модуль или *0* для отображения подключаемого модуля. Если запись реестра не отображается, по умолчанию используется режим отображения подключаемого модуля.

   - Запись реестра **дисаблесккманажер** может использоваться для отключения или скрытия пункта меню **" \<Source Control Server> Запуск** ", который обычно отображается в   >  подменю "**система управления версиями** файлов". При выборе этого пункта меню вызывается функция [сккрунскк](../../extensibility/sccrunscc-function.md) . Подключаемый модуль системы управления версиями может не поддерживать внешнюю программу, поэтому может потребоваться отключить или даже скрыть пункт меню " **Пуск** ".

      **Дисаблесккманажер** является значением типа DWORD и имеет значение *0* , чтобы включить команду меню " **\<Source Control Server> Пуск** ", значение " *1* ", чтобы отключить пункт меню, и значение " *2* ", чтобы скрыть пункт меню. Если эта запись реестра не отображается, в качестве поведения по умолчанию отображается пункт меню.

   | Пример записи реестра | Образец значения |
   | - |--------------|
   | HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\HideInVisualStudio | 1 |
   | HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\DisableSccManager | 1 |

3. Добавьте подраздел **саурцекодеконтролпровидер** в раздел **HKEY_LOCAL_MACHINE** в подразделе **программное обеспечение** .

    В этом подразделе для записи реестра **провидеррегкэй** задана строка, представляющая подраздел, который вы поместили в реестре на шаге 1. Шаблон — это **HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider\ProviderRegKey**  =  *программное обеспечение \\<название компании \> \\<\> Название продукта*.

    Ниже приведен пример содержимого для этого подраздела.

   |Запись реестра|Образец значения|
   |--------------------|------------------|
   |HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider\ProviderRegKey|софтваре\микрософт\саурцесафе|

   > [!NOTE]
   > Подключаемый модуль системы управления версиями будет использовать те же имена подраздела и записи, но значение будет другим.

4. Создайте подраздел с именем **инсталледсккпровидерс** в подразделе **саурцекодеконтролпровидер** , а затем поместите одну запись в этот подраздел.

    Имя этой записи — понятное пользователю имя поставщика (то же, что и значение, указанное для записи Скксервернаме), а значение — еще раз — подраздел, созданный на шаге 1. Шаблон — это **HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider\InstalledSCCProviders\\<отображаемое \> имя**  =  *программное обеспечение \\<название компании \> \\<название \> продукта*.

    Пример:

   |Пример записи реестра|Образец значения|
   |---------------------------|------------------|
   |HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider\InstalledSCCProviders\Microsoft Visual SourceSafe|софтваре\микрософт\саурцесафе|

   > [!NOTE]
   > Таким способом может быть зарегистрировано несколько подключаемых модулей системы управления версиями. Таким способом выполняется [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Поиск всех установленных подключаемых модулей на основе API управления версиями.

## <a name="how-an-ide-locates-the-dll"></a>Обнаружение библиотеки DLL в интегрированной среде разработки
 В [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] интегрированной среде разработки есть два способа поиска библиотеки DLL подключаемого модуля системы управления версиями:

- Найдите подключаемый модуль системы управления версиями по умолчанию и подключитесь к нему автоматически.

- Найти все зарегистрированные подключаемые модули системы управления версиями, из которых пользователь выбирает одну из них.

  Чтобы найти библиотеку DLL первым способом, интегрированная среда разработки ищет в подразделе **HKEY_LOCAL_MACHINE\Software\SourceCodeControlProvider** запись **провидеррегкэй**. Значение этой записи указывает на другой подраздел. Затем интегрированная среда разработки ищет запись с именем **скксерверпас** во втором подразделе в разделе **HKEY_LOCAL_MACHINE**. Значение этой записи указывает среде IDE на библиотеку DLL.

> [!NOTE]
> Интегрированная среда разработки не загружает библиотеки DLL из относительных путей (например, *.\NewProvider.DLL*). Необходимо указать полный путь к библиотеке DLL (например, *c:\Providers\NewProvider.DLL*). Это позволяет усилить безопасность интегрированной среды разработки, предотвращая несанкционированные или олицетворенные подключаемые модули DLL.

 Чтобы найти библиотеку DLL вторым образом, интегрированная среда разработки ищет в подразделе **HKEY_LOCAL_MACHINE\Software\SourceCodeControlProvider\InstalledSCCProviders** все записи. У каждой записи есть имя и значение. Интегрированная среда разработки отображает список этих имен для пользователя. Когда пользователь выбирает имя, интегрированная среда разработки находит значение для выбранного имени, которое указывает на подраздел. Интегрированная среда разработки ищет запись с именем **скксерверпас** в этом подразделе в разделе **HKEY_LOCAL_MACHINE**. Значение этой записи указывает среде IDE на правильную библиотеку DLL.

 Подключаемый модуль системы управления версиями должен поддерживать оба способа поиска библиотеки DLL и, следовательно, задает **провидеррегкэй**, перезаписывая все предыдущие параметры. Что более важно, он должен добавить себя в список **инсталледсккпровидерс** , чтобы пользователь мог выбрать используемый подключаемый модуль системы управления версиями.

> [!NOTE]
> Поскольку используется ключ **HKEY_LOCAL_MACHINE** , в качестве подключаемого модуля системы управления версиями по умолчанию на данном компьютере можно зарегистрировать только один подключаемый модуль системы управления версиями (тем не менее, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] пользователи могут определить, какой подключаемый модуль системы управления версиями будет использоваться для конкретного решения). В процессе установки проверьте, установлен ли уже подключаемый модуль системы управления версиями. Если да, попросите пользователя указать, следует ли устанавливать новый подключаемый модуль системы управления версиями по умолчанию. Во время удаления не удаляйте другие подразделы реестра, общие для всех подключаемых модулей системы управления версиями в **HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider**; Удалите только определенный подраздел SCC.

## <a name="how-the-ide-detects-version-1213-support"></a>Как интегрированная среда разработки обнаруживает поддержку версии 1.2/1.3
 Как [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] обнаруживает, поддерживает ли подключаемый модуль интерфейс API подключаемого модуля системы управления версиями 1,2 и 1,3? Чтобы объявить дополнительные возможности, подключаемый модуль системы управления версиями должен реализовать соответствующую функцию:

 Сначала [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] проверяет значение, возвращаемое вызовом [сккжетверсион](../../extensibility/sccgetversion-function.md). Оно должно быть больше или равно 1,2.

 Затем [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] определяет, поддерживается ли конкретная новая возможность, путем проверки `lpSccCaps` аргумента в [скЦинитиализе](../../extensibility/sccinitialize-function.md).

 Если выполняются оба этих условия, можно вызывать новые функции, поддерживаемые в версиях 1,2 и 1,3.

## <a name="see-also"></a>См. также
- [Начало работы с подключаемыми модулями системы управления версиями](../../extensibility/internals/getting-started-with-source-control-plug-ins.md)
