---
title: Запрос на изменение запроса Save (пакет VSPackage системы управления версиями) | Документация Майкрософт
description: Сведения о роли Query-Edit Query-Save событий и их обработке пакетом VSPackage системы управления версиями.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- QEQS events
- Query Edit Query Save events
- source control packages, Query Edit Query Save events
ms.assetid: c360d2ad-fe42-4d65-899d-d1588cc8a322
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 9295644a07a1840cd4874b8bfff298ad9d46c928
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105060917"
---
# <a name="query-edit-query-save-source-control-vspackage"></a>Изменение и сохранение запроса (пакет VSPackage системы управления версиями)
[!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Редакторы могут транслировать события сохранения запроса на изменение (QEQS). [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Заглушка системы управления версиями реализует службу QEQS, так что она является получателем событий QEQS. Затем эти события делегируются в текущий активный пакет VSPackage системы управления версиями. В пакете VSPackage активной системы управления версиями реализован <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2> метод и его методы. Методы `IVsQueryEditQuerySave2` интерфейса обычно вызываются непосредственно перед тем, как документ будет изменен в первый раз и непосредственно перед сохранением документа.

## <a name="queryeditquerysave-events"></a>События Куередиткуерисаве
 Пакет VSPackage системы управления версиями должен выполнять обработку событий QEQS, реализуя `IVsQueryEditQuerySave2` интерфейс и необходимые методы. Ниже приведено краткое описание двух методов, которые пакет VSPackage должен реализовать как минимум. Фактическая реализация должна соответствовать логике модели системы управления версиями.

### <a name="queryeditfiles-method"></a>Метод Куередитфилес
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2.QueryEditFiles%2A>Вызывается, когда любой проект или редактор желает изменить файл. В идеале этот метод вызывается *перед* изменением файла и при сохранении файла. При вызове `IVsQueryEditQuerySave2::QueryEditFiles` метод проверяет, находятся ли заданные файлы в системе управления версиями, нужно ли их извлечь и можно ли их перезагрузить. Если обстоятельства не позволяют изменять файлы, `IVsQueryEditQuerySave2::QueryEditFiles` метод сообщает вызывающей программе о необходимости отмены изменения. Также возможно, что вызывающий объект может указать режим вызова. В режиме "без уведомления" Этот метод принимает действия только в том случае, если он не вызывает отображения пользовательского интерфейса. Если пользовательский интерфейс недоступен, должен быть возвращен флаг, указывающий на проблему.

 Метод ведет себя в транзакционном режиме; то есть, если изменение отменено для одного файла, изменение отменяется для всех файлов. И наоборот, если изменение разрешено, оно разрешается для всех файлов. Если этот метод позволяет изменить один раз для заданного набора файлов, он должен всегда разрешать изменение в последующих вызовах для одного и того же набора файлов. Цикл Allow-Edit сохраняется до тех пор, пока файлы не будут закрыты, сохранены и загружены. до изменения атрибутов (свойств); или до изменения пакета системы управления версиями. В число вариантов, которые следует учитывать при реализации `IVsQueryEditQuerySave2::QueryEditFiles` метода, входят несколько файлов, Специальные файлы, отмена от пользователя и редактирование в памяти.

### <a name="querysavefiles-method"></a>Метод Куерисавефилес
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2.QuerySaveFiles%2A>Вызывается, когда любой проект или редактор должен сохранить набор файлов. При вызове `IVsQueryEditQuerySave2::QuerySaveFiles` метод проверяет, доступны ли заданные файлы только для чтения, а также они находятся в системе управления версиями. Если файлы необходимо извлечь, вызов делегируется пакету управления версиями. Если обстоятельства препятствуют сохранению файлов, `IVsQueryEditQuerySave2::QuerySaveFiles` метод должен сообщить редактору о необходимости отмены сохранения. Как и в `IVsQueryEditQuerySave2::QueryEditFiles` случае с методом, вызывающий объект может указать режим вызова. В режиме "без уведомления" Этот метод принимает действия только в том случае, если он не вызывает отображения пользовательского интерфейса. Если пользовательский интерфейс недоступен, должен быть возвращен флаг, указывающий на проблему.

 Этот метод должен вести себя в транзакционном режиме; то есть, если сохранение отменено для одного файла, сохранение отменяется для всех файлов. И наоборот, если сохранение разрешено, оно должно быть разрешено для всех файлов. Как и в `IVsQueryEditQuerySave2::QueryEditFiles` случае с методом, варианты, которые следует учитывать при реализации `IVsQueryEditQuerySave2::QuerySaveFiles` метода, включают несколько файлов, Специальные файлы, отмену от пользователя и изменения в памяти.

## <a name="see-also"></a>См. также
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2>
