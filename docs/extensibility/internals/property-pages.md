---
title: Страницы свойств | Документация Майкрософт
description: Сведения о работе со страницами свойств нового типа проектов в пакете SDK для Visual Studio, позволяющих пользователям просматривать и изменять свойства проекта.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- configuration options, changing properties
- property pages
- property pages, changing configuration options
ms.assetid: b9b3e6e8-1e30-4c89-9862-330265dcf38c
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: f3e36960b35119434e56f075f622ae2513454dd6
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105061021"
---
# <a name="property-pages"></a>Страницы свойств
Пользователи могут просматривать и изменять свойства, зависящие от конфигурации проекта, с помощью страниц свойств. Кнопка **страницы свойств** доступна в окне **свойства** или на панели инструментов Обозреватель решений для объектов, предоставляющих представление страницы свойств выбранного объекта. Страницы свойств создаются средой и доступны для решений и проектов. Однако они также могут быть доступны для элементов проекта, которые используют свойства, зависящие от конфигурации. Эта возможность может использоваться, если для правильной сборки файлов в проекте требуются различные параметры коммутатора компилятора.

## <a name="using-property-pages"></a>Использование страниц свойств
 Если страница свойств уже отображена и выбрано изменение (например, из решения в проект), сведения, отображаемые на страницах, изменяются для отображения свойств нового выделения. Если в объекте, поддерживающем страницы свойств, нет свойств, страница свойств будет пустой.

 Если выбрано несколько объектов, на странице свойств отображается пересечение свойств всех выбранных элементов. Если выбранный элемент не содержит свойства, зависящие от конфигурации, и нажата кнопка **страницы свойств** на панели инструментов Обозреватель решений, сосредоточьте изменения в окно свойств. Дополнительные сведения о окно свойств и выборе см. в разделе [расширение свойств](../../extensibility/internals/extending-properties.md).

 Если свойства отображаются для нескольких объектов и вы изменяете значение на странице свойств, всем значениям для объектов присваивается новое значение, даже если они были изначально различны, а страница была пустой при отображении свойств отдельного объекта.

 В доступны два общих типа диалоговых окон **Прожектпроперти Pages** [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] . Например, в первом случае для Visual Basic проектов страницы свойств отображаются с использованием формата полей, как показано на следующем снимке экрана. Во втором, показанном далее в этом разделе, на странице свойств размещается сетка свойств, аналогичная той, которая находится в окне Свойства.

 ![Страницы свойств Visual Basic](../../extensibility/internals/media/vsvbproppages.gif "всвбпроппажес") Диалоговое окно "страницы свойств проекта" с форматом поля и структурой дерева

 Древовидная структура в диалоговом окне страницы свойств не построена с помощью <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> . Среда, на основе имени уровня, переданного ему <xref:Microsoft.VisualStudio.OLE.Interop.ISpecifyPropertyPages> <xref:Microsoft.VisualStudio.Shell.Interop.IVsPropertyPage> интерфейсом и, создает его.

 На страницах свойств доступны только две категории верхнего уровня [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] :

- Общие свойства, которые отображают независимые от конфигурации сведения для выбранного объекта или объектов. В результате, если выбрана одна из подкатегорий «общие свойства», параметры Конфигурация, платформа и Configuration Manager в верхней части диалогового окна недоступны.

- Свойства конфигурации, которые содержат зависящую от конфигурации информацию, относящуюся к отладке, оптимизации и параметрам сборки для решения или проекта.

  Нельзя создавать дополнительные категории верхнего уровня, но вы можете не отображать одну или другую в своей реализации `IVsPropertyPage` . Если, например, у вас нет независимых от конфигурации свойств для вывода объекта, можно отказаться от вывода категории Общие свойства. Вы можете отобразить общие свойства `ISpecifyPropertyPages` , если реализуется из объекта обзора и свойств конфигурации при реализации `ISpecifyPropertyPages` в объекте конфигурации (объект, реализующий `IVsCfg` , `IVsProjectCfg` и связанные интерфейсы).

  Каждая категория, отображаемая в категории верхнего уровня, представляет отдельную страницу свойств. Записи категории и подкатегории, доступные в диалоговом окне, определяются вашей реализацией `ISpecifyPropertyPages` и `IVsPropertyPage` .

  `IDispatch` объекты для элементов в контейнере выбора, которые имеют свойства, отображаемые на страницах свойств, реализуют `ISpecifyPropertyPages` для перечисления списка идентификаторов классов. Идентификаторы классов передаются в виде переменных в `ISpecifyPropertyPages` и используются для создания экземпляров страниц свойств. Список идентификаторов классов также передается в, `IVsPropertyPage` чтобы создать древовидную структуру в левой части диалогового окна. Затем страницы свойств передают данные обратно в `IDispatch` объект, который реализует `ISpecifyPropertyPages` и заполняет сведения для каждой страницы.

  Свойства объекта Browse извлекаются с помощью `IDispatch` для каждого объекта в контейнере выбора.

  Реализация `Help::DisplayTopicFromF1Keyword` в VSPackage предоставляет функциональные возможности кнопки "Справка".

  Дополнительные сведения см `IDispatch` `ISpecifyPropertyPages` . в разделе и в библиотеке MSDN.

  Второй тип страниц свойств, отображаемых в примерах, содержит форму сетки свойств, как показано на следующем снимке экрана.

  ![Страницы свойств VC](../../extensibility/internals/media/vsvcproppages.gif "всвкпроппажес") Диалоговое окно "страницы свойств" со свойством "Сетка"

  Интерфейсы `IVSMDPropertyBrowser` и `IVSMDPropertyGrid` (объявленные в всманажед. h) используются для создания и заполнения сетки свойств в диалоговом окне или окне.

  Архитектура проектов значительно изменилась с прошлых версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] . В частности, понятие о том, какой проект является активным, изменился. В службах [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] нет концепции активного проекта. В предыдущих средах разработки активным проектом был проект, который команды сборки и развертывания будут использовать по умолчанию независимо от контекста. Теперь решение управляет и единолично, какие команды сборки и развертывания применяются к проектам.

  Ранее активный проект записывается одним из трех различных способов:

- Запускаемый проект

   Проект или проекты можно указать на странице свойств решения, которая будет запускаться, когда пользователь нажмет клавишу F5 или выберет пункт запустить из меню Сборка. Это работает аналогично старому активному проекту в том смысле, что его имя отображается в обозреватель решений с полужирным шрифтом.

   Запускаемый проект можно получить как свойство в модели автоматизации, вызвав метод `DTE.Solution.SolutionBuild.StartupProjects` . В VSPackage вы вызываете <xref:Microsoft.VisualStudio.Shell.Interop.IVsSolutionBuildManager2.get_StartupProject%2A> <xref:Microsoft.VisualStudio.Shell.Interop.IVsSolutionBuildManager2.get_StartupProject%2A> методы или. `IVsSolutionBuildManager` доступен в качестве службы `QueryService` на SID_SVsSolutionBuildManager. Дополнительные сведения см. в статье [объект конфигурации проекта](../../extensibility/internals/project-configuration-object.md) и [Конфигурация решения](../../extensibility/internals/solution-configuration.md).

- Активная конфигурация сборки решения

   [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] содержит активную конфигурацию решения, доступную в модели автоматизации путем реализации `DTE.Solution.SolutionBuild.ActiveConfiguration` . Конфигурация решения — это коллекция, которая содержит одну конфигурацию проекта для каждого проекта в решении (каждый проект может иметь несколько конфигураций на нескольких платформах со сходными именами). Дополнительные сведения о страницах свойств решения см. в разделе [Конфигурация решения](../../extensibility/internals/solution-configuration.md).

- Текущий выбранный проект

   Реализуйте <xref:Microsoft.VisualStudio.Shell.Interop.IVsMonitorSelection.GetCurrentSelection%2A> метод, чтобы получить выбранную иерархию проекта, элемент или элементы проекта. В DTE используются `SelectedItems.SelectedItem.Project` `SelectedItems.SelectedItem.ProjectItem` методы и. В этих заголовках в основных документах содержится пример кода [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] .

## <a name="see-also"></a>См. также
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsPropertyPage>
- [Управление параметрами конфигурации](../../extensibility/internals/managing-configuration-options.md)
- [Объект конфигурации проекта](../../extensibility/internals/project-configuration-object.md)
- [Конфигурация решения](../../extensibility/internals/solution-configuration.md)
