---
title: Предоставление автоматизации для пакетов VSPackage | Документация Майкрософт
description: Узнайте, как обеспечить автоматизацию пакетов VSPackage путем реализации объектов, зависящих от VSPackage, и реализации стандартных объектов автоматизации.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- VSPackages, automation [Visual Studio SDK]
- automation [Visual Studio SDK], VSPackages
ms.assetid: 104c4c55-78b8-42f4-b6b0-9a334101aaea
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 1f9a19b5e0e543052dad492ab319595c8ef76dfe
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105060956"
---
# <a name="providing-automation-for-vspackages"></a>Предоставление автоматизации для пакетов VSPackage
Существует два основных способа предоставления автоматизации для пакетов VSPackage: путем реализации объектов, зависящих от VSPackage, и реализации стандартных объектов автоматизации. Как правило, они используются совместно для расширения модели автоматизации среды.

## <a name="vspackage-specific-objects"></a>VSPackage-Specific объекты
 Для некоторых мест в модели автоматизации необходимо предоставить объекты автоматизации, которые являются уникальными для VSPackage. Например, для новых проектов требуются отдельные объекты, которые предоставляет только пакет VSPackage. Имена этих объектов записываются в реестр и получаются посредством вызовов к `DTE` объекту среды.

 Объекты, относящиеся к VSPackage, также могут быть получены, когда потребитель автоматизации использует объект, предоставленный через свойство объекта стандартного объекта. Например, Стандартный `Window` объект имеет `Object` свойство, которое, как правило, называется `Windows.Object` свойством. Когда потребители вызывают метод в `Window.Object` окне, реализованном в VSPackage, вы передаете собственный объект автоматизации для собственного проекта.

#### <a name="projects"></a>Проекты
 Пакеты VSPackage могут расширять модель автоматизации для новых типов проектов с помощью собственных объектов VSPackage. Основной целью предоставления новых объектов автоматизации для VSPackage является различение уникальных объектов проекта от <xref:Microsoft.VisualStudio.VCProjectEngine.VCProject> или <xref:VSLangProj80.VSProject2> объекта. Такая разница удобна, если вы хотите предоставить возможность одиночного или итерации типа проекта отдельно от других типов проектов, если они будут параллельно отображаться в решении. Дополнительные сведения см. в разделе [предоставление доступа к объектам проекта](../../extensibility/internals/exposing-project-objects.md).

#### <a name="events"></a>События
 Архитектура событий среды предлагает другое место для добавления собственных объектов VSPackage. Например, создавая собственные уникальные объекты событий, можно расширить модель событий среды для проектов. При добавлении нового элемента в собственный тип проекта может потребоваться предоставить собственные события. Дополнительные сведения см. в разделе [предоставление событий](../../extensibility/internals/exposing-events-in-the-visual-studio-sdk.md).

#### <a name="window-objects"></a>Объекты окон
 Windows может передать объект автоматизации, зависящий от VSPackage, обратно в среду при вызове. Вы реализуете объект, производный от <xref:Microsoft.VisualStudio.Shell.Interop.IVsExtensibleObject> , <xref:EnvDTE.IExtensibleObject> или `IDispatch` который перемещает свойства, расширяя объект окна, в котором он размещается. Например, этот подход можно использовать для предоставления автоматизации для элемента управления, управляемого в рамке окна. Семантика этого объекта и любых других объектов, которые он может расширять, можно спроектировать. Дополнительные сведения см. [в разделе руководство. предоставление автоматизации для Windows](../../extensibility/internals/how-to-provide-automation-for-windows.md).

#### <a name="options-pages-on-the-tools-menu"></a>Страницы параметров в меню "Сервис"
 Вы можете создавать страницы для расширения средств, настройки модели автоматизации путем реализации страниц и добавления сведений в реестр для создания собственных параметров. Затем страницы можно вызывать с помощью объектной модели среды, как и любые другие страницы параметров. Если для разработки компонента, добавляемого в среду через пакеты VSPackage, требуются страницы параметров, следует также добавить поддержку автоматизации. Дополнительные сведения см. в разделе [Поддержка автоматизации для страниц параметров](../../extensibility/internals/automation-support-for-options-pages.md).

## <a name="standard-automation-objects"></a>Стандартные объекты автоматизации
 Для расширения автоматизации проектов также реализуются стандартные объекты автоматизации (производные от `IDispatch` ), которые находятся рядом с другими объектами проекта и реализуют стандартные методы и свойства. Примерами стандартных объектов являются объекты проекта, которые вставляются в иерархию решения, например `Projects` , `Project` , `ProjectItem` и `ProjectItems` . Каждый новый тип проекта должен реализовывать эти объекты (и, возможно, другие в зависимости от семантики проекта).

 В определенном смысле эти объекты обеспечивают противоположное преимущество объектов проекта, характерных для VSPackage. Стандартные объекты автоматизации позволяют использовать проект в обобщенном виде, как и любой другой проект, поддерживающий одни и те же объекты. Таким словами, надстройка, написанная для общих `Project` объектов и, `ProjectItem` может работать с проектами любого типа. Дополнительные сведения см. в разделе [Моделирование проектов](../../extensibility/internals/project-modeling.md).
