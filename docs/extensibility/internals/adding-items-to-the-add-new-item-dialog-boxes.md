---
title: Добавление элементов в диалоговые окна "Добавление нового элемента" | Документация Майкрософт
description: Узнайте, как добавлять элементы в диалоговое окно Добавление нового элемента в Visual Studio, чтобы можно было отображать шаблоны и элементы проектов для использования в проектах.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Add New Item dialog box, adding items
ms.assetid: 2f70863b-425b-4e65-86b4-d6a898e29dc7
author: acangialosi
ms.author: anthc
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 1dbdb2f04ad5038941eeb9790efa9e05781def3f
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99969013"
---
# <a name="add-items-to-the-add-new-item-dialog-box"></a>Добавление элементов в диалоговое окно "Добавление нового элемента"
Процесс добавления элементов в диалоговое окно **Добавление нового элемента** начинается с разделов реестра. Как показано в следующих записях реестра, раздел **аддитемтемплатес** содержит путь и имя каталога, в котором помещаются элементы, доступные в диалоговом окне **Добавление нового элемента** .

> [!NOTE]
> Таблица, следующая непосредственно за сегментом кода, содержит дополнительные сведения о записи реестра.

 Этот раздел находится в разделе **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\14.0Exp\Projects**.

 Первым идентификатором GUID является CLSID для проектов этого типа. второй GUID указывает зарегистрированный тип проекта для шаблонов добавления элементов:

 **\\{C061DB26-5833-11D2-96F5-000000000000} \\ Аддитемтемплатес \\ темплатесдир \\ {ACEF4EB2-57CF-11d2-96F4-000000000000} \\ 1**

 **@** = #6

   =  \\ Темплатесдир &lt; Путь установки пакета SDK для Visual Studio &gt; \\ всинтегратион \\ &lt; сомефолдер &gt; \\ &lt; сомепаккаже &gt; \\ &lt; сомепрожект &gt; \\ &lt; сомепрожектитемс&gt;

 **Сортприорити** = DWORD: 00000064

| Имя | Тип | Данные (из *RGS* -файла) | Описание |
|------------------|-----------| - | - |
| @ (По умолчанию) | REG_SZ | #% IDS_ADDITEM_TEMPLATES_ENTRY% | Идентификатор ресурса для **добавления шаблонов элементов** . |
| Val Темплатесдир | REG_SZ | % TEMPLATE_PATH% \\ &lt; сомепрожектитемс&gt; | Путь к элементам проекта, отображаемым в диалоговом окне мастера **добавления нового элемента** . |
| Val Сортприорити | REG_DWORD | 100 ( [!INCLUDE[vcprx64](../../extensibility/internals/includes/vcprx64_md.md)] ) | Определяет порядок сортировки в узле дерева файлов, отображаемых в диалоговом окне " **Добавление нового элемента** ". |

> [!NOTE]
> Ниже приведены идентификаторы GUID для типов проектов Visual C# и Visual Basic.
> - [!INCLUDE[csprcs](../../data-tools/includes/csprcs_md.md)]: {FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}
> - [!INCLUDE[vbprvb](../../code-quality/includes/vbprvb_md.md)]: {F184B08F-C81C-45F6-A57F-5ABD9991F28F}

 Каталог, указанный для **темплатесдир**, который равен *% TEMPLATE_PATH% \\ &lt; сомепрожектитемс &gt;*, является узлом в левой части дерева диалогового окна " **Добавление нового элемента** ". Дополнительные элементы в дереве основаны на подкаталоге в этом корневом каталоге. Файлы, доступные для добавления в проект, являются элементами в правой области диалогового окна " **Добавление нового элемента** ".

 Как правило, в этой папке будут содержаться файлы шаблонов проекта, такие как шаблон HTML или *cpp* -файл, а также все *VSZ* -файлы для запуска мастеров. Для управления отображением элементов можно также включить файлы *VSDir* для локализации имен и значков каталогов. Локализованная строка — это заголовок, который отображается в диалоговом окне, представляющем этот узел в дереве диалогового окна **Добавление нового элемента** .

 Однако нет необходимости в одном файле *VSDir* . Для каждого элемента в каталоге может существовать один файл *VSDir* . Дополнительные сведения см. в разделе [файл мастера (VSZ)](../../extensibility/internals/wizard-dot-vsz-file.md) и [файлы описания каталога шаблонов (VSDir)](../../extensibility/internals/template-directory-description-dot-vsdir-files.md).

> [!NOTE]
> Файлы *VSDir* в каталогах шаблонов являются необязательными. Если нужно просто поместить элемент проекта в каталог и отобразить его в диалоговом окне **Добавление нового элемента** , можно поместить этот файл в каталог Templates, указанный в инструкции **темплатесдир** . Затем файл будет отображаться в правой области диалогового окна **Добавление нового элемента** для этого проекта. Однако если требуется отобразить локализованный заголовок для файла или значка, необходимо включить хотя бы один файл *VSDir* в каталог Templates.

## <a name="group-project-items"></a>Группирование элементов проекта
 Если вы хотите, чтобы группы шаблонов содержались в папках в дереве диалогового окна " **Добавление нового элемента** ", необходимо, чтобы в корневом каталоге шаблона были вложены подкаталоги с элементами в них. Когда диалоговое окно **Добавление нового элемента** отображается для пользователей, они также увидят вложенные папки и смогут выбирать из них элементы проекта.

 Приоритет сортировки в сегменте кода определяет, где этот каталог шаблона будет создан в дереве относительно других элементов узла дерева. Для диалогового окна **Добавление нового элемента** приоритет сортировки должен быть включен, чтобы элементы отображались в правильном расположении в диалоговом окне.

 Также можно реализовать <xref:Microsoft.VisualStudio.Shell.Interop.IVsFilterAddProjectItemDlg2> интерфейс для фильтрации элементов, отображаемых в диалоговом окне **Добавление нового элемента** . Реализуя этот интерфейс, можно настроить один каталог шаблонов на диске, который содержит, например, 50 шаблонов и файлов мастера. Таким образом можно использовать различные типы проектов с 20 файлами, принадлежащими одному типу проекта, а также к другим 30 файлам, принадлежащим к другому типу проекта, и ко всем файлам, доступным в общем типе проекта. Таким образом, в зависимости от того, какой шаблон проекта создан, можно отобразить другой набор файлов шаблонов.

 Например, в проекте Visual Basic могут существовать веб-проекты и проекты клиента. Веб-формы не являются полезными элементами для добавления в клиентский проект, а Windows Forms не являются полезными элементами для добавления в проект веб-сервера. Таким образом, можно создать один каталог шаблонов, содержащий все файлы для проектов обоих типов. Затем, реализовав <xref:Microsoft.VisualStudio.Shell.Interop.IVsFilterAddProjectItemDlg2> , можно скрыть элементы, которые не должны отображаться в зависимости от типа проекта или параметров проекта в проекте.

## <a name="filter-project-items"></a>Фильтрация элементов проекта
 `IVsFilterAddProjectItemDlg2` обеспечивает фильтрацию элементов в дереве (области слева) и файлы проекта (правая область) следующими способами.

- По локализованным именам (заголовкам, отображаемым в диалоговом окне, которое содержится в файле *VSDir* ), предоставленном `IVsFilterAddProjectItemDlg` .

- По фактическим именам файлов и папок на диске (без локализации — файл *VSDir* ), предоставляемый `IVsFilterAddProjectItemDlg` .

- По категории, предоставленной `IVsFilterAddProjectItemDlg2` .

  Чтобы отфильтровать по категории, укажите строку категории для элемента в файле *VSDir* , например *веб-формы* или *элемента клиента* в Visual Basic. Затем код диалогового окна извлекает классификацию категорий из файла *VSDir* и передает ее вам. Затем эти сведения можно передать в свою реализацию, `IVsFilterAddProjectItemDlg2` чтобы отфильтровать диалоговое окно **Добавление нового элемента** по категориям. Можно также отфильтровать элементы для веб-страниц или как сценарии клиентских приложений Win32. Кроме того, [!INCLUDE[vcprvc](../../code-quality/includes/vcprvc_md.md)] элементы с тегами можно обозначать как Microsoft Foundation Classes (MFC) или элементы библиотеки активных шаблонов (ATL). При определении этих элементов система проектов может определить собственные классификации, чтобы система могла фильтровать данные по категориям и классификациям.

  При реализации этой функции фильтра не нужно сопоставлять таблицу всех элементов, которые должны быть скрыты. Можно просто классифицировать элементы по типам и поместить классификации в *VSDir* файл или файлы. Затем можно скрыть любой элемент, имеющий определенную классификацию, путем реализации интерфейса. Таким образом, можно сделать элементы в диалоговом окне **Добавление нового элемента** динамически в зависимости от состояния в проекте.

## <a name="see-also"></a>См. также раздел
- <xref:Microsoft.VisualStudio.Shell.Interop.IVsFilterAddProjectItemDlg2>
- [Регистрация шаблонов проектов и элементов](../../extensibility/internals/registering-project-and-item-templates.md)
- [CATID для объектов, которые обычно используются для расширения проектов](../../extensibility/internals/catids-for-objects-that-are-typically-used-to-extend-projects.md)
- [Добавление шаблонов проектов и элементов проектов](../../extensibility/internals/adding-project-and-project-item-templates.md)
- [Файлы описания каталога шаблонов (VSDir)](../../extensibility/internals/template-directory-description-dot-vsdir-files.md)
- [Файл мастера (VSZ)](../../extensibility/internals/wizard-dot-vsz-file.md)
