---
title: Реализация подключаемого модуля системы управления версиями — рекомендации
description: Ознакомьтесь с этими техническими сведениями, чтобы обеспечить надежную реализацию подключаемого модуля системы управления версиями в Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- source control plug-ins, best practices
- best practices, source control plug-ins
- source control [Visual Studio SDK], plug-ins
ms.assetid: 85e73b73-29dc-464f-8734-ed308742c435
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: d64f195d13aca75b3b037ff14401395c03bd3d29
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105097361"
---
# <a name="best-practices-for-implementing-a-source-control-plug-in"></a>Рекомендации по реализации подключаемого модуля системы управления версиями
Следующие технические сведения помогут надежно реализовать подключаемый модуль системы управления версиями в [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] .

## <a name="memory-management-issues"></a>Проблемы управления памятью
 В большинстве случаев интегрированная среда разработки (IDE), которая является вызывающей стороной, освобождает и выделяет память. Подключаемый модуль системы управления версиями возвращает строки и другие элементы в буферах, выделенных вызывающим объектом. Исключения указаны в описаниях конкретных функций, где они происходят.

## <a name="arrays-of-file-names"></a>Массивы имен файлов
 При передаче массива файлов он не передается как непрерывный массив имен файлов. Он передается как массив указателей на имена файлов. Например, в [сккжет](../extensibility/sccget-function.md)имена файлов передаются `lpFileNames` параметром, где `lpFileNames` фактически является указателем на `char **` . `lpFileNames`[0] является указателем на первое имя, `lpFileNames` [1] является указателем на второе имя и т. д.

## <a name="large-model"></a>Большая модель
 Все указатели — это 32 бит, даже в 16-разрядных операционных системах.

## <a name="fully-qualified-paths"></a>Полные пути
 Если имена файлов или каталоги указаны в качестве аргументов, они должны быть полными путями или путями в формате UNC без окончания обратной косой черты. Чтобы перевести их в относительные пути, если это требование базовой системы управления версиями, отвечает подключаемый модуль системы управления версиями.

## <a name="specify-a-fully-qualified-path-for-the-registered-dll"></a>Укажите полный путь для зарегистрированной библиотеки DLL
 Интегрированная среда разработки больше не загружает библиотеки DLL из относительных путей (например, *.\NewProvider.dll*). Необходимо указать полный путь к библиотеке DLL (например, *C:\Providers\NewProvider.dll*). Это требование позволяет усилить безопасность интегрированной среды разработки, предотвращая несанкционированную или олицетворенную версию библиотек DLL системы управления версиями.

## <a name="check-for-an-existing-vssci-plug-in-when-you-install-your-source-control-plug-in"></a>Проверка наличия существующего подключаемого модуля ВССЦИ при установке подключаемого модуля системы управления версиями
 У пользователя, который планирует установить подключаемый модуль системы управления версиями, может уже быть установлен подключаемый модуль системы управления версиями на компьютере. Программа установки (программа установки) для создаваемого подключаемого модуля должна определить наличие существующих значений для соответствующих разделов реестра. Если эти ключи уже заданы, программа установки должна попросить пользователя зарегистрировать подключаемый модуль в качестве подключаемого модуля системы управления версиями по умолчанию и заменить уже установленный.

## <a name="error-result-codes-and-reporting"></a>Коды результатов ошибок и отчеты
 `SCC_OK`Код возврата для функции системы управления версиями указывает, что операция выполнена успешно для всех файлов. В случае сбоя операции ожидается возврат последнего обнаруженного кода ошибки.

 Правило для отчетности заключается в том, что если в интегрированной среде разработки возникает ошибка, интегрированная среда разработки несет ответственность за ее создание. Если в системе управления версиями возникает ошибка, подключаемый модуль системы управления версиями отвечает за ее создание. Например, интегрированной средой разработки **не будет выделено ни одного** файла, в то время как **этот файл уже извлечен** в отчет подключаемым модулем.

## <a name="the-context-structure"></a>Структура контекста
 Во время вызова [скЦинитиализе](../extensibility/sccinitialize-function.md)вызывающий объект передает `ppvContext` параметр, который представляет собой неинициализированный указатель на void. Подключаемый модуль системы управления версиями может игнорировать этот параметр, или он может выделить структуру любого типа и поместит указатель на эту структуру в переданный указатель. Интегрированная среда разработки не понимает эту структуру, но передает указатель на эту структуру в каждый другой вызов в подключаемом модуле. Это предоставляет полезные сведения о кэше контекста подключаемому модулю, который можно использовать для поддержания глобальных сведений о состоянии, сохраняющихся во всех вызовах функций, без использования глобальных переменных. Подключаемый модуль отвечает за освобождение структуры при вызове [сккунинитиализе](../extensibility/sccuninitialize-function.md).

 Если подключаемый модуль устанавливает `SCC_CAP_REENTRANT` бит в [скЦинитиализе](../extensibility/sccinitialize-function.md) (в частности, в `lpSccCaps` параметре), для трассировки всех открытых проектов используются несколько структур контекста.

## <a name="bitflags-and-other-command-options"></a>Битфлагс и другие параметры команды
 Для каждой команды, такой как [сккжет](../extensibility/sccget-function.md), в интегрированной среде разработки можно указать множество параметров, изменяющих поведение команды.

 API поддерживает настройку определенных параметров в интегрированной среде разработки с помощью `fOptions` параметра. Эти параметры описаны в [битфлагс, используемых конкретными командами](../extensibility/bitflags-used-by-specific-commands.md) вместе с командами, на которые они влияют. Как правило, это параметры, для которых пользователю не будет выдаваться запрос.

 Большинство параметров, настраиваемых пользователем, не определяются таким образом, так как они сильно отличаются от подключаемых модулей системы управления версиями. Поэтому рекомендуемый механизм является **дополнительной** кнопкой. Например, в диалоговом окне **Get** в интегрированной среде разработки отображаются только сведения, которые он понимает, но также отображается кнопка **Дополнительно** , если у подключаемого модуля есть параметры для этой команды. Когда пользователь нажимает кнопку " **Дополнительно** ", интегрированная среда разработки вызывает [SccGetCommandOptions](../extensibility/sccgetcommandoptions-function.md) , чтобы включить подключаемый модуль системы управления версиями для запроса сведений о пользователе, таких как битфлагс или Дата и время. Подключаемый модуль возвращает эти сведения в структуре, которая передается обратно во время выполнения `SccGet` команды.

## <a name="see-also"></a>См. также
- [Подключаемые модули системы управления версиями](../extensibility/source-control-plug-ins.md)
- [Создание подключаемого модуля системы управления версиями](../extensibility/internals/creating-a-source-control-plug-in.md)
