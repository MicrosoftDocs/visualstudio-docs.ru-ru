---
title: Обновление расширения Visual Studio
description: Узнайте, как обновить расширение Visual Studio для работы с Visual Studio 2022.
ms.date: 06/08/2021
ms.topic: conceptual
author: leslierichardson95
ms.author: lerich
manager: jmartens
monikerRange: vs-2022
ms.workload:
- vssdk
ms.openlocfilehash: 514c9654a741e4e1e565f0cb2becdbe3157fab0c
ms.sourcegitcommit: 5fb4a67a8208707e79dc09601e8db70b16ba7192
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "112308629"
---
# <a name="update-a-visual-studio-extension-for-visual-studio-2022"></a>Обновление расширения Visual Studio для Visual Studio 2022

Вы можете обновить расширение для работы с предварительной версией Visual Studio 2022, следуя указаниям в этом разделе. Visual Studio 2022 Preview — это 64-разрядное приложение, которое содержит некоторые критические изменения в пакете VS SDK. В этом руководстве описываются шаги, необходимые для того, чтобы расширение работало с текущим предварительным просмотром Visual Studio 2022, поэтому расширение может быть готово к установке пользователями, прежде чем Visual Studio 2022 достигнет общедоступной версии.

## <a name="installing"></a>Установка

Установите Visual Studio 2022 Preview из [Visual studio 2022 Preview downloads](https://visualstudio.microsoft.com/vs/preview/vs2022).

### <a name="extensions-written-in-a-net-language"></a>Расширения, написанные на языке .NET

Пакет VS SDK, предназначенный для Visual Studio 2022 для управляемых расширений, работает *исключительно* в NuGet:

- Мета-пакет [Microsoft. VisualStudio. SDK](https://www.nuget.org/packages/Microsoft.VisualStudio.Sdk/) (17. x версий) предоставляет большинство или все необходимые эталонные сборки.
- На пакет [Microsoft. VSSDK. BuildTools](https://www.nuget.org/packages/Microsoft.VSSDK.BuildTools/) (17. x) следует ссылаться из проекта VSIX, чтобы он мог создать VSIX-совместимый Visual Studio 2022.

Расширения *должны* быть скомпилированы с помощью платформы "любой ЦП" или "x64". Платформа x86 несовместима с 64-разрядным процессом Visual Studio 2022.

### <a name="extensions-written-in-c"></a>Расширения, написанные на C++

Пакет VS SDK для расширений, скомпилированных с помощью C++, доступен в установленном пакете SDK для Visual Studio, как обычно.

Расширения *должны* быть скомпилированы специально для пакета SDK для Visual Studio 2022 и для AMD64.

### <a name="update-your-extension-to-visual-studio-2022"></a>Обновите расширение до Visual Studio 2022

#### <a name="extensions-with-running-code"></a>Расширения с выполняющимся кодом

Расширения с выполняющимся кодом *должны* быть скомпилированы специально для Visual Studio 2022. Visual Studio 2022 не будет загружать никаких расширений, которые не предназначены для Visual Studio 2022.

Узнайте, как перенести предварительные версии расширений Visual Studio 2022 в Visual Studio 2022:

1. [Модернизировать проекты](#modernize-your-vsix-project).
1. [Рефакторинг исходного кода в общий проект](#use-shared-projects-for-multi-targeting) с целью предоставления возможности ориентироваться на Visual Studio 2022 и более ранние версии.
1. [Добавьте целевой проект VSIX Visual Studio 2022](#add-a-visual-studio-2022-target)и [таблицу пересопоставления пакетов и сборок](migrated-assemblies.md).
1. [Выполнение необходимых изменений кода](#handle-breaking-api-changes).
1. [Тестирование расширения Visual Studio 2022](#test-your-extension).
1. [Публикация расширения Visual Studio 2022](#publish-your-extension).

#### <a name="extensions-without-running-code"></a>Расширения без выполнения кода

Расширения, которые не содержат ни одного выполняемого кода (например, шаблонов проектов или элементов), *не* обязательно должны следовать приведенным выше шагам, включая производство двух различных VSIX-файлов.

Вместо этого необходимо изменить один VSIX, чтобы он `source.extension.vsixmanifest` объявил два целевого объекта установки следующим образом:

```xml
<Installation>
   <InstallationTarget Id="Microsoft.VisualStudio.Community" Version="[15.0,17.0)">
      <ProductArchitecture>x86</ProductArchitecture>
   </InstallationTarget>
   <InstallationTarget Id="Microsoft.VisualStudio.Community" Version="[17.0,18.0)">
      <ProductArchitecture>amd64</ProductArchitecture>
   </InstallationTarget>
</Installation>
```

Вы можете пропустить шаги, описанные в этой статье, об использовании общих проектов и нескольких VSIX. Вы можете продолжить [тестирование](#test-your-extension)!

> [!NOTE]
> Если вы создаете *новое* расширение Visual Studio, используя предварительную версию visual Studio 2022 и хотите (также) целевую версию visual Studio 2019 или более раннюю, ознакомьтесь с [этим руководством](target-previous-versions.md).

### <a name="msbuild-tasks"></a>Задачи MSBuild

При разработке задач MSBuild имейте в виду, что в Visual Studio 2022 гораздо более вероятно, что они будут загружены в 64-разрядный процесс MSBuild.exe. Если для выполнения задачи требуется 32-разрядный процесс, обратитесь к [документации по MSBuild](../../msbuild/how-to-configure-targets-and-tasks.md#usingtask-attributes-and-task-parameters) , чтобы убедиться, что MSBuild знает о необходимости загрузки задачи в 32-разрядном процессе.

## <a name="modernize-your-vsix-project"></a>Модернизировать проект VSIX

Прежде чем добавлять поддержку Visual Studio 2022 в расширение, мы настоятельно рекомендуем использовать это время, чтобы очистить и модернизировать существующий проект перед дальнейшим переходом, включая:

1. [Миграция с packages.config `PackageReference` на ](/nuget/consume-packages/migrate-packages-config-to-package-reference).

1. Замените все прямые ссылки на сборки пакета SDK VS сборки элементами PackageReference.

   ```diff
   -<Reference Include="Microsoft.VisualStudio.OLE.Interop" />
   +<PackageReference Include="Microsoft.VisualStudio.OLE.Interop" Version="..." />
   ```

   > [!TIP]
   > Вы можете заменить *множество* ссылок на сборки только *одним* PackageReferenceом на наш метапакет:
   >
   >```diff
   >-<Reference Include="Microsoft.VisualStudio.OLE.Interop" />
   >-<Reference Include="Microsoft.VisualStudio.Interop" />
   >-<Reference Include="Microsoft.VisualStudio.Interop.8.0" />
   >+<PackageReference Include="Microsoft.VisualStudio.Sdk" >Version="..." />
   >```

   Не забудьте выбрать версии пакета, которые соответствуют минимальным целевым версиям Visual Studio.

   Некоторые сборки, не являющиеся уникальными для пакета VS SDK (например, Newtonsoft.Json.dll), могут быть обнаружены с помощью простой `<Reference Include="Newtonsoft.Json" />` ссылки до выхода Visual studio 2022, но в Visual studio 2022 требуется ссылка на пакет, поскольку в Visual studio 2022 некоторые каталоги среды выполнения Visual Studio и пакета SDK можно удалить из пути поиска сборок по умолчанию MSBuild.

   При переключении с прямых ссылок на сборки на ссылки на пакет NuGet можно выбрать дополнительные ссылки на сборки и пакеты анализатора, так как NuGet автоматически устанавливает транзитивное замыкание зависимостей. Обычно это нормально, но может привести к пометке дополнительных предупреждений во время сборки. Обработайте эти предупреждения и разрешите столько, сколько можно, и рассмотрите возможность подавления этих предупреждений, которые нельзя разрешить с помощью в регионах в коде `#pragma warning disable <id>` .

## <a name="use-shared-projects-for-multi-targeting"></a>Использование общих проектов для многоплатформенного нацеливания

[Общие проекты](/xamarin/cross-platform/app-fundamentals/shared-projects?tabs=windows) — это тип проекта, который появился в Visual Studio 2015. Общие проекты в Visual Studio позволяют совместно использовать файлы исходного кода в нескольких проектах и выполнять сборку по-разному, используя символы условной компиляции и уникальные наборы ссылок.

Так как Visual Studio 2022 требуется отдельный набор эталонных сборок из всех предыдущих версий VS, мы предлагаем использовать общие проекты для удобного многоцелевого расширения для Visual Studio 2022 и Visual Studio 2022 (и более поздних версий), предоставляя вам возможность совместного использования кода, но различающиеся ссылки.

В контексте расширений Visual Studio у вас может быть один проект VSIX для Visual Studio 2022 и более поздней версии и один проект VSIX для Visual Studio 2019 и более ранних версий. Каждый из этих проектов будет содержать только, `source.extension.vsixmanifest` а пакет ссылается на пакет SDK 16. x или 17. x. Эти проекты VSIX также будут иметь ссылку на общий проект с новым общим проектом, в котором будет размещаться весь исходный код, который может совместно использоваться в двух версиях VS.

В качестве отправной точки в этом документе предполагается, что у вас уже есть проект VSIX, предназначенный для Visual Studio 2019, и вы хотите, чтобы ваше расширение работало в Visual Studio 2022.

Все эти действия можно выполнить с помощью Visual Studio 2019.

1. Если вы еще не сделали этого, [модернизировать проекты](#modernize-your-vsix-project) , чтобы упростить дальнейшие действия в этом процессе обновления.

1. Добавьте новый общий проект в решение для каждого существующего проекта, который ссылается на пакет SDK VS.
   ![Команда "добавить новый проект" ](media/update-visual-studio-extension/add-new-project.png)
    ![ новый шаблон проекта](media/update-visual-studio-extension/new-shared-project-template.png)

1. Добавьте ссылку из каждого проекта, ссылающегося на пакет VS SDK, на его аналог своего общего проекта.
   :::image type="content" source="media/update-visual-studio-extension/add-shared-project-reference.png" alt-text="Добавить ссылку на общий проект" lightbox="media/update-visual-studio-extension/add-shared-project-reference.png":::

1. Переместите весь исходный код (включая CS-, RESX) из каждого проекта, ссылающегося на VS SDK, на его аналог общего проекта.
Оставьте `source.extension.vsixmanifest` файл в проекте VSIX.
   ![Общий проект содержит все исходные файлы](media/update-visual-studio-extension/source-files-in-shared-project.png)

1. Файлы метаданных (заметки о выпуске, лицензии, значки и т. д.) и файлы VSCT должны быть перемещены в общий каталог и добавлены в проект VSIX в качестве связанных файлов.
   ![Добавление метаданных и файлов VSCT в качестве связанных файлов](media/update-visual-studio-extension/add-linked-items-to-vsix.png)
    - Для файлов метаданных задайте для свойства "действие" значение `Content` и задайте для параметра включить в VSIX значение `true` .

      ![Включение файлов метаданных в VSIX](./media/update-visual-studio-extension/include-metadata-files-in-vsix.png)
    - Для файлов VSCT задайте для свойства "автодействие" значение `VSCTCompile` и не включать в VSIX.
      Visual Studio может выпустить, что этот параметр не поддерживается, но можно вручную изменить действие сборки, выгрузив проект и изменив `Content` на `VSCTCompile`

    ```diff
    -<Content Include="..\SharedFiles\VSIXProject1Package.vsct">
    -  <Link>VSIXProject1Package.vsct</Link>
    -</Content>
    +<VSCTCompile Include="..\SharedFiles\VSIXProject1Package.vsct">
    +  <Link>VSIXProject1Package.vsct</Link>
    +  <ResourceName>Menus.ctmenu</ResourceName>
    +</VSCTCompile>
    ```

      ![Установка файлов VSCT в качестве Вскткомпиле](media/update-visual-studio-extension/build-linked-vsct-files.png)

1. Создайте свои проекты, чтобы убедиться, что новые ошибки не появились.

Теперь проект готов к добавлению поддержки Visual Studio 2022.

## <a name="add-a-visual-studio-2022-target"></a>Добавление целевого объекта Visual Studio 2022

В этом документе предполагается, что вы выполнили действия по [факторингу расширения Visual Studio с помощью общих проектов](#use-shared-projects-for-multi-targeting).

Перейдите к добавлению поддержки Visual Studio 2022 в расширение, выполнив следующие действия, которые могут быть выполнены с помощью Visual Studio 2019:

1. Добавьте в решение новый проект VSIX. Это будет проект, предназначенный для Visual Studio 2022. Удалите любой исходный код, поставляемый с шаблоном, но *сохранив `source.extension.vsixmanifest` файл*.

1. В новом проекте VSIX добавьте ссылку на общий проект в тот же общий проект, на который ссылается VSIX Visual Studio 2019.

   ![Решение с одним общим проектом и двумя проектами VSIX](media/update-visual-studio-extension/shared-project-with-two-heads.png)

1. Убедитесь, что новый проект VSIX построен правильно. Чтобы устранить ошибки компилятора, может потребоваться добавить ссылки, соответствующие исходному проекту VSIX.

1. Для управляемых расширений VS обновите ссылки на пакеты с 16. x (или более ранней версии) до версий пакета 17. x в целевом файле проекта Visual Studio 2022 с помощью диспетчера пакетов NuGet или непосредственно изменив файл проекта:

    ```diff
    -<PackageReference Include="Microsoft.VisualStudio.SDK" Version="16.0.206" />
    +<PackageReference Include="Microsoft.VisualStudio.SDK" Version="17.0.0-preview.1" />
    -<PackageReference Include="Microsoft.VSSDK.BuildTools" Version="16.10.32" />
    +<PackageReference Include="Microsoft.VSSDK.BuildTools" Version="17.0.63-preview.1" />
    ```

   Вы будете использовать версии, которые действительно доступны в nuget.org. Ранее использованные объекты предназначены только для демонстрационных целей.

   Во многих случаях идентификаторы пакетов изменились. Список изменений в Visual Studio 2022 см. в [таблице сопоставления пакетов и сборок](migrated-assemblies.md) .

   Расширения, написанные на C++, еще не имеют доступного пакета SDK для компиляции.

1. Для проектов C++ они должны быть скомпилированы для AMD64. При работе с управляемыми расширениями рассмотрите возможность изменения проекта с создания любого ЦП на целевую платформу `x64` , чтобы отразить, что в Visual Studio 2022 расширение всегда загружается в 64-разрядном процессе. `Any CPU` имеет значение, но может создавать предупреждения, если вы ссылаетесь на любые двоичные файлы, предназначенные только для 64-разрядных систем.

   Все зависимости вашего расширения для собственного модуля должны быть обновлены с образа x86 до образа AMD64.

1. Измените `source.extension.vsixmanifest` файл, чтобы он отражал целевую платформу Visual Studio 2022. Задайте `<InstallationTarget>` тег, чтобы отразить Visual Studio 2022 и указать полезные данные AMD64:

   ```xml
   <InstallationTarget Id="Microsoft.VisualStudio.Community" Version="[17.0,18.0)">
      <ProductArchitecture>amd64</ProductArchitecture>
   </InstallationTarget>
   ```

   В Visual Studio 2019 конструктор для этого файла не предоставляет новый `ProductArchitecture` элемент, поэтому это изменение необходимо выполнить с помощью редактора XML, доступ к которому можно получить с помощью команды " **Открыть с** помощью" в **Обозреватель решений**.

   Этот `ProductArchitecture` элемент является критически важным. Visual Studio 2022 *не* установит расширение без него.

   | Элемент | Значение | Описание |
   | - | - | - |
   | продуктарчитектуре | X86, AMD64 | Платформы, поддерживаемые этим расширением VSIX. Без учета регистра. Одна платформа на элемент и один элемент на Инсталлтаржет. Для версий продукта менее 17,0 значение по умолчанию — x86, и его можно опустить.  Для продуктов версии 17,0 и выше этот элемент является обязательным и значение по умолчанию отсутствует. Для Visual Studio 2022 единственным допустимым содержимым для этого элемента является "amd64". |

1. Внесите другие необходимые изменения в source. extension. vsixmanifest в соответствии с тем, которое предназначено для Visual Studio 2019 (при наличии). Очень важно, чтобы идентификатор VSIX в `Identity` элементе манифеста совпадал для обоих расширений.

На этом этапе у вас есть расширение VSIX, предназначенное для Visual Studio 2022. Необходимо создать проект VSIX, предназначенный для Visual Studio 2022, и [работать с любыми разрывами сборки, которые отображаются](#handle-breaking-api-changes). Если у вас нет разрывов сборки в проекте VSIX, предназначенном для Visual Studio 2022, мы готовы к тестированию.

## <a name="handle-breaking-api-changes"></a>Изменение нарушений API

В Visual Studio 2022 имеются [критические изменения API](breaking-api-list.md) , которые могут потребовать внесения изменений в код при выполнении в предыдущих версиях. Ознакомьтесь с документом, чтобы получить советы по обновлению кода для каждого из них.

При адаптации кода рекомендуется использовать [условную компиляцию](#use-conditional-compilation-symbols) , чтобы код мог продолжать поддерживать до visual Studio 2022 при добавлении поддержки visual Studio 2022.

Когда вы получаете целевое здание Visual Studio 2022, продолжайте [тестирование](#test-your-extension).

## <a name="use-conditional-compilation-symbols"></a>Использование символов условной компиляции

Если вы хотите использовать один и тот же исходный код, даже тот же файл для Visual Studio 2022 и более ранних версий, может потребоваться использовать условную компиляцию, чтобы можно было разбивать код для адаптации к критическим изменениям. Условная компиляция — это функция языков C#, Visual Basic и C++, которую можно использовать для совместного использования большинства кода при размещении различных интерфейсов API в конкретных местах.

Дополнительные сведения об использовании директив препроцессора и символов условной компиляции можно найти в [директиве Microsoft документация #if препроцессора](/dotnet/csharp/language-reference/preprocessor-directives#conditional-compilation).

Для проектов, предназначенных для более ранних версий Visual Studio, потребуется символ условной компиляции, который затем можно использовать для разделения кода на использование различных интерфейсов API. Символ условной компиляции можно задать на странице свойств проекта, как показано на следующем рисунке:

![Задание символов условной компиляции](media/update-visual-studio-extension/conditional-compilation-symbols.png)

Не забудьте задать символ компиляции для *всех* конфигураций, так как по умолчанию вводимый символ может применяться только к одной конфигурации.

### <a name="c-techniques"></a>\#Методики C

Затем этот символ можно использовать как директиву перед процессором ( `#if` ), как показано в следующем коде. Затем можно разбить код для обработки критических изменений в разных версиях Visual Studio.

```cs
    Guid myGuid = new Guid("{633FBA02-719B-40E7-96BF-0899767CD104}");
    uint myFlags = 0;
    IVsShell shell = await AsyncServiceProvider.GlobalProvider.GetServiceAsync<SVsShell, IVsShell>();
#if Visual Studio 2019
    shell.LoadUILibrary(myGuid, myFlags, out uint ptrLib);
#else
    shell.LoadUILibrary(myGuid, myFlags, out IntPtr ptrLib);
#endif
```

В некоторых случаях можно просто использовать, `var` чтобы избежать присвоения имен типу, тем самым избегая необходимости в `#if` регионах. Приведенный выше фрагмент также можно записать следующим образом:

```cs
    Guid myGuid = new Guid("{633FBA02-719B-40E7-96BF-0899767CD104}");
    uint myFlags = 0;
    IVsShell shell = await AsyncServiceProvider.GlobalProvider.GetServiceAsync<SVsShell, IVsShell>();
    shell.LoadUILibrary(myGuid, myFlags, out var ptrLib);
```

При использовании `#if` синтаксиса Обратите внимание на то, как можно использовать раскрывающийся список контекст языковой службы в документе, показанном ниже, чтобы изменить выделение синтаксиса, а другая поможет службе языка предложить сосредоточиться на одной целевой версии Visual Studio для нашего расширения и другого.

![Условная компиляция в общем проекте](media/update-visual-studio-extension/conditional-compilation-if-region.png)

### <a name="xaml-sharing-techniques"></a>Методы совместного использования XAML

В языке XAML нет препроцессора, позволяющего настраивать содержимое на основе символов препроцессора. Копирование и обслуживание двух страниц XAML, где их содержимое должно отличаться между Visual Studio 2022 и более ранними версиями, может потребоваться.

Однако в некоторых случаях ссылка на тип, существующий в разных сборках в Visual Studio 2022 и более ранних версиях, может быть представлена в одном файле XAML путем удаления пространства имен, ссылающегося на сборку:

```diff
-xmlns:vsui="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.14.0"
-Value="{DynamicResource {x:Static vsui:TreeViewColors.SelectedItemActiveBrushKey}}"
+Value="{DynamicResource TreeViewColors.SelectedItemActiveBrushKey}"
```

## <a name="test-your-extension"></a>Тестирование расширения

Чтобы проверить расширение, предназначенное для Visual Studio 2022, необходимо установить Visual Studio 2022 Preview.
Перед предварительной версией Visual Studio 2022 вы не сможете запускать 64-разрядные расширения в версиях Visual Studio.

Вы можете использовать предварительную версию Visual Studio 2022 для сборки и тестирования расширений, если они предназначены для Visual Studio 2022 или более ранней версии. При запуске проекта VSIX из Visual Studio 2022 будет запущен экспериментальный экземпляр Visual Studio.

Мы настоятельно рекомендуем протестировать каждую версию Visual Studio, которая будет поддерживаться расширением.

Теперь все готово для [публикации расширения](#publish-your-extension).

## <a name="publish-your-extension"></a>Публикация расширения

Отлично, Итак, вы добавили целевой объект Visual Studio 2022 в расширение и протестировали его. Теперь вы готовы опубликовать расширение для мира в Адмире.

### <a name="visual-studio-marketplace"></a>Visual Studio Marketplace

Публикация расширения в [Visual Studio Marketplace](https://marketplace.visualstudio.com/) — это отличный способ получить новых пользователей для поиска и установки расширения. Независимо от того, предназначено ли расширение для Visual Studio 2022 исключительно или предназначено для более старых версий VS, в Marketplace она должна поддерживать вас.

В будущем Marketplace позволит отправить несколько VSIX-файлов в один список Marketplace, что позволит вам загрузить целевой VSIX Visual Studio 2022 и Visual Studio 2022 VSIX. При использовании диспетчера расширений VS пользователи автоматически получат правильный VSIX для установленной версии VS.

Для предварительных выпусков Visual Studio 2022 Marketplace поддерживает только один файл VSIX для каждого перечисления Marketplace. В то время как Visual Studio 2022 находится на этапе предварительной версии, мы рекомендуем использовать отдельный список Marketplace Visual Studio 2022 для вашего расширения. Таким образом, вы можете выполнить итерацию расширения Visual Studio 2022 по мере необходимости, не затрагивая клиентов в более ранних версиях Visual Studio. Вы также можете пометить расширение как "Предварительная версия", чтобы задать предполагаемое значение, которое будет менее надежным, даже если источником этого унрелиабилити является Visual Studio 2022, чем у основного расширения.

### <a name="custom-installer"></a>Пользовательский установщик

Если вы создаете MSI/EXE для установки расширения и порождение vsixinstaller.exe для установки (части) вашего расширения, помните, что установщик VSIX в Visual Studio 2022 обновлен. Разработчикам потребуется использовать версию установщика VSIX, поставляемую с Visual Studio 2022, для установки расширений в Visual Studio 2022. Установщик VSIX в Visual Studio 2022 также установит применимые расширения, предназначенные для предыдущих версий Visual Studio, которые установлены параллельно с Visual Studio 2022 на одном компьютере.

### <a name="network-share"></a>Сетевая папка

Вы можете поделиться своим расширением по локальной сети или любым другим способом. Если вы настроили Visual Studio 2022 и Visual Studio 2022, вам потребуется предоставить несколько VSIX-файлов по отдельности и предоставить им файлы (или разместить их в уникальных папках), которые помогут пользователям знать, какой VSIX следует установить на основе установленной версии Visual Studio.

### <a name="other-considerations"></a>Другие замечания

#### <a name="dependencies"></a>Зависимости

Если в VSIX указан другой VSIX в качестве зависимости через `<dependency>` элемент, каждый указанный в ссылке VSIX должен быть установлен в те же целевые объекты и архитектуры продукта, что и VSIX. Если зависимый VSIX-проект не поддерживает целевую установку Visual Studio, то VSIX завершится ошибкой. Зависимый VSIX может поддерживать больше целевых объектов и архитектур, чем вы, но не меньше. Это ограничение означает, что подход к развертыванию и распространению VSIX с зависимостями должен быть зеркальным.

## <a name="q--a"></a>Вопросы и ответы

**Вопрос**. мое расширение не требует каких-либо изменений взаимодействия, так как оно просто предоставляет данные (например, шаблоны). можно ли создать одно расширение, включающее в себя Visual Studio 2022?

Ответ **. Да**!  Дополнительные сведения об этом см. в разделе [расширения без выполнения кода](#extensions-without-running-code) .

**Вопрос**. зависимость NuGet используется в старых сборках взаимодействия и вызывает конфликт классов.

Ответ. Добавьте следующую строку в CSPROJ- **файл, чтобы** избежать дублирования сборок:

```xml
    <PackageReference Include="<Name of offending assembly>" ExcludeAssets="compile" PrivateAssets="all" />
```

Это предотвратит импорт старой версии сборки из других зависимостей.

**Вопрос**. мои команды и сочетания клавиш не работают в Visual Studio после переключения исходных файлов в общий проект.

Ответ. **на** [шаге 2,4](samples.md#step-2---refactor-source-code-into-a-shared-project) примера оптимизатора изображений показано, как добавить VSCT файлы в качестве связанных элементов, чтобы они были скомпилированы в файл VSCT.

## <a name="next-steps"></a>Дальнейшие действия

Выполните пошаговый пример, [имажеоптимизер](samples.md), со ссылками на проект и изменения кода для каждого шага.
