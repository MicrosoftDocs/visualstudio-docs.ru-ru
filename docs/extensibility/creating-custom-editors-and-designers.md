---
title: Создание пользовательских редакторов и конструкторов | Документация Майкрософт
description: 'Сведения о различных типах редакторов, которые могут размещаться в интегрированной среде разработки Visual Studio: основном редакторе, пользовательских редакторах, внешних редакторах и конструкторах.'
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
helpviewer_keywords:
- designers [Visual Studio SDK]
- editors [Visual Studio SDK], custom
ms.assetid: b6a5e8b2-0ae1-4fc3-812d-09d40051b435
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: c2882cfa103627672e5c96a0e3d4b2a23b4b4ba9
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105055782"
---
# <a name="create-custom-editors-and-designers"></a>Создание пользовательских редакторов и конструкторов

В интегрированной среде разработки (IDE) Visual Studio могут размещаться различные типы редакторов:

- Редактор основных компонентов Visual Studio

- Пользовательские редакторы

- Внешние редакторы

- Конструкторы

Следующие сведения помогут выбрать необходимый тип редактора.

## <a name="types-of-editor"></a>Типы редакторов

Дополнительные сведения о редакторе основных компонентов Visual Studio см. [в разделе Расширение возможностей редактора и языковых служб](../extensibility/extending-the-editor-and-language-services.md).

### <a name="custom-editors"></a>Пользовательские редакторы
 Пользовательский редактор — это тот, который предназначен для работы в специализированных обстоятельствах. Например, можно создать редактор, функция которого предназначена для чтения и записи данных в определенном репозитории, таком как Microsoft Exchange Server. Выберите пользовательский редактор, если требуется редактор, работающий только с типом проекта, или если требуется редактор, содержащий только несколько конкретных команд. Однако обратите внимание, что пользователи не смогут использовать пользовательский редактор для изменения стандартных [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] проектов.

 Пользовательский редактор может использовать фабрику редактора и добавлять сведения о редакторе в реестр. Однако тип проекта, связанный с пользовательским редактором, может создавать экземпляр пользовательского редактора другими способами.

 Пользовательский редактор может использовать встроенную активацию или упрощенное внедрение для реализации представления.

### <a name="external-editors"></a>Внешние редакторы
 Внешние редакторы — это редакторы, не интегрированные в Visual Studio, такие как Microsoft Word, Блокнот или Microsoft FrontPage. Такой редактор можно вызывать, например, при передаче текста в него из VSPackage. Внешние редакторы регистрируют себя и могут использоваться за пределами Visual Studio. При вызове внешнего редактора его можно внедрить в главное окно, после чего оно появится в окне в интегрированной среде разработки. В противном случае интегрированная среда разработки создает для него отдельное окно.

 <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.IsDocumentInProject%2A>Метод задает приоритет документа с помощью <xref:Microsoft.VisualStudio.Shell.Interop.VSDOCUMENTPRIORITY> перечисления. Если `DP_External` указано значение, файл может быть открыт внешним редактором.

## <a name="editor-design-decisions"></a>Решения по проектированию редактора
 Следующие вопросы по проектированию помогут выбрать тип редактора, который лучше всего подходит для приложения:

- Будет ли приложение сохранять данные в файлах или нет? Если данные будут сохранены в файлах, будет ли они работать в пользовательском или стандартном формате?

   Если используется стандартный формат файла, другие типы проектов в дополнение к проекту смогут открывать и считывать и записывать данные. Однако при использовании пользовательского формата файла только тип проекта сможет открывать и считывать и записывать данные.

   Если в проекте используются файлы, следует настроить стандартный редактор. Если в проекте не используются файлы, а используются элементы в базе данных или другом репозитории, следует создать пользовательский редактор.

- Нужен ли редактор для размещения элементов управления ActiveX?

   Если в редакторе размещены элементы управления ActiveX, реализуйте редактор активации на месте, как описано в этой [активации](/previous-versions/visualstudio/visual-studio-2015/misc/in-place-activation?preserve-view=true&view=vs-2015). Если на нем не размещены элементы управления ActiveX, используйте упрощенный редактор внедрения или настройте [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] Редактор по умолчанию.

- Будет ли редактор поддерживать несколько представлений? Если вы хотите, чтобы представления редактора были видимыми одновременно с редактором по умолчанию, необходимо поддерживать несколько представлений.

   Если редактор должен поддерживать несколько представлений, объекты данных документа и представления документов для редактора должны быть отдельными объектами. Дополнительные сведения см. в разделе [Поддержка нескольких представлений документов](../extensibility/supporting-multiple-document-views.md).

   Если редактор поддерживает несколько представлений, вы планируете использовать [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] реализацию текстового буфера ( <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> объекта) основного редактора для объекта данных документа? Это значит, что вы хотите поддерживать представление редактора параллельно с [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] основным редактором? Эта возможность доступна в конструкторе форм.

- Если необходимо разместить внешний редактор, можно ли внедрить редактор в [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] ?

   Если его можно внедрить, следует создать главное окно для внешнего редактора, а затем вызвать <xref:Microsoft.VisualStudio.Shell.Interop.IVsProject3.IsDocumentInProject%2A> метод и установить <xref:Microsoft.VisualStudio.Shell.Interop.VSDOCUMENTPRIORITY> для перечисления значение `DP_External` . Если редактор не может быть внедрен, интегрированная среда разработки автоматически создаст для нее отдельное окно.

## <a name="in-this-section"></a>в этом разделе

[Пошаговое руководство. Создание пользовательского редактора](../extensibility/walkthrough-creating-a-custom-editor.md)\
Объясняет, как создать пользовательский редактор.

[Пошаговое руководство. Добавление компонентов в пользовательский редактор](../extensibility/walkthrough-adding-features-to-a-custom-editor.md)\
Объясняет, как добавлять компоненты в пользовательский редактор.

[Инициализация конструктора и Настройка метаданных](../extensibility/designer-initialization-and-metadata-configuration.md)\
Объясняет, как инициализировать конструктор.

[Предоставление поддержки отмены в конструкторах](../extensibility/supplying-undo-support-to-designers.md)\
Объясняет, как обеспечить поддержку отмены для конструкторов.

[Выделение синтаксиса в пользовательских редакторах](../extensibility/syntax-coloring-in-custom-editors.md)\
Объясняет разницу между цветовым выделением синтаксиса в основном редакторе и в пользовательских редакторах.

[Данные документа и представление документа в пользовательских редакторах](../extensibility/document-data-and-document-view-in-custom-editors.md)\
Объясняет, как реализовать данные документа и представления документов в пользовательских редакторах.

## <a name="related-sections"></a>Связанные разделы

[Устаревшие интерфейсы в редакторе](/previous-versions/visualstudio/visual-studio-2015/extensibility/legacy-interfaces-in-the-editor?preserve-view=true&view=vs-2015)\
Объясняется, как получить доступ к основному редактору с помощью устаревшего API.

[Разработка языковой службы прежних версий](../extensibility/internals/developing-a-legacy-language-service.md)\
Объясняет, как реализовать языковую службу.

[Расширение других частей Visual Studio](../extensibility/extending-other-parts-of-visual-studio.md)\
Объясняет, как создавать элементы пользовательского интерфейса, соответствующие остальным элементам [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] .

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory>
