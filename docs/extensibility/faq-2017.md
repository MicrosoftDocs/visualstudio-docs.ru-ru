---
title: Часто задаваемые вопросы о расширяемости
description: В этой статье содержатся ответы на некоторые часто задаваемые вопросы о расширяемости Visual Studio 2017.
ms.custom: SEO-VS-2020
ms.date: 11/09/2016
ms.topic: conceptual
ms.assetid: 345855db-0cc3-45aa-8c57-bb18d9789772
author: kevinfansler
ms.author: madsk
manager: jmartens
monikerRange: vs-2017
ms.openlocfilehash: 8dbfe55122ebc2a8523c9a669ecc26591caacf84
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99962942"
---
# <a name="faq-for-visual-studio-2017-extensibility"></a>Вопросы и ответы по расширяемости Visual Studio 2017

Ниже приведены некоторые часто задаваемые вопросы о расширяемости Visual Studio 2017.

## <a name="what-is-the-backwards-compatibility-story-for-extensions"></a>Что такое история обратной совместимости для расширений?

Новый формат VSIX v3 обратно совместим с VSIX версии 2, поэтому вы по-прежнему можете иметь один VSIX с одним ИДЕНТИФИКАТОРом VSIX, который поддерживает Visual Studio 2012 и более поздние версии. Новый формат VSIX v3 не поддерживает Visual 2010 и более ранних версий. Чтобы обеспечить поддержку Visual Studio 2010, вам потребуется создать отдельное расширение (с отдельным ИДЕНТИФИКАТОРом VSIX). Так как Visual Studio 2010 теперь представляет собой небольшой процент от пользовательской базы данных, рекомендуется использовать существующий идентификатор VSIX для расширения, которое поддерживает Visual Studio 2012 или более поздней версии, и назначить новый идентификатор VSIX в версию Visual Studio 2010.

## <a name="why-do-i-need-to-declare-prerequisites-with-visual-studio-2017"></a>Зачем мне нужно объявлять необходимые компоненты в Visual Studio 2017?

Visual Studio 2017 обеспечивает более быструю и облегченную установку Visual Studio, которая предоставляет пользователям повышенный контроль над установленными рабочими нагрузками и компонентами. Чтобы убедиться в том, что компоненты, необходимые для расширения, установлены с VSIX v3 и Visual Studio 2017, необходимо объявить компоненты, от которых зависит расширение. Если какие – либо необходимые компоненты недоступны на компьютере пользователя, пользователь не сможет запустить расширение. Однако если Visual Studio обнаружит, что пользователь пытается установить расширение, для которого требуются отсутствующие компоненты, пользователю будет предложено установить необходимые компоненты. При наличии дополнительных компонентов нет необходимости перечислять их в качестве необходимых компонентов при условии, что вы выполняете соответствующее обнаружение компонентов во время выполнения. Все расширения должны указывать основной компонент редактора как зависимость `Microsoft.VisualStudio.Component.CoreEditor` .

## <a name="when-you-say-prerequisite-what-level-of-granularity-do-you-mean"></a>Какой уровень детализации вы значите, если говорить о предварительных требованиях?

Вы объявляете необходимые компоненты на уровне компонента, то есть отдельные параметры, которые можно выбрать в пользовательском интерфейсе. Предварительные требования не объявляются для рабочих нагрузок или отдельных библиотек DLL.

## <a name="where-do-i-find-a-list-of-component-ids-so-i-can-declare-dependencies"></a>Где найти список идентификаторов компонентов, чтобы можно было объявлять зависимости?

Чтобы найти список идентификаторов компонентов, ознакомьтесь с [идентификаторами рабочей нагрузки и компонентов Visual Studio 2017](../install/workload-and-component-ids.md?view=vs-2019&preserve-view=true). Если вы не уверены, какой компонент содержит конкретный двоичный файл, можно скачать [электронную таблицу сопоставления > компонентов](https://aka.ms/vs2017componentid-binaries). Дополнительные сведения об использовании электронной таблицы см. в разделе **Поиск идентификаторов компонентов** статьи [руководство. Перенос проектов расширяемости в Visual Studio 2017](how-to-migrate-extensibility-projects-to-visual-studio-2017.md).

## <a name="my-extension-requires-visual-studio-153-how-do-i-enforce-that-requirement"></a>Для моего расширения требуется Visual Studio 15,3, как применить это требование?

Например, если для расширения требуется определенная версия Visual Studio 2017, то она зависит от функции, выпущенной в 15,3, можно указать номер сборки в VSIX **InstallationTarget**. Например, выпуск 15,3 имеет номер сборки "15.0.26730.3". Сопоставление выпусков для номеров сборки можно увидеть [здесь](../install/visual-studio-build-numbers-and-release-dates.md). Обратите внимание, что использование номера выпуска "15,3" не будет работать правильно.

Если для расширения требуется 15,3 или более поздней версии, вы объявили **версию InstallationTarget** как [15.0.26730.3, 16,0):

```xml
<Installation>
  <InstallationTarget Id="Microsoft.VisualStudio.Community" Version="[15.0.26730.3, 16.0)" />
</Installation>
```

Всиксинсталлер обнаружит более ранние версии Visual Studio и сообщит пользователю о необходимости последующего обновления.

## <a name="i-keep-getting-an-error-when-i-try-to-upload-my-extension"></a>Я получаю сообщение об ошибке при попытке отправить расширение.

Возможно, вы используете старую версию манифеста VSIX. Если расширение помечено как поддерживающее Visual Studio 2017, но не использует новый формат манифеста VSIX версии 3, вы не сможете отправить его.

## <a name="i-use-my-own-installer-can-i-continue-to-do-that"></a>Я использую собственный установщик. Можно ли продолжить это?

В Visual Studio 2017 минимальная установка Visual Studio будет значительно меньше, чем в предыдущих версиях.

Мы улучшили формат манифеста VSIX для поддержки изменений, необходимых для облегченной установки. Мы рекомендуем предоставить расширение в формате VSIX v3. Вам может потребоваться поддерживать существующий установщик для определенных сценариев, например, если вы устанавливаете компоненты за пределами Visual Studio.

Например, если требуется MSBuild, необходимо указать это как необходимое условие в манифесте VSIX. При установке VSIX установщик обеспечит доступность MSBuild.

Затем установщик вызывает Всиксинсталлер для установки VSIX с компонентами Visual Studio 2017.

## <a name="can-you-give-me-more-migration-guidance"></a>Можно ли получить дополнительные рекомендации по миграции?

Дополнительные сведения см. в статье [как перенести проекты расширяемости в Visual Studio 2017](how-to-migrate-extensibility-projects-to-visual-studio-2017.md). Кроме того, есть отличная запись в блоге, [изменения в программе установки Visual Studio](https://devblogs.microsoft.com/setup/changes-to-visual-studio-15-setup/).

## <a name="how-do-i-do-package-registration"></a>Разделы справки выполнить регистрацию пакетов?

Регистрация пакета выполняется так же, как и в прошлом, с записями реестра. Единственное изменение состоит в том, что в реестре теперь размещается демонстрация, и необходимо объявить записи реестра из файла *pkgdef* .

Если используется `PackageRegistrationAttribute` , это должно происходить автоматически.

## <a name="will-i-need-a-new-gallery-entry-for-the-visual-studio-2017-version-of-my-extension"></a>Нужна ли мне новая запись коллекции для версии расширения Visual Studio 2017?

Нет, в коллекции Visual Studio для обновленного VSIX не требуется новая запись. при условии, что ваши изменения полностью обратно совместимы со всеми поддерживаемыми версиями. Если расширение не имеет обратной совместимости, рекомендуется разделить расширение на несколько VSIX (даже если временно), каждый из которых имеет собственный идентификатор VSIX и запись в коллекции.

## <a name="what-should-i-do-with-my-extension-that-currently-supports-visual-studio-2010-and-later"></a>Что делать с расширением, которое сейчас поддерживает Visual Studio 2010 и более поздние версии?

Добавьте поддержку Visual Studio 2017 в текущий VSIX и обеспечьте поддержку Visual Studio 2012 и более поздних версий. Кроме того, создайте новый VSIX (с новым идентификатором GUID и записью коллекции) с поддержкой Visual Studio 2010.

## <a name="can-i-build-a-vsix-v3-with-visual-studio-2015"></a>Можно ли создать VSIX версии 3 с помощью Visual Studio 2015?

Да. Существует пакет NuGet, который содержит необходимые средства и задачи для сборки манифестов формата VSIX версии 3 в Visual Studio 2015. Добавьте ссылку на пакет NuGet `Microsoft.VisualStudio.Sdk.BuildTasks.14.0` в проект расширения среды. Кроме того, необходимо добавить элемент, заданный `VsixType` `v3` в файле проекта:

```xml
  <VsixType>v3</VsixType>
```

## <a name="can-i-run-the-vsixinstaller-in-quiet-mode"></a>Можно ли запустить Всиксинсталлер в тихом режиме?

Теперь необходимо передать дополнительные параметры в Всиксинсталлер, чтобы было установлено несколько экземпляров Visual Studio 2017.

```bash
vsixinstaller.exe /q /appidinstallpath:"c:\program files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\devenv.exe" /appidname:"Visual Studio" /logFile:<path to log file> /skuName:Enterprise /skuVersion:15.0.25810.0 "KendoUI.Mvc.VSPackage.vsix"
```

## <a name="why-does-the-vsixinstaller-now-wait-for-processes-to-exit-before-installing-the-vsix"></a>Почему Всиксинсталлер теперь ждет завершения процессов перед установкой VSIX?

Теперь Всиксинсталлер использует подсистему установки Visual Studio для установки необходимых компонентов, определенных в VSIX. Перед обновлением установки Visual Studio модуль установки требует, чтобы все процессы, связанные с VS, завершили работу.

## <a name="can-i-now-install-my-extension-assets-to-any-location-with-vsix-v3"></a>Можно ли установить ресурсы расширения в любое расположение с помощью VSIX v3?

Нет, свойство VSIX v3 `InstallRoot` не позволяет устанавливать что-либо вне структуры папок установки Visual Studio. Поддерживаемые расположения см. в разделе [Установка за пределами папки Extensions](set-install-root.md) .

Компоненты расширения, которые не являются частью Visual Studio, скорее всего, являются одноэлементными на компьютере и устанавливаются один раз для всех экземпляров Visual Studio 2017.

В этом случае рекомендуется создать MSI для компонентов, не относящихся к Visual Studio, и убедиться, что MSI вызывает Всиксинсталлер для установки компонентов, относящихся к Visual Studio.