---
description: Эта функция создает подпроект с заданным именем в существующем родительском проекте, указанном аргументом Лппарентпрожпас.
title: Функция Скккреатесубпрожект | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccCreateSubProject
helpviewer_keywords:
- SccCreateSubProject function
ms.assetid: 08154aed-ae5c-463c-8694-745d0e332965
author: acangialosi
ms.author: anthc
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 38fb6a18954b0a2f976fad4b24819a08ed868ab6
ms.sourcegitcommit: f33ca1fc99f5d9372166431cefd0e0e639d20719
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "102221617"
---
# <a name="scccreatesubproject-function"></a>Функция Скккреатесубпрожект
Эта функция создает подпроект с заданным именем в существующем родительском проекте, заданном `lpParentProjPath` аргументом.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccCreateSubProject(
   LPVOID pContext,
   HWND   hWnd,
   LPSTR  lpUser,
   LPCSTR lpParentProjPath,
   LPCSTR lpSubProjName,
   LPSTR  lpAuxProjPath,
   LPSTR  lpSubProjPath
);
```

### <a name="parameters"></a>Параметры
 pContext

окне Указатель контекста для подключаемого модуля системы управления версиями.

 hWnd

окне Обработчик окна интегрированной среды разработки, который может использоваться подключаемым модулем системы управления версиями в качестве родительского для любых предоставляемых им диалоговых окон.

 лпусер

[вход, выход] Имя пользователя (до SCC_USER_SIZE, включая знак завершения NULL).

 лппарентпрожпас

окне Строка, идентифицирующая путь к родительскому проекту (до SCC_PRJPATH_SIZE, включая знак завершения NULL).

 лпсубпрожнаме

окне Предлагаемое имя подпроекта (до SCC_PRJPATH_SIZE, включая знак завершения NULL).

 лпаукспрожпас

[вход, выход] Вспомогательная строка, идентифицирующая проект (до SCC_PRJPATH_SIZE, включая знак завершения NULL).

 лпсубпрожпас

[вход, выход] Выходная строка, указывающая путь для подпроекта (до SCC_PRJPATH_SIZE, включая знак завершения NULL).

## <a name="return-value"></a>Возвращаемое значение
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Подпроект успешно создан.|
|SCC_E_INITIALIZEFAILED|Не удалось инициализировать родительский проект.|
|SCC_E_INVALIDUSER|Пользователь не смог войти в систему управления версиями.|
|SCC_E_COULDNOTCREATEPROJECT|Невозможно создать подпроект.|
|SCC_E_PROJSYNTAXERR|Недопустимый синтаксис проекта.|
|SCC_E_UNKNOWNPROJECT|Родительский проект неизвестен для подключаемого модуля системы управления версиями.|
|SCC_E_INVALIDFILEPATH|Недопустимый или непригодный к использованию путь к файлу.|
|SCC_E_NOTAUTHORIZED|Пользователю не разрешено выполнять эту операцию.|
|SCC_E_ACCESSFAILURE|Возникла проблема при доступе к системе управления версиями, возможно, из-за проблем с сетью или состязаниями. Рекомендуется повторить попытку.|
|SCC_E_CONNECTIONFAILURE|Возникла проблема с подключением к подключаемому модулю системы управления версиями.|
|SCC_E_NONSPECIFICERROR<br /><br /> SCC_E_UNKNOWNERROR|Неконкретный сбой.|

## <a name="remarks"></a>Комментарии
 Если подпроект с таким именем уже существует, функция может изменить имя по умолчанию для создания уникального имени, например, добавив \<number> в него "_". Вызывающий объект должен быть подготовлен для принятия изменений в `lpUser` , `lpSubProjPath` и `lpAuxProjPath` . `lpSubProjPath`Аргументы и `lpAuxProjPath` затем используются при вызове метода [сккопенпрожект](../extensibility/sccopenproject-function.md). Они не должны изменяться вызывающим объектом после возврата. Эти строки предоставляют подключаемому модулю системы управления версиями способ для записи сведений, которые необходимо связать с проектом. В интегрированной среде разработки вызывающей стороны не будут отображаться эти два параметра, так как подключаемый модуль может использовать отформатированную строку, которая может не подойти для просмотра. Функция возвращает код успешного или неуспешного выполнения, и в случае успеха заполняет переменную `lpSubProjPath` полным путем к новому проекту.

 Эта функция похожа на [сккжетпрожпас](../extensibility/sccgetprojpath-function.md), за исключением того, что она создает проект автоматически, а не предлагает пользователю выбрать его. При `SccCreateSubProject` вызове функции `lpParentProjName` и `lpAuxProjPath` не будет пустым и будет соответствовать допустимому проекту. Эти строки обычно получаются интегрированной средой разработки из предыдущего вызова `SccGetProjPath` функции или [сккжетпарентпрожектпас](../extensibility/sccgetparentprojectpath-function.md).

 `lpUser`Аргумент — это имя пользователя. Интегрированная среда разработки передает имя пользователя, полученное ранее `SccGetProjPath` , и подключаемый модуль системы управления версиями должен использовать имя в качестве значения по умолчанию. Если у пользователя уже есть открытое подключение к подключаемому модулю, то подключаемый модуль должен попытаться устранить все запросы, чтобы убедиться, что функция работает автоматически. Однако если происходит сбой входа, подключаемый модуль должен запрашивать у пользователя имя входа и при получении допустимого имени входа снова передавать его в `lpUser` . Так как подключаемый модуль может изменить эту строку, интегрированная среда разработки всегда будет распределять буфер размера (SCC_USER_LEN + 1 или SCC_USER_SIZE, который включает пробел для терминатора null). Если строка изменена, Новая строка должна быть допустимым именем для входа (по крайней мере, как и старая строка).

## <a name="technical-notes-for-scccreatesubproject-and-sccgetparentprojectpath"></a>Технические примечания для Скккреатесубпрожект и Сккжетпарентпрожектпас
 Добавление решений и проектов в систему управления версиями было упрощено в Visual Studio, чтобы максимально сокращать число запросов на выбор расположений в системе управления версиями. Эти изменения активируются Visual Studio, если подключаемый модуль системы управления версиями поддерживает обе новые функции `SccCreateSubProject` и `SccGetParentProjectPath` . Однако можно использовать следующую запись реестра для отключения этих изменений и возврата к предыдущей версии Visual Studio (API подключаемого модуля системы управления версиями 1,1):

 **[HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\8.0\SourceControl] "Доноткреатесолутионрутфолдеринсаурцеконтрол" = DWORD: 00000001**

 Если эта запись реестра не существует или имеет значение "DWORD": 00000000, Visual Studio пытается использовать новые функции `SccCreateSubProject` и `SccGetParentProjectPath` .

 Если для записи реестра задано значение DWORD: 00000001, Visual Studio не пытается использовать эти новые функции, а операции добавления в систему управления версиями работают так же, как и в предыдущих версиях Visual Studio.

## <a name="see-also"></a>См. также раздел
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccGetParentProjectPath](../extensibility/sccgetparentprojectpath-function.md)
- [SccGetProjPath](../extensibility/sccgetprojpath-function.md)
