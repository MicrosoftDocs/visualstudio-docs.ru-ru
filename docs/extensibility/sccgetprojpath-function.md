---
description: Эта функция запрашивает у пользователя путь к проекту, который представляет собой строку, осмысленную только для подключаемого модуля системы управления версиями.
title: Функция Сккжетпрожпас | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccGetProjPath
helpviewer_keywords:
- SccGetProjPath function
ms.assetid: 1079847e-d45f-4cb8-9d92-1e01ce5d08f6
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 07c6b8f865d8b1b1d87c9c9468d74e2208265290
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105063972"
---
# <a name="sccgetprojpath-function"></a>Функция Сккжетпрожпас
Эта функция запрашивает у пользователя путь к проекту, который представляет собой строку, осмысленную только для подключаемого модуля системы управления версиями. Он вызывается, когда пользователь:

- Создание нового проекта

- Добавление существующего проекта в систему управления версиями

- Попытка найти существующий проект управления версиями

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccGetProjPath (
   LPVOID pvContext,
   HWND   hWnd,
   LPSTR  lpUser,
   LPSTR  lpProjName,
   LPSTR  lpLocalPath,
   LPSTR  lpAuxProjPath,
   BOOL   bAllowChangePath,
   LPBOOL pbNew
);
```

### <a name="parameters"></a>Параметры
 пвконтекст

окне Структура контекста подключаемого модуля системы управления версиями.

 hWnd

окне Обработчик окна интегрированной среды разработки, который может использоваться подключаемым модулем системы управления версиями в качестве родительского для любых предоставляемых им диалоговых окон.

 лпусер

[вход, выход] Имя пользователя (не превышать SCC_USER_SIZE, включая знак завершения NULL)

 лппрожнаме

[вход, выход] Имя проекта интегрированной среды разработки, рабочей области проекта или файла Makefile (не следует превысить SCC_PRJPATH_SIZE, включая знак завершения NULL).

 лплокалпас

[вход, выход] Рабочий путь проекта. Если `bAllowChangePath` имеет значение `TRUE` , то подключаемый модуль системы управления версиями может изменить эту строку (не превышать _MAX_PATH, включая завершающий символ null).

 лпаукспрожпас

[вход, выход] Буфер для возвращаемого пути проекта (не превышает SCC_PRJPATH_SIZE, включая символ завершения NULL).

 балловчанжепас

окне Если это так `TRUE` , подключаемый модуль системы управления версиями может запросить и изменить `lpLocalPath` строку.

 пбнев

[вход, выход] Значение, поступающее в, указывает, следует ли создать новый проект. Возвращенное значение указывает на успешное создание проекта:

|Входящий|Интерпретация|
|--------------|--------------------|
|true|Пользователь может создать новый проект.|
|FALSE|Пользователь не может создать новый проект.|

|Исходящий|Интерпретация|
|--------------|--------------------|
|true|Создан новый проект.|
|FALSE|Выбран существующий проект.|

## <a name="return-value"></a>Возвращаемое значение
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Проект успешно создан или получен.|
|SCC_I_OPERATIONCANCELED|Операция была отменена.|
|SCC_E_ACCESSFAILURE|Возникла проблема при доступе к системе управления версиями, возможно, из-за проблем с сетью или состязаниями.|
|SCC_E_CONNECTIONFAILURE|Возникла проблема при попытке подключения к системе управления версиями.|
|SCC_E_NONSPECIFICERROR|Произошла неизвестная ошибка.|

## <a name="remarks"></a>Remarks
 Эта функция предназначена для того, чтобы интегрированная среда разработки получала параметры `lpProjName` и `lpAuxProjPath` . После того как подключаемый модуль системы управления версиями запрашивает у пользователя эти сведения, он передает эти две строки обратно в интегрированную среду разработки. Интегрированная среда разработки сохраняет эти строки в своем файле решения и передает их в [сккопенпрожект](../extensibility/sccopenproject-function.md) каждый раз, когда пользователь открывает этот проект. Эти строки позволяют подключаемому модулю отслеживанию информации, связанной с проектом.

 При первом вызове функции присваивается `lpAuxProjPath` пустая строка. `lProjName` также может быть пустым или содержать имя проекта интегрированной среды разработки, которое может использовать или игнорировать подключаемый модуль системы управления версиями. При успешном возврате функции подключаемый модуль возвращает две соответствующие строки. Интегрированная среда разработки не делает никаких предположений об этих строках, не использует их и не позволит пользователю изменять их. Если пользователь хочет изменить параметры, интегрированная среда разработки снова выполнит вызов `SccGetProjPath` , передавая те же значения, которые были получены в предыдущий раз. Это дает подключаемому модулю полный контроль над этими двумя строками.

 Для `lpUser` Среда IDE может передать имя пользователя или просто передать указатель на пустую строку. При наличии имени пользователя подключаемый модуль системы управления версиями должен использовать его по умолчанию. Однако если имя не было передано или если не удалось войти с указанным именем, подключаемый модуль должен запрашивать у пользователя имя входа и передавать его обратно `lpUser` при получении допустимого имени входа. Так как подключаемый модуль может изменить эту строку, интегрированная среда разработки всегда будет распределять буфер размера ( `SCC_USER_LEN` + 1).

> [!NOTE]
> Первое действие, выполняемое интегрированной средой разработки, может быть вызовом `SccOpenProject` функции или функции `SccGetProjPath` . Таким образом, оба имеют идентичный `lpUser` параметр, который позволяет подключаемому модулю системы управления версиями входить в систему в любое время. Даже если возврат из функции указывает на сбой, подключаемый модуль должен заполнить эту строку допустимым именем для входа.

 `lpLocalPath` Каталог, в котором пользователь сохраняет проект. Может быть пустой строкой. Если в настоящее время не определен ни один каталог (как в случае, если пользователь пытается загрузить проект из системы управления версиями), а если `bAllowChangePath` — `TRUE` , то подключаемый модуль системы управления версиями может запрашивать у пользователя входные данные или использовать другой метод, чтобы поместить собственную строку в `lpLocalPath` . Если `bAllowChangePath` имеет значение `FALSE` , то подключаемый модуль не должен изменять строку, так как пользователь уже работает в указанном каталоге.

 Если пользователь создает новый проект для постановки в систему управления версиями, подключаемый модуль системы управления версиями может не создавать его в системе управления версиями во время `SccGetProjPath` вызова. Вместо этого он передает строку вместе с ненулевым значением для `pbNew` , указывая, что проект будет создан в системе управления версиями.

 Например, если пользователь в мастере **создания проекта** в Visual Studio добавит свой проект в систему управления версиями, Visual Studio вызывает эту функцию, а подключаемый модуль определяет, можно ли создать новый проект в системе управления версиями, чтобы он содержал проект Visual Studio. Если пользователь нажимает кнопку **Отмена** до завершения работы мастера, проект никогда не создается. Если пользователь нажмет кнопку **ОК**, Visual Studio вызывает `SccOpenProject` , передает `SCC_OPT_CREATEIFNEW` и проект, управляемый исходным кодом, создается в это время.

## <a name="see-also"></a>См. также
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccOpenProject](../extensibility/sccopenproject-function.md)
