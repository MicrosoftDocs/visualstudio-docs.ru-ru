---
title: Создание категории параметров | Документация Майкрософт
description: Узнайте, как создать категорию параметров Visual Studio и использовать ее для сохранения и восстановления значений из файла параметров.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
helpviewer_keywords:
- profile settings, creating categories
ms.assetid: 97c88693-05ff-499e-8c43-352ee073dcb7
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 1e3ef6dbfc58c67ce8e4dd7ff26634e4dbce2218
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105089346"
---
# <a name="create-a-settings-category"></a>Создание категории параметров

В этом пошаговом руководстве вы создадите категорию параметров Visual Studio и используете ее для сохранения значений и восстановления значений из файла параметров. Категория параметров — это группа связанных свойств, которые отображаются в виде точки настраиваемых параметров. то есть флажок в мастере **импорта и экспорта параметров** . (Его можно найти в меню **Сервис** .) Параметры сохраняются или восстанавливаются в виде категории, а индивидуальные параметры не отображаются в мастере. Дополнительные сведения см. в статье [Параметры среды](../ide/environment-settings.md).

Категория параметров создается путем наследования от <xref:Microsoft.VisualStudio.Shell.DialogPage> класса.

Чтобы начать работу с этим пошаговым руководством, сначала необходимо выполнить действия, описанные в первом разделе [страницы Создание параметров](../extensibility/creating-an-options-page.md). Сетка свойств результирующие параметры позволяет просматривать и изменять свойства в категории. После сохранения категории свойств в файле параметров вы просматриваете файл, чтобы увидеть, как хранятся значения свойств.

## <a name="prerequisites"></a>Предварительные требования
 Начиная с Visual Studio 2015, пакет SDK для Visual Studio не устанавливается из центра загрузки. Он входит в состав программы установки Visual Studio как дополнительный компонент. Пакет SDK для VS можно установить и позже. Дополнительные сведения см. [в статье Установка пакета SDK для Visual Studio](../extensibility/installing-the-visual-studio-sdk.md).

## <a name="create-a-settings-category"></a>Создание категории параметров
 В этом разделе используется пользовательская точка параметров для сохранения и восстановления значений категории «параметры».

### <a name="to-create-a-settings-category"></a>Создание категории параметров

1. Заполните [страницу Создание параметров](../extensibility/creating-an-options-page.md).

2. Откройте файл *VSPackage. resx* и добавьте следующие три строковых ресурса:

    |Имя|Значение|
    |----------|-----------|
    |106|Моя Категория|
    |107|Мои параметры|
    |108|Оптионинтежер и Оптионфлоат|

     При этом создаются ресурсы с именем категории "Моя Категория", объектом "My Settings" и описанием категории "Оптионинтежер and Оптионфлоат".

    > [!NOTE]
    > Из этих трех категорий в мастере **импорта и экспорта параметров** не отображается только имя категории.

3. В *митулсоптионспаккаже. CS* добавьте `float` свойство с именем `OptionFloat` в `OptionPageGrid` класс, как показано в следующем примере.

    ```csharp
    public class OptionPageGrid : DialogPage
    {
        private int optionInt = 256;
        private float optionFloat = 3.14F;

        [Category("My Options")]
        [DisplayName("My Integer option")]
        [Description("My integer option")]
        public int OptionInteger
        {
            get { return optionInt; }
            set { optionInt = value; }
        }
        [Category("My Options")]
        [DisplayName("My Float option")]
        [Description("My float option")]
        public float OptionFloat
        {
            get { return optionFloat; }
            set { optionFloat = value; }
        }
    }
    ```

    > [!NOTE]
    > `OptionPageGrid`Категория с именем "Моя Категория" теперь состоит из двух свойств `OptionInteger` и `OptionFloat` .

4. Добавьте в <xref:Microsoft.VisualStudio.Shell.ProvideProfileAttribute> `MyToolsOptionsPackage` класс и присвойте ему категорию "Моя Категория", присвойте ей значение ObjectName "My Settings" и установите для истулсоптионпаже значение true. Задайте для Категориресаурцеид, Обжектнамересаурцеид и Дескриптионресаурцеид соответствующие идентификаторы строковых ресурсов, созданные ранее.

    ```csharp
    [ProvideProfileAttribute(typeof(OptionPageGrid),
        "My Category", "My Settings", 106, 107, isToolsOptionPage:true, DescriptionResourceID = 108)]
    ```

5. Выполните сборку решения и запустите отладку. В экспериментальном экземпляре вы увидите, что на **странице "Сетка** " теперь есть значения типа Integer и float.

## <a name="examine-the-settings-file"></a>Проверка файла параметров
 В этом разделе вы экспортируете значения категорий свойств в файл параметров. Вы просматриваете файл и затем импортируете значения обратно в категорию свойств.

1. Запустите проект в режиме отладки, нажав клавишу **F5**. Запустится экспериментальный экземпляр.

2. Откройте   >  диалоговое окно **Параметры** инструментов.

3. В древовидном представлении в левой области разверните раздел **Моя Категория** , а затем щелкните **мою страницу сетки**.

4. Измените значение **оптионфлоат** на 3,1416, а **оптионинтежер** на 12. Нажмите кнопку **ОК**.

5. В меню **Сервис** выберите команду **Импорт и экспорт параметров**.

     Откроется мастер **импорта и экспорта параметров** .

6. Убедитесь, что выбран **параметр Экспортировать выбранные параметры среды** , а затем нажмите кнопку **Далее**.

     Откроется страница **Выбор параметров для экспорта** .

7. Щелкните **Мои параметры**.

     **Описание** меняется на **оптионинтежер и оптионфлоат**.

8. Убедитесь, что выбрана единственная категория " **Мои параметры** ", а затем нажмите кнопку " **Далее**".

     Откроется страница **имя файла параметров** .

9. Назовите новый файл параметров *MySettings. vssettings* и сохраните его в соответствующем каталоге. Нажмите кнопку **Готово**.

     На странице **Экспорт завершено** сообщается о том, что параметры были успешно экспортированы.

10. В меню **Файл** наведите указатель мыши на пункт **Открыть** и выберите **Файл**. Выберите *MySettings. vssettings* и откройте его.

     Вы можете найти категорию свойств, экспортированную в следующем разделе файла (идентификаторы GUID будут отличаться).

    ```
    <Category name="My Category_My Settings"
          Category="{4802bc3e-3d9d-4591-8201-23d1a05216a6}"
          Package="{6bb6942e-014c-489e-a612-a935680f703d}"
          RegisteredName="My Category_My Settings">
          PackageName="MyToolsOptionsPackage">
       <PropertyValue name="OptionFloat">3.1416</PropertyValue>
       <PropertyValue name="OptionInteger">12</PropertyValue>
    </Category>
    ```

     Обратите внимание, что полное имя категории формируется путем добавления символа подчеркивания к имени категории, за которым следует имя объекта. Оптионфлоат и Оптионинтежер отображаются в категории вместе со своими экспортированными значениями.

11. Закройте файл параметров, не изменяя его.

12. В меню **Сервис** выберите пункт **Параметры**, разверните раздел **Моя Категория**, щелкните **Моя страница сетки** , а затем измените значение **оптионфлоат** на 1,0 и **оптионинтежер** на 1. Нажмите кнопку **ОК**.

13. В меню **Сервис** выберите **Импорт и экспорт параметров**, выберите пункт **импортировать выбранные параметры среды** и нажмите кнопку **Далее**.

     Откроется страница **сохранить текущие параметры** .

14. Выберите **нет, просто импортируйте новые параметры** , а затем нажмите кнопку **Далее**.

     Откроется страница **Выбор коллекции параметров для импорта** .

15. Выберите файл *MySettings. vssettings* в узле **Мои параметры** представления в виде дерева. Если файл не отображается в древовидном представлении, нажмите кнопку **Обзор** и найдите его. Щелкните **Далее**.

     Откроется диалоговое окно **Выбор параметров для импорта** .

16. Убедитесь, что выбран **параметр Мои параметры** , и нажмите кнопку **Готово**. Когда появится страница **Импорт завершено** , нажмите кнопку **Закрыть**.

17. В меню **Сервис** выберите пункт **Параметры**, разверните раздел **Моя Категория**, щелкните **Моя страница сетки** и убедитесь, что значения категории свойств восстановлены.
