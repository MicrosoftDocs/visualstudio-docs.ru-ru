---
title: Среда CLR и вычисление выражений | Документация Майкрософт
description: Узнайте, как среда CLR взаимодействует с модулем отладки и как интегрировать собственный язык программирования в интегрированную среду разработки Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- debugging [Debugging SDK], expression evaluation
- expression evaluation, and common language runtime
ms.assetid: b36c1eb5-1aaf-48a6-b287-ee7a273d2b1c
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 35ddc218d0e9499253269a12687fa89122cfe007
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105055015"
---
# <a name="common-language-runtime-and-expression-evaluation"></a>Среда CLR и вычисление выражений
> [!IMPORTANT]
> В Visual Studio 2015 такой способ реализации оценивающих выражений является устаревшим. Дополнительные сведения о реализации вычислителей выражений CLR см. в разделе средства [оценки выражений CLR](https://github.com/Microsoft/ConcordExtensibilitySamples/wiki/CLR-Expression-Evaluators) и [Пример управляемого средства оценки выражений](https://github.com/Microsoft/ConcordExtensibilitySamples/wiki/Managed-Expression-Evaluator-Sample).

 Компиляторы, такие как Visual Basic и C# (произносится на языке C-диез), ориентированные на среду CLR, выдают промежуточный язык MSIL, который позже компилируется в машинный код. Среда CLR предоставляет механизм отладки (DE) для отладки результирующего кода. Если вы планируете интегрировать собственный язык программирования в интегрированную среду разработки Visual Studio, можно выбрать компиляцию в MSIL и, следовательно, не писать собственный DE. Однако вам придется написать средство оценки выражений (EE), которое может оценивать выражения в контексте вашего языка программирования.

## <a name="discussion"></a>Разговор
 Выражения языка компьютера обычно анализируются для создания набора объектов данных и набора операторов, используемых для управления ими. Например, выражение "A + B" может быть проанализировано для применения оператора сложения (+) к объектам данных "A" и "B", что может привести к получению другого объекта данных. Общий набор объектов данных, операторов и их ассоциаций чаще всего представлен в программе в виде дерева с операторами на узлах дерева и объектами данных в ветвях. Выражение, разбитое на форму дерева, часто называется проанализированным деревом.

 После синтаксического анализа выражения вызывается поставщик символов (SP) для вычисления каждого объекта данных. Например, если "A" определен как в нескольких методах, так и в вопросе "что?" необходимо ответить, прежде чем можно будет получить значение. Ответ, возвращаемый SP, — это нечто вроде «третьего элемента в пятом кадре стека» или «A, который 50 байт за пределы начала статической памяти, выделенной для этого метода».

 Помимо создания MSIL для самой программы, компиляторы CLR также могут создавать очень описательные отладочные данные, написанные в файле базы данных программы (*pdb*-файл). При условии, что собственный компилятор создает отладочную информацию в том же формате, что и компиляторы среды CLR, CLR может опознать именованные объекты данных этого языка. После определения именованного объекта данных EE использует объект Binder для связывания (или привязки) объекта данных с областью памяти, содержащей значение этого объекта. Затем DE может получить или задать новое значение для объекта данных.

 Собственный компилятор может предоставлять отладочную информацию среды CLR путем вызова `ISymbolWriter` интерфейса (который определен в платформа .NET Framework пространства имен `System.Diagnostics.SymbolStore` ). При компиляции в MSIL и записи отладочной информации через эти интерфейсы, собственный компилятор может использовать среду CLR DE и SP. Это значительно упрощает интеграцию собственного языка в интегрированную среду разработки Visual Studio.

 Когда среда CLR DE вызывает собственный EE для вычисления выражения, метод DE предоставляет EE интерфейсы для объекта SP и связывателя. Таким образом, написание подсистемы отладки на основе среды CLR означает, что необходимо только реализовать соответствующие интерфейсы средства оценки выражений; среда CLR выполняет привязку и обработку символов.

## <a name="see-also"></a>См. также
- [Написание вычислителя выражений CLR](../../extensibility/debugger/writing-a-common-language-runtime-expression-evaluator.md)
