---
description: Эта функция открывает существующий проект системы управления версиями или создает новый.
title: Функция Сккопенпрожект | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- SccOpenProject
helpviewer_keywords:
- SccOpenProject function
ms.assetid: d609510b-660a-46d7-b93d-2406df20434d
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 1326319b483aa707b77e0d7142d816b01fc7d3b1
ms.sourcegitcommit: bab002936a9a642e45af407d652345c113a9c467
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2021
ms.locfileid: "112902401"
---
# <a name="sccopenproject-function"></a>Функция SccOpenProject
Эта функция открывает существующий проект системы управления версиями или создает новый.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccOpenProject (
   LPVOID        pvContext,
   HWND          hWnd,
   LPSTR         lpUser,
   LPCSTR        lpProjName,
   LPCSTR        lpLocalProjPath,
   LPSTR         lpAuxProjPath,
   LPCSTR        lpComment,
   LPTEXTOUTPROC lpTextOutProc,
   LONG          dwFlags
);
```

#### <a name="parameters"></a>Параметры
 пвконтекст

окне Структура контекста подключаемого модуля системы управления версиями.

 hWnd

окне Обработчик окна интегрированной среды разработки, который может использоваться подключаемым модулем системы управления версиями в качестве родительского для любых предоставляемых им диалоговых окон.

 лпусер

[вход, выход] Имя пользователя (не превышать SCC_USER_SIZE, включая знак завершения NULL).

 лппрожнаме

окне Строка, идентифицирующая имя проекта.

 лплокалпрожпас

окне Путь к рабочей папке проекта.

 лпаукспрожпас

[вход, выход] Необязательная вспомогательная строка, идентифицирующая проект (не превышать SCC_AUXPATH_SIZE, включая знак завершения NULL).

 лпкоммент

окне Закомментируйте новый проект, который создается.

 лптекстаутпрок

окне Необязательная функция обратного вызова для вывода текста из подключаемого модуля системы управления версиями.

 dwFlags

окне Сигнализирует, нужно ли создать новый проект, если проект неизвестен для подключаемого модуля системы управления версиями. Значение может быть сочетанием `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN.`

## <a name="return-value"></a>Возвращаемое значение
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Открытие проекта завершено успешно.|
|SCC_E_INITIALIZEFAILED|Не удалось инициализировать проект.|
|SCC_E_INVALIDUSER|Пользователь не смог войти в систему управления версиями.|
|SCC_E_COULDNOTCREATEPROJECT|Проект не существовал до вызова.  установлен `SCC_OPT_CREATEIFNEW` флаг, но не удалось создать проект.|
|SCC_E_PROJSYNTAXERR|Недопустимый синтаксис проекта.|
|SCC_E_UNKNOWNPROJECT|Проект неизвестен для подключаемого модуля системы управления версиями, и `SCC_OPT_CREATEIFNEW` флаг не установлен.|
|SCC_E_INVALIDFILEPATH|Недопустимый или непригодный к использованию путь к файлу.|
|SCC_E_NOTAUTHORIZED|Пользователю не разрешено выполнять эту операцию.|
|SCC_E_ACCESSFAILURE|Возникла проблема при доступе к системе управления версиями, возможно, из-за проблем с сетью или состязаниями. Рекомендуется повторить попытку.|
|SCC_E_NONSPECFICERROR|Неконкретный сбой; система управления версиями не инициализирована.|

## <a name="remarks"></a>Remarks
 Интегрированная среда разработки может передать имя пользователя ( `lpUser` ) или просто передать указатель на пустую строку. При наличии имени пользователя подключаемый модуль системы управления версиями должен использовать его по умолчанию. Однако если имя не было передано или если не удалось выполнить вход с указанным именем, подключаемый модуль должен предложить пользователю войти в систему и вернуть допустимое имя в `lpUser` при получении допустимого имени входа `.` , поскольку подключаемый модуль может изменить строку имени пользователя, интегрированная среда разработки всегда будет выделять буфер размера ( `SCC_USER_LEN` + 1 или SCC_USER_SIZE, который содержит пробел для терминатора null).

> [!NOTE]
> Первое действие, которое может потребоваться выполнить интегрированной среде разработки, может быть вызовом `SccOpenProject` функции или [сккжетпрожпас](../extensibility/sccgetprojpath-function.md). По этой причине оба они имеют одинаковый `lpUser` параметр.

 `lpAuxProjPath` и `lpProjName` считываются из файла решения или возвращаются из вызова `SccGetProjPath` функции. Эти параметры содержат строки, которые подключаемый модуль системы управления версиями связывает с проектом и имеют смысл только для подключаемого модуля. Если такие строки отсутствуют в файле решения и пользователю не было предложено просмотреть (возвращающую строку через `SccGetProjPath` функцию), среда IDE передает пустые строки для `lpAuxProjPath` и и `lpProjName` ожидает, что эти значения будут обновлены подключаемым модулем при возврате этой функции.

 `lpTextOutProc` — это указатель на функцию обратного вызова, предоставляемую интегрированной средой разработки в подключаемый модуль системы управления версиями для отображения выходных данных результатов команды. Эта функция обратного вызова подробно описывается в [лптекстаутпрок](../extensibility/lptextoutproc.md).

> [!NOTE]
> Если подключаемый модуль системы управления версиями планирует использовать это преимущество, он должен установить `SCC_CAP_TEXTOUT` флаг в [скЦинитиализе](../extensibility/sccinitialize-function.md). Если этот флаг не был установлен или интегрированная среда разработки не поддерживает эту функцию, `lpTextOutProc` то будет иметь значение `NULL` .

 `dwFlags`Параметр определяет результат в случае, если открываемый проект в настоящее время не существует. Он состоит из двух битфлагс `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN` . Если открываемый проект уже существует, функция просто открывает проект и возвращает `SCC_OK` . Если проект не существует и `SCC_OP_CREATEIFNEW` флаг включен, подключаемый модуль системы управления версиями может создать проект в системе управления версиями, открыть его и вернуть `SCC_OK` . Если проект не существует и `SCC_OP_CREATEIFNEW` флаг выключен, подключаемый модуль должен проверить наличие `SCC_OP_SILENTOPEN` флага. Если этот флаг не включен, подключаемый модуль может запросить у пользователя имя проекта. Если этот флаг включен, подключаемый модуль должен просто вернуть `SCC_E_UNKNOWNPROJECT` .

## <a name="calling-order"></a>Порядок вызова
 В обычном процессе события [скЦинитиализе](../extensibility/sccinitialize-function.md) будет вызываться первым, чтобы открыть сеанс системы управления версиями. Сеанс может состоять из вызова `SccOpenProject` , за которым следуют другие вызовы функции API подключаемого модуля системы управления версиями и завершаются вызовом [сккклосепрожект](../extensibility/scccloseproject-function.md). Такие сеансы могут повторяться несколько раз до вызова [сккунинитиализе](../extensibility/sccuninitialize-function.md) .

 Если подключаемый модуль системы управления версиями устанавливает `SCC_CAP_REENTRANT` бит в `SccInitialize` , то описанная выше последовательность сеансов может повторяться несколько раз в параллельном режиме. Различные `pvContext` структуры отписывают разные сеансы, каждый из которых `pvContext` связан с одним открытым проектом за раз. В зависимости от `pvContext` параметра подключаемый модуль может определить, на какой проект ссылается какой-либо конкретный вызов. Если бит возможностей `SCC_CAP_REENTRANT` не задан, нонринтрант подключаемые модули системы управления версиями ограничиваются возможностью работы с несколькими проектами.

> [!NOTE]
> Этот `SCC_CAP_REENTRANT` бит появился в версии 1,1 API подключаемого модуля системы управления версиями. Он не задан или не учитывается в версии 1,0, а все подключаемые модули системы управления версиями версии 1,0 считаются нонринтрант.

## <a name="see-also"></a>См. также
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccCloseProject](../extensibility/scccloseproject-function.md)
- [SccGetProjPath](../extensibility/sccgetprojpath-function.md)
- [SccInitialize](../extensibility/sccinitialize-function.md)
- [SccUninitialize](../extensibility/sccuninitialize-function.md)
- [Ограничения длины строки](../extensibility/restrictions-on-string-lengths.md)
- [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)
