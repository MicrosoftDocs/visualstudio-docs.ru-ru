---
title: Текст пользовательского интерфейса и Справка по Visual Studio | Документация Майкрософт
description: Сведения о тексте и терминологии пользовательского интерфейса, используемой в справочной информации для Visual Studio.
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: e8747d07-6c90-46cc-b425-55b589f7e9e4
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 8635907b5c0190165855378fa692fb9abca4b0ec
ms.sourcegitcommit: f2916d8fd296b92cc402597d1d1eecda4f6cccbf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105052662"
---
# <a name="ui-text-and-help-for-visual-studio"></a>Текст пользовательского интерфейса и справки для Visual Studio
## <a name="ui-text-and-terminology"></a><a name="BKMK_UITextAndTerminology"></a> Текст и терминология пользовательского интерфейса
 Понятными текст имеет решающее значение для эффективного пользовательского интерфейса. Пользователи программного обеспечения, как правило, считывают метки первыми, а именно те, которые наиболее важны для выполнения поставленной задачи. Чтение статического текста с меньшей частотой. Разработайте рабочие сеансы для запуска рабочих сеансов с помощью быстрой проверки всего окна, а затем прочитав пользовательский интерфейс в следующем порядке:

1. Интерактивные элементы управления в центре

2. Кнопки фиксации

3. В других местах находятся интерактивные элементы управления

4. Основные инструкции

5. Дополнительные объяснения

6. Заголовок окна

7. Другой статический текст в основном тексте

### <a name="usage-patterns-for-ui-text"></a>Шаблоны использования для текста пользовательского интерфейса

#### <a name="title-bar-text"></a>Текст в заголовке
 Текст заголовка должен соответствовать команде, порожденной в пользовательском интерфейсе.

#### <a name="instructional-text-helper-text"></a>Пояснительный текст (текст поддержки)
 В некоторых диалоговых окнах рекомендуется предоставить выразительно основные инструкции, поясняющие, что делать в окне или на странице. Иногда это называется текстовым помощником.

##### <a name="writing-style-rules-for-helper-text"></a>Написание правил стилей для текста поддержки

- Не объясните очевидным. Не включайте пояснительный текст, если он не является абсолютно необходимым.

- Пояснительный текст всегда размещается в верхней части диалогового окна и должен ссылаться на выполняемую задачу.

- Точно Объясните пользователям, что им нужно делать. Избегайте чрезмерного обмена данными и избыточности.

- Проверьте каждое окно и удалите дублирующиеся слова и инструкции.

- Коротко сократить текст инструкций. Если для некоторых пользователей или сценариев требуются дополнительные сведения, предоставьте ссылку на подробный концептуальный раздел в Интернете.

- Напишите текст, чтобы каждое слово содержало вес и обязательно.

- Следуйте существующим рекомендациям корпорации Майкрософт по тексту и [стилю и тону](/windows/desktop/uxguide/text-style-tone) [пользовательского интерфейса](/windows/desktop/uxguide/text-ui) .

#### <a name="supplemental-instructions"></a>Дополнительные инструкции
 Дополнительные инструкции содержат дополнительные сведения, помогающие пользователю понять элементы управления и группирования элементов управления. Это также может включать текст подсказки, необходимый для понимания того, какой формат ожидается элементом управления вводом. Используйте дополнительные инструкции с осторожностью. Зарезервируйте их в случаях, когда вполне вероятно, что пользователь не сможет полностью понять последствия выбора.

 ![Снимок экрана, показывающий кнопку "параметры Internet Explorer" с дополнительным текстом ниже, который описывает влияние изменения настроек параметров.](../../extensibility/ux-guidelines/media/0601-b_supplementaltext1.png "0601 — b_SupplementalText1")

 **Пояснительный текст в Visual Studio**

 ![Снимок экрана: диалоговое окно выбора системы управления версиями в Visual Studio, в котором отображается дополнительный текст, описывающий каждый из параметров системы управления версиями.](../../extensibility/ux-guidelines/media/0601-c_supplementaltext2.png "0601 — c_SupplementalText2")

 **Пояснительный текст в Visual Studio**

#### <a name="infotips"></a>инфотипс
 Часто пояснительный текст может быть слишком длинным для размещения на месте в пользовательском интерфейсе или может быть полезен только для новых пользователей, что очень вероятно для опытных пользователей. В этом случае пояснительный или информационный текст должен быть помещен в подсказку во всплывающей подсказке.

 Инфотипс должны располагаться рядом с элементами управления, к которым они относятся, и должен использовать конкретный значок всплывающей подсказки, который является ненавязчивым, но заметным.

 ![Подсказка в Visual Studio](../../extensibility/ux-guidelines/media/0601-d_infotip.png "0601 — d_InfoTip")

 **Пример подсказки в Visual Studio**

##### <a name="writing-style-rules-for-infotips"></a>Написание правил стилей для Инфотипс

- Напишите Инфотипс как завершенные предложения. Для них требуются определенные глаголы, регистр предложений и знаки препинания в конце.

- Используйте Инфотипс, чтобы дополнить основную инструкцию или информацию. Если вы используете разные слова для перезаписи основной идеи, всплывающая подсказка не нужна.

- Инфотипс короткие и неблагоприятные. Используйте небольшие слова и простой, Повседневный язык, который поддерживает и способствует пользователю.

- Следуйте существующим рекомендациям корпорации Майкрософт по тексту и [стилю и тону](/windows/desktop/uxguide/text-style-tone) [пользовательского интерфейса](/windows/desktop/uxguide/text-ui) .

#### <a name="control-labels"></a>Метки элементов управления
 Метки элементов управления должны быть краткими, лаконичными и следовать [руководству по рабочему столу Windows для элементов управления](/windows/desktop/uxguide/controls).

 Дополнительные сведения о форматировании меток элементов управления и размещении в пользовательском интерфейсе см. в разделе [макет для Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md).

#### <a name="help-links"></a>Ссылки на справку
 Ссылки на справку можно поместить в пояснительный текст или в текст пользовательского интерфейса. Они могут быть ссылками на справку или запускать внутренние диалоги.

##### <a name="visual-style-rules-for-help-links"></a>Правила визуального стиля для ссылок справки

- Используйте правильные цвета окружения для гиперссылок. Если щелкнуть гиперссылку в правильном стиле, она не будет ненадолго красным. Если вы видите это, это означает, что цвета среды не используются.

- Подчеркивания следует использовать только при наведении указателя мыши или при внедрении ссылки в абзац.

- Более подробные сведения о стилях визуальных элементов и взаимодействии гиперссылок см. в разделе кнопки и гиперссылки.

##### <a name="writing-style-rules-for-help-links"></a>Написание правил стилей для ссылок справки

- При запуске диалоговых окон поддерживаются стандарты для эллипсов: без многоточия для навигации — многоточие, если задаче требуется дополнительный пользовательский интерфейс.

     ![Ссылка на справку в Visual Studio](../../extensibility/ux-guidelines/media/0601-e_helplink.png "0601 — e_HelpLink")

     **Многоточие (...) в ссылке справки указывает, что задаче потребуется дополнительный пользовательский интерфейс.**

- Ссылки не должны начинаться с «учиться», как это не является намерением пользователя. Пользователь хочет ответить на конкретный вопрос, не применяя общее образование.

- Ссылки на фразы справки, чтобы они запросили вопрос о том, что этот раздел ответит.

     Неверно: "Дополнительные сведения о ценах на мобильные службы Windows Azure"

     Верно: "какие варианты ценообразования доступны для мобильных служб Windows Azure".

- Никогда не используйте *Нажатие кнопки...* для текста ссылки.

- Никогда не компоновать только слово "здесь". Это проблематично для некоторых средств чтения с экрана, в результате чего будет выставляться только слово с гиперссылкой.

     Неверно: "найдите сведения о **мобильных службах** Windows Azure"

     Верно: "какие варианты ценообразования доступны для мобильных служб Windows Azure".

- Дополнительные сведения о правильном стиле записи для ссылок на справочные материалы см. в [руководстве по рабочему столу Windows](/windows/desktop/uxguide/winenv-help).

#### <a name="hint-text"></a>Текст подсказки
 Текст подсказки отображается в виде водяного знака в элементе управления или под элементом управления. Правильное форматирование будет применено с помощью соответствующего маркера Всколорс `Environment.GrayText` .

 Он может отображаться в нескольких формах.

- Вместо метки элемента управления:

     ![Снимок экрана элемента управления "раскрывающийся список" с текстом подсказки вместо метки элемента управления, считывающего "Поиск обозреватель решений (Ctrl +;)").](../../extensibility/ux-guidelines/media/0601-f_hinttext1.png "0601 — f_HintText1")

- С помощью команды предоставляет инструкции:

     ![Снимок экрана текстового поля с текстом подсказки в элементе управления, считывающем "Ввод имени".](../../extensibility/ux-guidelines/media/0601-g_hinttext2.png "0601 — g_HintText2")

- С текстом, указывающим на обязательную запись:

     ![Снимок экрана текстового поля с текстом подсказки в элементе управления, который считывает " \< Required \> ".](../../extensibility/ux-guidelines/media/0601-h_hinttext3.png "0601 — h_HintText3")

#### <a name="watermark-text"></a>Текст водяного знака
 В пустой области конструктора текст должен указывать, что делать, а также указывать ссылки для открытия других связанных окон, если это уместно:

 ![Текст водяного знака в Visual Studio](../../extensibility/ux-guidelines/media/0601-i_watermarktext.png "0601 — i_WatermarkText")

 **Пример текста водяного знака в Visual Studio**

### <a name="common-terminology"></a>Общая терминология

|Термин|Объяснение|Комментировать|
|----------|-----------------|-------------|
|Вход и выход|Глаголы, которые используются для представления проверки подлинности в веб-свойство, являются синонимами. В клиентах этот вариант используется один раз в качестве понятия верхнего уровня для входа и выхода из подключения пользователя IDE, которое представляет собой удостоверение верхнего уровня, предоставляющее возможности более высокого уровня, такие как роуминг и лицензирование, которые недоступны для всех других подключений.|Пользователь интегрированной среды разработки является единственной функцией, которая должна представлять команду входа и выхода, так как она представляет пользователя интегрированной среды разработки верхнего уровня.|
|Подключение и отключение|Используйте в местах, где компонент поддерживает одно подключение к веб-службе.|Обозреватель сервера, где в каждый момент времени может быть только одно активное подключение Azure, — пример подключения или отключения.|
|Добавить или удалить|Не разрушается. Используется при добавлении или удалении чего-либо из списка.|Диалоговое окно список серверов диспетчера подключений TFS — это пример добавления или удаления.|
|Удалить|Деструктив. Используйте, только если удаляемый элемент будет безвозвратно удален с диска.|При удалении файла с диска обычно требуется запрос на подтверждение удаления.|

## <a name="error-messages"></a>Сообщения об ошибках

### <a name="overview"></a>Обзор
 Происходят ошибки. Установка ограничений на то, что может сделать пользователь, — это разумный этап, позволяющий избежать появления сообщений об ошибках. Однако при возникновении ошибки правильно написанное сообщение об ошибке может привести к снижению проблемы. Сообщения об ошибках могут быть одним из наиболее важных типов уведомлений, которые видит пользователь, потому что они являются синхронными и указывают на проблему, которую необходимо решить. Плохо написанные сообщения об ошибках оставляют собственные пользователи, чтобы решить причину ошибок и возможные решения.

 Пользователи могут приостанавливаться уделять внимание нерекомендуемым или запутанным сообщениям об ошибках, поэтому следует записывать только необходимые сообщения, которые допишут пользователя. Если сообщение является просто уведомлением, используйте альтернативную презентацию.

### <a name="rules-for-creating-an-error-message"></a>Правила создания сообщения об ошибке

- При создании сообщений об ошибках выберите соответствующий уровень ошибок для аудитории. Для создания простых сводок, предоставляющих действия, которые пользователь может предпринять, если это применимо. Не следует ничего делать с тем, что пользователю не нужно знать.

- Предоставление помощи конструктивность. Проще читать и работать с сообщением об ошибке, содержащим инструкцию.

- Не используйте двойные отрицательные значения.

- Выполните автоматическую и ручную проверку грамматики и проверки орфографии для любого сообщения об ошибке, которое вы пишете.

- Для сложных сообщений об ошибках следует избегать последовательного взаимодействия. Никогда не используйте привязку F1 для сообщения об ошибке. Само сообщение должно быть достаточным.

- Используйте правильный значок.

- Вопросы, упрощающие понимание и использование кнопок с четкими параметрами, например "Удалить" и "Отмена".

- Для предупреждений необходимо четко определить, что будет следствием продолжения. Кнопки должны указывать на результат.

- Для ошибок Опишите, что может сделать пользователь для решения проблемы. Кнопки должны быть действиями или словами "Закрыть". Не используйте кнопку "ОК" для сообщения об ошибке.

- При создании сообщения об ошибке ответьте на некоторые вопросы:

  - Может ли пользователь определить, как устранить проблему только с этой ошибкой?

  - Использует ли пользователь тот же словарь, что и эта ошибка?

  - Это ошибка неоднозначной или Shared в нескольких ситуациях? Если да, то как вы подаете пользователям необходимое решение?

#### <a name="build-errors"></a>Ошибки сборки
 Поскольку Visual Studio является средством разработки программного обеспечения, многие его компоненты имеют шаг компиляции, преобразования или кодирования для преобразования работы разработчика в двоичную форму. Эти преобразования могут вызвать ошибки, когда компилятору не удается обработать неправильно созданные файлы или если параметры компилятора заданы неправильно.

 Пользователи Visual Studio могут потратить огромное количество времени на разработку, разрешающее ошибки сборки. Это время разрешения возрастает, когда ошибки связаны с зависимостями или когда сообщения об ошибках плохо записываются, что может усложнить обнаружение источника ошибки.

 Наиболее подходящие ошибки сборки — это те, которые не происходят на первом месте, поэтому Visual Studio обеспечивает Автозаполнение и волнистые линии IntelliSense. Средства проверки схемы и аналогичные инструменты предоставляют одинаковый вид отзыва. Эти механизмы заранее позволяют пользователю создавать правильно сформированный код, что уменьшает вероятность ошибок сборки.

 Visual Studio предоставляет окно инструментов, в котором пользователи могут читать и перемещаться по ошибкам, произошедшим в окнах документов. Сочетания клавиш предоставляются, чтобы пользователь мог быстро перейти к большим объемам кода и перейти непосредственно к месту возникновения проблемы. Visual Studio также позволяет привязывать каждую ошибку сборки к конкретному ключевому слову справки или ИДЕНТИФИКАТОРу контекста, чтобы пользователь мог перейти непосредственно к разделу справки, в котором содержатся более подробные сведения об ошибке.

 Записывать четкие, краткие ошибки сборки:

- **Используйте простой язык** , объясняющий проблему с небольшим числом жаргоне или отсутствием компилятора. Текст ошибки сборки не должен быть чрезмерно техническим.

- **Опишите возможные причины.** Например, "отсутствует двоеточие между свойством и значением в объявлении" (свойство): (значение) ".

- Предоставьте сведения о возможных исправлениях. Если места недостаточно, дополнительные сведения могут быть помещены в соответствующий раздел справки.

### <a name="components-of-a-well-written-error-message"></a>Компоненты хорошо написанного сообщения об ошибке

#### <a name="use-the-shell-dialog-service-for-error-messages"></a>Используйте службу диалоговых окон оболочки для сообщений об ошибках.
 С помощью службы диалогового окна оболочки можно управлять внешним видом сообщения, шрифты в частности, без существенных изменений в отдельных элементах. Используйте механизмы **IErrorInfo** и сообщайте о них с помощью **IVsUIShell:: сетерроринфо/репортерроринфо**.

#### <a name="choose-an-effective-and-appropriate-notification-presentation"></a>Выберите эффективную и соответствующую презентацию уведомлений.
 Используйте модальное диалоговое окно с критическим предупреждением, если требуется немедленное действие, чтобы избежать потери данных (синхронное уведомление). Критические значки зарезервированы в ситуациях, когда закрытие сообщения без его чтения может привести к негативным последствиям. Потери данных являются критически важными ситуациями, требующими ответа уровня сигнала. Чрезмерное число критических значков десенситизес пользователей к важности. Если сообщение об ошибке является информационным, рассмотрите альтернативы модальному диалоговому окну (Асинхронное уведомление).

#### <a name="provide-a-clean-succinct-explanation-of-why-the-problem-occurred-rather-than-a-technical-explanation"></a>Предоставьте четкое, краткое объяснение того, почему возникла проблема, а не техническое объяснение.
 Перегрузка пользователей с помощью технических подробностей объясняет, что они могут пропускать сообщения об ошибках. Примеры хорошего обмена сообщениями:

- «Не удается открыть запрошенный файл».

- «Не удается подключиться к Интернету».

#### <a name="provide-information-about-how-to-fix-the-problem"></a>Укажите сведения о том, как устранить проблему.
 Предлагают пользователю предложения по устранению проблемы. Будьте честны с пользователем, если нет никаких предложений. Предоставьте прямые ссылки на альтернативные сетевые источники, такие как техническая поддержка или поддержка сообщества. Постарайтесь указать пользователям конкретную Интернет-информацию, относящуюся к данной проблемы. Для идентификатора ошибки рекомендуется связать пользователей с потоком обсуждений об этой конкретной ошибке. Примеры хорошего обмена сообщениями:

- "Убедитесь, что вы подключены к Интернету, и повторите эту операцию".

- «Убедитесь, что файл существует и у вас есть разрешение на его открытие».

#### <a name="write-a-message-that-is-short-and-to-the-point"></a>Напишите короткое сообщение и в точку.
 Сообщение об ошибке может уведомлять, объяснить и предложить решение, но по-прежнему будет игнорироваться, если оно слишком словное. Одним из решений является использование прогрессивного раскрытия с кнопкой сведений. Например, дайте краткое описание или решение, а затем добавьте дополнительные сведения при нажатии кнопки подробностей. Если пользователи решили прочитать дополнительные сведения об ошибке, они могут сделать это.

 Язык в сообщении должен быть следующим:

- **Подходит для домена.** Используйте язык, который будет понятен пользователю. Несмотря на то, что наши клиенты являются разработчиками, они часто не имеют контекста и терминологии, которые у нас есть.

- **Зависящ.** Старайтесь не использовать неясные слова и давать связанные имена и расположения объектов. Например, неудобно использовать сообщение об ошибке, например "символ является недопустимым". Какой символ? "Файл не найден". Какой файл?

- **Учтивым.** Не обвинение пользователя или сделайте их глупо. Старайтесь не использовать вредоносные или оскорбительные языки (Kill, Execute, Terminate, неустранимые, недопустимые). Избегайте текста в верхнем регистре, который часто рассматривается как Шаутинг и не читается как доступный для чтения. Не используйте юмор.

- **Правильно.** Используйте правильные правописание и грамматику (даже в альфа-версии). Опечатки являются непрофессиональными и выводят вред.

- **Контекстно подходит.** Используйте соответствующий текст кнопки. Избегайте кнопки "ОК", а вместо этого используйте "продолжить" или "да/нет".

### <a name="error-message-examples"></a>Примеры сообщений об ошибках

|Хорошо|Плохое|
|----------|---------|
|"Номер телефона больше не находится в службе. Проверьте номер и повторите вызов или наберите 0 для оператора. "|-"Ошибка (449): недопустимое число"<br />— "Эта ошибка необработанного исключения указывает на успешное завершение операции".<br /><br /> ![Сообщение об ошибке в Visual Studio](../../extensibility/ux-guidelines/media/0602-a_errordialog.png "0602 — a_ErrorDialog")|

## <a name="accessing-help"></a>Получение доступа к справке

### <a name="overview"></a>Обзор
 Помимо документации в MSDN, пользователь Visual Studio имеет несколько точек доступа, которые помогают пользователю в пользовательском интерфейсе. Чтобы обеспечить постоянную доступность этих точек доступа, группам функций необходимо воспользоваться преимуществами справочной системы, предлагаемой средой. Эти точки доступа:

- **Пояснительный и дополнительный текст в диалоговых окнах.** Статический текст, предоставляющий направление или объяснение на поверхности пользовательского интерфейса или доступном при наведении указателя мыши на значок подсказки.

- **Справка F1** (только редактор). В редакторе Visual Studio пользователь может доверять этому в любой момент, нажав клавишу F1, чтобы открыть раздел справки, относящийся к текущему выделенному фрагменту. Убедитесь, что разделы, связанные с F1, являются подходящими и информативными.

- **Гиперссылки на разделы справки.** Гиперссылка в диалоговом окне, окне инструментов или области конструктора, которая запускает раздел, помогающий пользователю получить дополнительные сведения о технологии, возможностях или о том, как выполнить задачу.

- **Вспомогательные механизмы пользовательского интерфейса, такие как смарт-теги и создание диалоговых окон.** Эти механизмы помогают пользователю понять элемент пользовательского интерфейса или упростить задачу, такую как смарт-теги или диалоговые окна построителя.

- **Кнопки справки пользовательского интерфейса** (не рекомендуется). Видимый индикатор в строке заголовка, который предоставляет доступ к связанному разделу справки F1.

### <a name="text"></a>Текст

#### <a name="instructional-and-supplemental-text-in-dialogs"></a>Пояснительный и дополнительный текст в диалоговых окнах
 В диалоговых окнах, поддерживающих сложные задачи, может возникнуть необходимость дать пояснительный текст в пользовательском интерфейсе, часто в верхней части диалогового окна или рядом со сложными элементами управления. Дополнительные сведения о стиле записи см. в разделе [текст и терминология пользовательского интерфейса](../../extensibility/ux-guidelines/ui-text-and-help-for-visual-studio.md#BKMK_UITextAndTerminology) .

#### <a name="infotips"></a>инфотипс
 Часто пояснительный текст может быть слишком длинным для размещения в пользовательском интерфейсе или может быть полезен только для новых пользователей, что кажется ненужным для опытных пользователей. В этом случае пояснительный или информационный текст должен быть помещен в подсказку во всплывающей подсказке.

 Инфотипс должны располагаться рядом с элементами управления, к которым они относятся, и должен использовать конкретный значок всплывающей подсказки, который является ненавязчивым, но заметным.

 ![Подсказка в Visual Studio](../../extensibility/ux-guidelines/media/0601-d_infotip.png "0601 — d_InfoTip")

 **Пример подсказки в Visual Studio**

### <a name="interactive-help-mechanisms"></a>Интерактивные механизмы справки

#### <a name="f1-help"></a>справка F1
 Справка F1 требуется в редакторе или области конструктора, но не в других средах Visual Studio.

#### <a name="hyperlinks-to-help-topics"></a>Гиперссылки на разделы справки
 Гиперссылки можно использовать для выполнения действий, навигации в интегрированной среде разработки или запуска справки в браузере. См. раздел [текст и терминология пользовательского интерфейса](../../extensibility/ux-guidelines/ui-text-and-help-for-visual-studio.md#BKMK_UITextAndTerminology) для получения подробных сведений о языковых и 07.10.01 кнопках и гиперссылках для визуальных и макетных руководств.

#### <a name="help--buttons-in-dialog-title-bars-deprecated"></a>Кнопка "Справка" [?] в заголовках диалогового окна (не рекомендуется)
 По большей части кнопки справки [?] в заголовке диалоговых окон являются устаревшими. Разделы пользовательского интерфейса больше не являются частью нашей модели документов, поэтому в ней может быть нет соответствующего раздела для связывания. По сути, кнопка заголовка окна — это то же самое, что и Справка F1, которая больше не требуется в диалоговых окнах. В некоторых случаях это по-прежнему можно использовать в качестве индикатора, где доступна более концептуальная или процедурная информация, хотя гиперссылки чаще используются в более новом пользовательском интерфейсе.

##### <a name="dialogs-created-through-the-environment"></a>Диалоговые окна, созданные в среде
 Многие диалоговые окна оболочки создаются с помощью функции **вбдиалогбокспарам** . Эта общая функция была обновлена для помощи при перемещении кнопки **справки** из диалогового окна в **?** , сохраняя архитектуру с обратной совместимостью и расширяемостью.

 В частности, функция **вбдиалогбокспарам** рассматривает шаблон диалогового окна для кнопки, идентификатор которой — **идхелп** (9) или label — **Справка** или **&справку**. Если кнопка справки найдена, она скрыта, а стиль **WS_EX_CONTEXTHELP** добавляется в диалоговое окно, что помещает **?** в строке заголовка диалогового окна.

 Когда диалоговое окно будет создано, оно помещает процедуру диалогового окна в стек и вызывает диалоговое окно с предварительно обрабатывающей процедурой диалогового окна с именем **диалогпрепрок**. Когда **?** , она отправляет в диалоговое окно **WM_SYSCOMMAND** **SC_CONTEXTHELP** . **Диалогпрепрок** захватывает эту команду и изменяет ее на **WM_HELP** сообщение, которое передается в исходную процедуру диалогового окна.

 Большинство диалоговых окон, созданных в среде, имеют кнопку Справка в диалоговом окне. При отображении диалогового окна кнопка Справка будет скрыта и только **?** (работа). Если **?** (удалить или изменить) в Windows. это решение позволяет быстро вернуться к исходным кнопкам справки.

 Это решение делает четыре предположения, которые могут вызвать ошибки:

- Кнопка справки в диалоговом окне — **идхелп** (9).

- Диалоговое окно отображается правильно, когда кнопка "Справка" скрыта.

- Диалоговое окно не подставляет винпрок.

- Диалоговое окно не внедряется в другое диалоговое окно.

  Если диалоговое окно находится в мсенв и не использует **вбдиалогбокспарам**, изучите использование **вбдиалогбокспарам** перед реализацией собственного обработчика.

##### <a name="dialogs-created-through-other-packages"></a>Диалоговые окна, созданные с помощью других пакетов
 Вы можете реализовать собственное решение для диалоговых окон, которые находятся за пределами мсенв. Для общего класса диалогового окна в VSPackage рассмотрите возможность перемещения кнопки в строку заголовка или реализации обработчика в каждом диалоговом окне. Следующий код является скелетом реализации, которая поможет вам приступить к работе:

```
struct DLGPROCITEM
{
    FARPROC proc; // The info used to create the dialog.
    DLGPROCITEM* procPrev;
};

DLGPROCITEM* g_dlgProcStack = NULL;

// A dialog starter/wrapper function is used to push the new
// dialog proc to the top of our dialog proc stack.

int SomeDialogStarterFunction(hinst, id, proc, etc)
{
    if (g_dlgProcStack == NULL)
    {
        g_dlgProcStack = new DLGPROCITEM;
        g_dlgProcStack->procPrev = NULL;
    }
    else
    {
        DLGPROCITEM* procItem = new DLGPROCITEM;
        g_dlgProcStack->procPrev = g_dlgProcStack;
        g_dlgProcStack = procItem;
    }
}

// Pop this dialog proc off the dialog proc stack.

DialogBoxIndirectParam...(...)
{
    DLGPROCITEM* procItem = g_dlgProcStack->procPrev;
    delete g_dlgProcStack;
    g_dlgProcStack = procItem;
}

// A wrapper dialog procedure will allow us to capture the
// SC_CONTEXTHELP button on the title bar from Windows and
// forward it as a simple WM_HELP message back to the dialog.

INT_PTR CALLBACK DialogPreProc(HWND hwndDlg, UINT uMsg,
    WPARAM wParam, LPARAM lParam)
{
    if (uMsg == WM_SYSCOMMAND && wParam == SC_CONTEXTHELP)
    {
        uMsg = WM_HELP;
        wParam = 0;
        lParam = 0;
    }
    return CallWindowProc((WNDPROC)g_dlgProcStack->proc,
        hwndDlg, uMsg, wParam, lParam);
}
```

##### <a name="help-buttons-in-managed-code"></a>Кнопки справки в управляемом коде
 Переопределение поведения кнопки Справка по умолчанию в заголовке окна упрощается в управляемом коде. Ниже приведено полное демонстрационное приложение, демонстрирующее это поведение. По сути, необходимо переопределить метод **WndProc** формы, а затем запускать запросы справки F1 при перехвате **SC_CONTEXTHELP** сообщения.

```
using System;
using System.Windows.Forms;

public class HelpForm : Form
{
    private const int SC_CONTEXTHELP = 0xF180;
    private const int WM_SYSCOMMAND = 0x0112;

    public HelpForm()
    {
        this.ClientSize = new System.Drawing.Size(300, 250);
        this.HelpButton = true;
        this.MaximizeBox = false;
        this.MinimizeBox = false;
        this.Name = "HelpForm";
        this.Text = "Help Form";
    }

    protected override void WndProc(ref Message m)
    {
        if (m.Msg == WM_SYSCOMMAND && SC_CONTEXTHELP == (int)m.WParam)
            ShowHelp();
        else
            base.WndProc(ref m);
    }

    private void ShowHelp()
    {
        MessageBox.Show("F1 Help goes here.");
    }

     [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.EnableRTLMirroring();
        Application.Run(new HelpForm());
    }
}
```

## <a name="see-also"></a>См. также
- [Шрифты и форматирование для Visual Studio](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md)
- [Макет для Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md)
- [Уведомления и ход выполнения для Visual Studio](../../extensibility/ux-guidelines/notifications-and-progress-for-visual-studio.md)
