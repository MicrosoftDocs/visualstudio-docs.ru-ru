---
title: Создание приложения Node.js и Express
description: Из этого руководства вы узнаете, как в Visual Studio создать простое приложение Node.js с помощью платформы веб-приложений Express.
ms.date: 03/25/2021
ms.topic: tutorial
ms.devlang: javascript
author: mikejo5000
ms.author: mikejo
manager: jmartens
dev_langs:
- JavaScript
ms.workload:
- nodejs
ms.openlocfilehash: b3ffe7d2ac219f35d987a3f52551350a2af0fa5c
ms.sourcegitcommit: 00e16b9afe6b22ba0591e4d0d92690544e6d4357
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2021
ms.locfileid: "105617030"
---
# <a name="tutorial-create-a-nodejs-and-express-app-in-visual-studio"></a>Учебник. Создание приложения Node.js и Express в Visual Studio

В этом учебнике по разработке с помощью Node.js и Express в Visual Studio вы создадите простое веб-приложение Node.js, добавите в него код, изучите некоторые возможности интегрированной среды разработки и запустите приложение. 

::: moniker range="vs-2017"

Установите Visual Studio бесплатно со страницы [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/vs/older-downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=vs+2017+download), если еще не сделали этого.

::: moniker-end

::: moniker range="vs-2019"

Установите Visual Studio бесплатно со страницы [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/downloads), если еще не сделали этого.

::: moniker-end

В этом руководстве вы узнаете, как:
> [!div class="checklist"]
> * Создание проекта Node.js
> * Добавление кода
> * Использование IntelliSense для редактирования кода
> * Запуск приложения
> * Достижение точки останова в отладчике

## <a name="before-you-begin"></a>Подготовка к работе

Ниже приведен краткий список вопросов и ответов, с помощью которого вы сможете ознакомиться с некоторыми основными понятиями.

### <a name="what-is-nodejs"></a>Что такое Node.js?

Node.js — это серверная среда выполнения JavaScript, выполняющая сценарии JavaScript на стороне сервера.

### <a name="what-is-npm"></a>Что такое npm?

npm — это диспетчер пакетов по умолчанию для Node.js. Диспетчер пакетов упрощает публикацию и совместное использование исходного кода библиотек Node.js. Он предназначен для упрощения установки, обновления и удаления библиотек.

### <a name="what-is-express"></a>Что такое express?

Express — это платформа веб-приложений, используемая в качестве серверной платформы Node.js для сборки веб-приложений. Express позволяет выбирать различные платформы для создания внешнего пользовательского интерфейса, например Pug (в прошлом — Jade). В этом учебнике используется Pug.

## <a name="prerequisites"></a>Предварительные требования

* У вас должна быть установлена среда Visual Studio и должна иметься рабочая нагрузка "Разработка Node.js".

    ::: moniker range=">=vs-2019"
    Установите Visual Studio 2019 бесплатно со страницы [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/downloads/), если еще не сделали этого.
    ::: moniker-end
    ::: moniker range="vs-2017"
    Установите Visual Studio 2017 бесплатно со страницы [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/downloads/), если еще не сделали этого.
    ::: moniker-end

    Если вам нужно установить рабочую нагрузку, но вы уже используете Visual Studio, выберите пункт **Средства** > **Получить средства и компоненты...** , после чего запустится Visual Studio Installer. Выберите рабочую нагрузку **Разработка Node.js**, а затем элемент **Изменить**.

    ![Рабочая нагрузка Node.js в установщике Visual Studio](../ide/media/quickstart-nodejs-workload.png)

* У вас должна быть установлена среда выполнения Node.js.

    Если он не установлен, мы рекомендуем установить версию LTS с веб-сайта [Node.js](https://nodejs.org/en/download/) для обеспечения лучшей совместимости с внешними платформами и библиотеками. Node.js построен для 32-разрядных и 64-разрядных архитектур. Средства Node.js в Visual Studio, включенные в рабочую нагрузку Node.js, поддерживают обе версии. Однако требуется только одна, поскольку программа установки Node.js поддерживает только одну установку за раз.
    
    Как правило, Visual Studio автоматически обнаруживает установленную среду выполнения Node.js. Если установленная среда выполнения не обнаружена, вы можете настроить проект так, чтобы он ссылался на установленную среду выполнения, на странице свойств (после создания проекта щелкните его узел правой кнопкой мыши, выберите пункт **Свойства** и укажите **путь Node.exe**). Можно использовать глобальную установку Node.js или указать путь к локальному интерпретатору в каждом из проектов Node.js. 

    Этот учебник был протестирован с Node.js 8.10.0.

## <a name="create-a-new-nodejs-project"></a>Создание проекта Node.js

Visual Studio управляет файлами для отдельного приложения в *проекте*. Проект включает исходный код, ресурсы и файлы конфигурации.

В этом учебнике вы начнете работу с простого проекта, содержащего код для приложения Node.js и express.

1. Запустите Visual Studio.

1. Создайте новый проект.

    ::: moniker range=">=vs-2019"
    Нажмите клавишу **ESC**, чтобы закрыть окно запуска. Нажмите **CTRL+Q**, чтобы открыть поле поиска, введите **Node.js** и выберите **Create a new Basic Azure Node.js Express 4 application** (Создать простое приложение Node.js Express 4 в Azure) (JavaScript). В появившемся диалоговом окне выберите **Создать**.
    ::: moniker-end
    ::: moniker range="vs-2017"
    В верхней строке меню последовательно выберите **Файл**  > **Создать**  > **Проект**. В левой области диалогового окна **Новый проект** разверните узел **JavaScript** и выберите **Node.js**. В средней области выберите **Базовое приложение Azure Node.js Express 4** и нажмите кнопку **ОК**.
    ::: moniker-end
    Если шаблон проекта **Базовое приложение Azure Node.js Express 4** отсутствует, необходимо добавить рабочую нагрузку **Разработка Node.js**. Подробные инструкции см. в разделе [с предварительными требованиями](#prerequisites).

    Visual Studio создаст решение и откроет проект в правой области. Файл *app.js* проекта откроется в редакторе (в левой области).

    ![Структура проекта](../javascript/media/tutorial-project-structure.png)

    (1) **Полужирным** шрифтом выделен ваш проект, имя которого вы указали в окне **Новый проект**. В файловой системе этот проект представлен файлом *NJSPROJ* в папке проекта. Вы можете задать свойства и переменные среды, связанные с проектом, щелкнув его правой кнопкой мыши и выбрав пункт **Свойства**. Вы можете одновременно использовать и другие средства разработки, так как файл проекта не вносит изменения в источник проекта Node.js.

    (2) На верхнем уровне находится решение, имя которого по умолчанию совпадает с именем проекта. Решение, представленное на диске файлом *SLN*, является контейнером для одного или нескольких связанных проектов.

    (3) В узле npm представлены все установленные пакеты npm. Вы можете щелкнуть узел npm правой кнопкой мыши, чтобы найти и установить пакеты npm с помощью диалогового окна. Кроме того, установить и обновить пакеты можно с помощью параметров, доступных в файле *package.json* и контекстном меню узла npm.

    (4) *package.json* — это файл, используемый npm для управления зависимостями и версиями пакетов для локально установленных пакетов. Дополнительные сведения см. в разделе [Управление пакетами npm](../javascript/npm-package-management.md).

    (5) Файлы проекта, такие как *app.js*, отображаются в узле проекта. *app.js* — это файл запуска проекта, поэтому он выделяется **полужирным** шрифтом. Задать файл запуска можно, щелкнув правой кнопкой мыши файл в проекте и выбрав **Задать как файл запуска Node.js**.

1. Откройте узел **npm** и проверьте наличие необходимых пакетов npm.

    Если каких-либо пакетов не хватает (имеется значок с восклицательным знаком), можно щелкнуть правой кнопкой мыши узел **npm** и выбрать пункт **Установить пакеты npm**.

## <a name="add-some-code"></a>Добавление кода

Приложение использует Pug в качестве внешней платформы JavaScript. Pug использует простой код разметки, который компилируется в HTML. (Среда Pug задана в качестве обработчика представлений в *файле app.js*. Код, который задает обработчик представлений в *app.js*, — `app.set('view engine', 'pug');`.)

1. В обозревателе решений (правая область) откройте папку представлений, а затем откройте файл *index.pug*.

1. Замените содержимое следующей разметкой:

    ```js
    extends layout

    block content
      h1= title
      p Welcome to #{title}
      script.
        var f1 = function() { document.getElementById('myImage').src='#{data.item1}' }
      script.
        var f2 = function() { document.getElementById('myImage').src='#{data.item2}' }
      script.
        var f3 = function() { document.getElementById('myImage').src='#{data.item3}' }

      button(onclick='f1()') One!
      button(onclick='f2()') Two!
      button(onclick='f3()') Three!
      p
      a: img(id='myImage' height='200' width='200' src='')
    ```

    Предыдущий код используется для динамического создания HTML-страницы с заголовком и приветственным сообщением. Страница также содержит код, позволяющий отображать изображение, которое изменяется при каждом нажатии кнопки.

1. В папке маршрутов откройте файл *index.js*.

1. Добавьте следующий код перед вызовом `router.get`:

    ```js
    var getData = function () {
        var data = {
            'item1': 'http://public-domain-photos.com/free-stock-photos-1/flowers/cactus-76.jpg',
            'item2': 'http://public-domain-photos.com/free-stock-photos-1/flowers/cactus-77.jpg',
            'item3': 'http://public-domain-photos.com/free-stock-photos-1/flowers/cactus-78.jpg'
        }
        return data;
    }
    ````

    Этот код создает объект данных, который передается на динамически созданную HTML-страницу.

1. Замените вызов функции `router.get` следующим кодом:

    ```js
    router.get('/', function (req, res) {
        res.render('index', { title: 'Express', "data" });
    });
    ```

    Предыдущий код задает текущую страницу с помощью объекта маршрутизатора Express и отображает ее, передавая объект заголовка и данных. Файл *index.pug* указан здесь в качестве страницы для загрузки при запуске *index.js*. *index.js* настраивается в качестве маршрута по умолчанию в коде *app.js* (не показано).

    Чтобы продемонстрировать несколько возможностей Visual Studio, мы намеренно добавили ошибку в строку кода, содержащего функцию `res.render`. Необходимо исправить эту ошибку, прежде чем запустить приложение в следующем разделе.

## <a name="use-intellisense"></a>Использование IntelliSense

IntelliSense — это средство Visual Studio, которое помогает при написании кода.

1. В файле *index.js* перейдите к строке кода, содержащей `res.render`.

1. Установите курсор в конце строки `data`, введите `: get`, и IntelliSense покажет функцию `getData`, определенную ранее в этом коде. Выберите `getData`.

    ![Использование IntelliSense](../javascript/media/tutorial-nodejs-intellisense.png)

1. Добавьте круглые скобки, чтобы сформировать вызов функции (`getData()`).

1. Удалите запятую (`,`) перед элементом `"data"`, и выражение будет выделено зеленым цветом (подсветка синтаксиса). Наведите указатель на подсветку синтаксиса.

    ![Просмотр синтаксической ошибки](../javascript/media/tutorial-nodejs-syntax-checking.png)

    В последней строке этого сообщения указывается, что интерпретатор JavaScript ожидал запятую (`,`).

1. В нижней области откройте вкладку **Список ошибок** и выберите **Cборка + IntelliSense** для типа сообщаемых проблем.

    Вы увидите предупреждение и описание, а также имя файла и номер строки.

    ![Просмотр списка ошибок](../javascript/media/tutorial-nodejs-error-list.png)

1. Исправьте код, добавив запятую (`,`) перед элементом `"data"`.

    Исправленная строка кода должна выглядеть следующим образом: `res.render('index', { title: 'Express', "data": getData() });`

## <a name="set-a-breakpoint"></a>Установка точки останова

Затем вы запустите приложение с подключенным отладчиком Visual Studio. Но сначала задайте точку останова.

1. В файле *index.js* щелкните в левом внешнем поле перед следующей строкой кода, чтобы установить точку останова:

    `res.render('index', { title: 'Express', "data": getData() });`

    Точки останова — это один из самых простых и важных компонентов надежной отладки. Точка останова указывает, где Visual Studio следует приостановить выполнение кода, чтобы вы могли проверить значения переменных или поведение памяти либо выполнение ветви кода.

    ![Установка точки останова](../javascript/media/tutorial-nodejs-set-breakpoint.png)

## <a name="run-the-application"></a>Запуск приложения

1. На панели инструментов отладки выберите целевой объект отладки, например **веб-сервер(Google Chrome)** или **веб-сервер (Microsoft Edge)** .

    ::: moniker range=">=vs-2019"
    ![Выбор целевого объекта отладки](../javascript/media/vs-2019/tutorial-nodejs-deploy-target.png)
    ::: moniker-end
    ::: moniker range="vs-2017"
    ![Выбор целевого объекта отладки](../javascript/media/tutorial-nodejs-deploy-target.png)
    ::: moniker-end

    Если Chrome установлен на вашем компьютере, но отсутствует в списке, выберите **Просмотреть с помощью** в раскрывающемся списке целевых объектов отладки, а затем установите Chrome в качестве целевого объекта отладки по умолчанию (выберите **По умолчанию**).

1. Чтобы запустить приложение, нажмите клавишу **F5** (**Отладка** > **Начать отладку**).

    Отладчик приостановит выполнение в заданной точке останова. Теперь можно изучить состояние приложения.

1. Наведите указатель на функцию `getData`, чтобы увидеть ее свойства в подсказке по данным.

    ![Проверка переменных](../javascript/media/tutorial-nodejs-inspect-variables.png)

1. Чтобы продолжить, нажмите клавишу **F5** (**Отладка** > **Продолжить**).

    Приложение откроется в браузере.

    В окне браузера вы увидите заголовок "Express" и фразу "Welcome to Express" в первом абзаце.

1. Нажимайте кнопки, чтобы просмотреть различные изображения.

    ![Выполняемые в браузере приложения](../javascript/media/tutorial-nodejs-running-in-browser.png)

1. Закройте веб-браузер.

## <a name="optional-publish-to-azure-app-service"></a>(Необязательно) Публикация в Службу приложений Azure

1. В обозревателе решений щелкните проект правой кнопкой мыши и выберите пункт **Опубликовать**.

   ![Публикация в службу приложений Azure](../javascript/media/tutorial-nodejs-publish-to-azure.png)

1. Выберите цель **Служба приложений Microsoft Azure**.

    В диалоговом окне **Служба приложений** можно войти в учетную запись Azure и подключиться к существующим подпискам Azure.

1. Выполните дальнейшие инструкции, чтобы выбрать подписку, выбрать или создать группу ресурсов, выбрать или создать план службы приложений, а затем, когда будет предложено, выполните инструкции по публикации в Azure. Более подробные инструкции см. на странице [Публикация на веб-сайте Azure с помощью веб-развертывания](https://github.com/Microsoft/nodejstools/wiki/Publish-to-Azure-Website-using-Web-Deploy).

1. В окне **Вывод** показан ход выполнения развертывания в Azure.

    После успешного развертывания в браузере откроется приложение, выполняющееся в Службе приложений Azure. Нажмите кнопку, чтобы отобразить изображение.

   ![Приложение, работающее в Службе приложений Azure](../javascript/media/tutorial-nodejs-running-in-azure.png)

Поздравляем с завершением этого учебника!

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Развертывание приложения в службе приложений Linux](../javascript/publish-nodejs-app-azure.md)

> [!div class="nextstepaction"]
> [Расширение языковой службы AngularJS](https://devblogs.microsoft.com/visualstudio/angular-language-service-for-visual-studio)
