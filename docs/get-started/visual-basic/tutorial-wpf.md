---
title: Создание приложения Hello World с помощью WPF на Visual Basic
description: Создание простого приложения Windows Desktop .NET на Visual Basic в Visual Studio с помощью платформы пользовательского интерфейса Windows Presentation Foundation (WPF).
ms.custom: seodec18, get-started
ms.date: 04/23/2019
ms.technology: vs-ide-general
ms.prod: visual-studio-windows
ms.topic: tutorial
dev_langs:
- VB
ms.assetid: f84339c7-d617-4f56-bfcd-af2215c347ba
author: ornellaalt
ms.author: ornella
manager: jmartens
ms.workload:
- dotnet
ms.openlocfilehash: 00b8488682674b2531bac561e9f2536e616800fb
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99944372"
---
# <a name="tutorial-create-a-simple-application-with-visual-basic"></a>Учебник. Создание простого приложения с помощью Visual Basic

При изучении этого руководства вы ознакомитесь со многими инструментами, диалоговыми окнами и конструкторами, которые можно использовать для разработки приложений в Visual Studio. Вам предстоит создать простое приложение "Hello, World", разработать пользовательский интерфейс, добавить код и выполнить отладку, одновременно приобретая навыки работы в интегрированной среде разработки ([IDE](visual-studio-ide.md)).

::: moniker range="vs-2017"

Установите Visual Studio бесплатно со страницы [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/vs/older-downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=vs+2017+download), если еще не сделали этого.

::: moniker-end

::: moniker range=">=vs-2019"

Установите Visual Studio бесплатно со страницы [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/downloads), если еще не сделали этого.

::: moniker-end

## <a name="configure-the-ide"></a>Настройка интегрированной среды разработки (IDE)

::: moniker range="vs-2017"

При первом открытии Visual Studio вам будет предложено выполнить вход. Для целей этого руководства это необязательно. Затем может появиться диалоговое окно, в котором предлагается выбрать параметры разработки и цветовую тему. Оставьте значения по умолчанию и нажмите **Запуск Visual Studio**.

![Диалоговое окно "Выбор параметров"](../media/exploreide-settings.png)

После запуска Visual Studio вы увидите окна инструментов, меню и панели инструментов, а также основную область окна. Окна инструментов закреплены в левой и правой частях окна приложения, а панель **Быстрый запуск**, строка меню и стандартная панель инструментов закреплены в верхней его части. В центре окна приложения находится **Начальная страница**. При загрузке решения или проекта редакторы и конструкторы отображаются в области **Начальной страницы** . При разработке приложения чаще всего используется именно эта область.

![Visual Studio 2017. Интегрированная среда разработки, в которой установлены общие параметры](../media/exploreide-idewithgeneralsettings.png)

::: moniker-end

::: moniker range=">=vs-2019"

При запуске Visual Studio сначала открывается начальное окно. Выберите **Продолжить без кода**, чтобы открыть среду разработки. Вы увидите окна инструментов, меню и панели инструментов, а также основную область окна. Окна инструментов закреплены в левой и правой частях окна приложения, а поле поиска, строка меню и стандартная панель инструментов закреплены в верхней его части. При загрузке решения или проекта редакторы и конструкторы отображаются в центральной области окна приложения. При разработке приложения чаще всего используется именно эта область.

::: moniker-end

## <a name="create-the-project"></a>Создание проекта

При создании приложения в Visual Studio необходимо сначала создать проект и решение. Этот пример демонстрирует создание проекта Windows Presentation Foundation (WPF).

::: moniker range="vs-2017"

1. Создайте новый проект. В строке меню выберите **Файл** > **Новый** > **Проект**.

     ![В строке меню выберите "Файл", "Создать", "Проект"](../media/exploreide-filenewproject.png)

2. В диалоговом окне **Новый проект** выберите категорию **Установленные** > **Visual Basic** > **Рабочий стол Windows**, а затем выберите шаблон **Приложения WPF (.NET Framework)** . Присвойте проекту имя **HelloWPFApp** и щелкните **ОК**.

     ![Шаблон приложения WPF в диалоговом окне нового проекта Visual Studio](media/exploreide-newproject-vb.png)

Visual Studio создает решение и проект HelloWPFApp, а в **обозревателе решений** выводятся различные файлы. **Конструктор WPF** отображает представление кода и представление XAML *MainWindow.xaml* в представлении с разделением. Сдвигая разделитель, можно делать любое из представлений больше или меньше. Можно выбрать для просмотра только визуальное представление или только представление XAML. В **Обозревателе решений** отображаются следующие элементы.

![Обозреватель решений с добавленными файлами HelloWPFApp](../media/exploreide-hellowpfappfiles.png)

::: moniker-end

::: moniker range="vs-2019"

1. Запустите Visual Studio 2019.

2. На экране **Создание нового проекта** задайте в поиске WPF, в результатах выберите **Приложение WPF (.NET Framework)** и щелкните **Далее**.

   ![Шаблон приложения WPF в диалоговом окне нового проекта Visual Studio](media/vs-2019/exploreide-newprojectvb-vs2019.png)

3. На следующем экране присвойте проекту имя **HelloWPFApp** и щелкните **Создать**.

Visual Studio создает решение и проект HelloWPFApp, а в **обозревателе решений** выводятся различные файлы. **Конструктор WPF** отображает представление кода и представление XAML *MainWindow.xaml* в представлении с разделением. Сдвигая разделитель, можно делать любое из представлений больше или меньше. Можно выбрать для просмотра только визуальное представление или только представление XAML. В **Обозревателе решений** отображаются следующие элементы.

![Обозреватель решений с добавленными файлами HelloWPFApp](../media/vs-2019/exploreide-hellowpfappfiles.png)

::: moniker-end

> [!NOTE]
> Дополнительные сведения о XAML (eXtensible Application Markup Language) см. в [обзоре XAML для WPF](/dotnet/framework/wpf/advanced/xaml-overview-wpf).

После создания проекта его можно настраивать. С помощью окна **Свойства** (в меню **Вид** ) можно отображать и изменять параметры элементов проекта, элементов управления и других элементов в приложении.

### <a name="change-the-name-of-mainwindowxaml"></a>Изменение имени MainWindow.xaml

Давайте присвоим файлу MainWindow более конкретное имя. В **обозревателе решений** щелкните правой кнопкой мыши файл *MainWindow.xaml* и выберите команду **Переименовать**. Измените имя файла на *Greetings.xaml*.

## <a name="design-the-user-interface-ui"></a>Конструирование пользовательского интерфейса (ИП)

Если конструктор не открыт, выберите в **обозревателе решений** файл *Greetings.xaml* и нажмите клавиши **SHIFT**+**F7**, чтобы открыть его.

В приложение будет добавлено три типа элементов управления: элемент управления <xref:System.Windows.Controls.TextBlock>, два элемента управления <xref:System.Windows.Controls.RadioButton> и элемент управления <xref:System.Windows.Controls.Button>.

### <a name="add-a-textblock-control"></a>Добавление элемента управления TextBlock

1. Нажмите клавиши **CTRL**+**Q** для активации поля поиска и введите **Панель элементов**. Выберите в списке результатов **Представление > Панель элементов**.

2. В окне **Панель элементов** разверните узел **Типовые элементы управления WPF**, чтобы увидеть элемент управления TextBlock.

     ![Панель элементов с выделенным элементом управления TextBlock](../media/exploreide-textblocktoolbox.png)

3. Добавьте элемент управления TextBlock в область конструктора, выбрав элемент управления **TextBlock** и перетащив его в окно. Отцентрируйте этот элемент в верхней части окна. В Visual Studio 2019 и более поздних версиях для выравнивания элемента управления по центру можно использовать красные направляющие.

Окно должно выглядеть так, как показано на следующем рисунке:

![Элемент управления TextBlock в форме Greetings](../media/exploreide-greetingswithtextblockonly.png)

Разметка XAML должна выглядеть приблизительно так, как в следующем примере:

```xaml
<TextBlock HorizontalAlignment="Left" Margin="381,100,0,0" TextWrapping="Wrap" Text="TextBlock" VerticalAlignment="Top"/>
```

### <a name="customize-the-text-in-the-text-block"></a>Настройка текста в текстовом блоке

1. В представлении XAML найдите разметку для TextBlock и измените атрибут Text:

   ```xaml
   Text="Select a message option and then choose the Display button."
   ```

2. При необходимости снова разместите элемент TextBlock по центру и сохраните изменения сочетанием клавиш CTRL+S или с помощью пункта меню **Файл**.

Следующий шаг — добавить в форму два элемента управления [RadioButton](/dotnet/framework/wpf/controls/radiobutton).

### <a name="add-radio-buttons"></a>Добавление переключателей

1. На **панели элементов** найдите элемент управления **RadioButton**.

     ![Окно панели элементов с выбранным элементом управления RadioButton](../media/exploreide-radiobuttontoolbox.png)

2. Добавьте два элемента управления RadioButton в область конструктора, выбрав элемент **RadioButton** и перетащив его в область конструктора. Переместите кнопки (выбрав их и используя клавиши со стрелками), чтобы кнопки отображались рядом под элементом управления TextBlock. Используйте красные направляющие для выравнивания элемента управления.

     Окно должно выглядеть следующим образом:

     ![Форма приветствия с элементом управления TextBlock и двумя переключателями](../media/exploreide-greetingswithradiobuttons.png)

3. В окне **Свойства** для левого элемента управления RadioButton измените свойство **Имя** (свойство в верхней части окна **Свойства** ), задав ему значение `HelloButton`.

     ![Окно свойств RadioButton](../media/exploreide-buttonproperties.png)

4. В окне **Свойства** правого элемента управления RadioButton измените свойство **Имя**, задав ему значение `GoodbyeButton`, и затем сохраните изменения.

Теперь можно добавить отображаемый текст для каждого элемента управления RadioButton. Следующая процедура обновляет свойство **Content** элемента управления RadioButton.

### <a name="add-display-text-for-each-radio-button"></a>Добавление отображаемого текста для каждого переключателя

Измените атрибут **Content** для кнопок `HelloButton` и `GoodbyeButton` на `"Hello"` и `"Goodbye"` в XAML. Разметка XAML теперь должна выглядеть следующим образом:

   ```xaml
   <Grid>
        <TextBlock HorizontalAlignment="Left" Margin="252,47,0,0" TextWrapping="Wrap" Text="Select a message option and then choose the Display button." VerticalAlignment="Top"/>
        <RadioButton x:Name="HelloButton" Content="Hello" HorizontalAlignment="Left" Margin="297,161,0,0" VerticalAlignment="Top"/>
        <RadioButton x:Name="GoodbyeButton" Content="Goodbye" HorizontalAlignment="Left" Margin="488,161,0,0" VerticalAlignment="Top"/>
   </Grid>
   ```

### <a name="set-a-radio-button-to-be-checked-by-default"></a>Задание переключателя, выбранного по умолчанию

На этом этапе мы настроим элемент HelloButton как выбранный по умолчанию, чтобы всегда был выбран один из переключателей.

В представлении XAML найдите разметку для элемента HelloButton и добавьте атрибут **IsChecked**:

```xaml
IsChecked="True"
```

Последний элемент пользовательского интерфейса, который вам предстоит добавить, — это [Button](/dotnet/framework/wpf/controls/button).

### <a name="add-the-button-control"></a>Добавление элемента управления Button

1. На **панели элементов** найдите элемент управления **Button** и добавьте его в область конструктора под элементами управления RadioButton, перетащив его на форму в представлении конструирования. Если вы используете Visual Studio 2019 или более позднюю версию, выровнять элемент управления по центру можно с помощью красной линии.

2. В представлении XAML измените значение свойства **Содержимое** элемента управления Button с `Content="Button"` на `Content="Display"` и сохраните изменения.

     Разметка должна быть аналогична разметке, приведенной в следующем примере: `<Button Content="Display" HorizontalAlignment="Left" VerticalAlignment="Top" Width="75" Margin="215,204,0,0"/>`

     Окно должно выглядеть так, как показано на следующем рисунке.

     ![Форма Greetings с метками элементов управления](../media/exploreide-greetingswithcontrollabels.png)

### <a name="add-code-to-the-display-button"></a>Добавление кода к кнопке Display

После запуска приложения окно сообщения появится только тогда, когда пользователь выберет переключатель, а затем нажмет кнопку **Display**. Одно окно сообщения появится для Hello, и другое — для Goodbye. Для создания такого поведения добавьте код в событие `Button_Click` в файле *Greetings.xaml.vb* или *Greetings.xaml.cs*.

1. На поверхности разработки дважды щелкните кнопку **Display** .

     Будет открыт файл *Greetings.xaml.vb*, а курсор установлен на событии `Button_Click`.

    ```vb
    Private Sub Button_Click(sender As Object, e As RoutedEventArgs)

    End Sub
    ```

2. Введите следующий код:

    ```vb
    If HelloButton.IsChecked = True Then
        MessageBox.Show("Hello.")
    ElseIf GoodbyeButton.IsChecked = True Then
        MessageBox.Show("Goodbye.")
    End If
    ```

3. Сохраните приложение.

## <a name="debug-and-test-the-application"></a>Отладка и тестирование приложения

После этого вам предстоит отладить приложение для выявления ошибок и тестирования того, что оба окна сообщений отображаются правильно. Приведенные ниже инструкции описывают, как выполнить сборку и запустить отладчик (дополнительные сведения см. в разделах [Построение приложения WPF](/dotnet/framework/wpf/app-development/building-a-wpf-application-wpf) и [Отладка WPF](../../debugger/debugging-wpf.md)).

### <a name="find-and-fix-errors"></a>Поиск и исправление ошибок

В этом шаге вам предстоит найти ошибку, которую мы намеренно допустили ранее, изменив имя файла *MainWindow.xaml*.

#### <a name="start-debugging-and-find-the-error"></a>Начало отладки и поиск ошибки

1. Запустите отладчик, нажав клавишу **F5** или выбрав пункты меню **Отладка** и **Начать отладку**.

   Появится окно **Режим приостановки выполнения**, а в окне **Вывод** будет указано, что произошло исключение IOException: "Не удается найти ресурс mainwindow.xaml".

   ![Снимок экрана с сообщением IOException](../media/exploreide-ioexception.png)

2. Остановите отладчик, выбрав в меню **Отладка** > **Остановить отладку**.

Мы переименовали *MainWindow.xaml* в *Greetings.xaml* в начале этого руководства, но код приложения по-прежнему ссылается на *MainWindow.xaml* как универсальный код ресурса (URI), поэтому проект не может быть запущен.

#### <a name="specify-greetingsxaml-as-the-startup-uri"></a>Задание Greetings.xaml в качестве начального универсального кода ресурса (URI)

1. В **обозревателе решений** откройте файл *Application.xaml*.

2. Измените `StartupUri="MainWindow.xaml"` на `StartupUri="Greetings.xaml"` и сохраните изменения.

Запустите отладчик снова (клавишей **F5**). Должно появиться окно **Greetings** приложения.

::: moniker range="vs-2017"
![Снимок экрана с запущенным приложением](media/exploreide-wpf-running-app.png)
::: moniker-end
::: moniker range=">=vs-2019"
![Снимок экрана с запущенным приложением](media/vs-2019/exploreide-wpf-running-app.png)
::: moniker-end

 Теперь закройте окно приложения, чтобы остановить отладку.

### <a name="debug-with-breakpoints"></a>Отладка с точками останова

Добавив точки останова, можно тестировать код во время отладки. Точки останова можно добавлять, выбирая в меню **Отладка** > **Точка останова**, щелкая в левом поле редактора рядом со строкой кода, в которой требуется приостановить выполнение, или нажимая клавишу **F9**.

#### <a name="add-breakpoints"></a>Добавление точек останова

1. Откройте файл *Greetings.xaml.vb* и выделите строку `MessageBox.Show("Hello.")`.

2. Добавьте точку останова, нажав клавишу **F9** или выбрав меню **Отладка**, а затем — **Точка останова**.

   Рядом со строкой кода в крайнем левом поле окна редактора появится красный кружок.

3. Выделите следующую строку: `MessageBox.Show("Goodbye.")`.

4. Нажмите клавишу **F9**, чтобы добавить точку останова, а затем нажмите клавишу **F5**, чтобы начать отладку.

5. В окне **Greetings** выберите переключатель **Hello** и нажмите кнопку **Display** .

   Строка `MessageBox.Show("Hello.")` выделяется желтым цветом. В нижней части интегрированной среды разработки слева закреплены окна "Видимые", "Локальные" и "Контрольные значения", а справа — окна "Стек вызовов", "Точки останова", "Параметры исключений", "Команда", "Интерпретация" и "Вывод".

   ![Снимок экрана с точкой останова в отладчике](media/exploreide-debugbreakpoint.png)

6. В строке меню выберите **Отладка** > **Шаг с выходом**.

     Приложение возобновит выполнение, и появится окно сообщения со словом "Hello".

7. Нажмите кнопку **ОК** в окне сообщения, чтобы закрыть его.

8. В окне **Greetings** выберите переключатель **Goodbye** и нажмите кнопку **Display** .

     Строка `MessageBox.Show("Goodbye.")` выделяется желтым цветом.

9. Нажмите клавишу **F5**, чтобы продолжить отладку. Когда появится окно сообщения, нажмите в нем кнопку **ОК** , чтобы закрыть его.

10. Закройте окно приложения, чтобы остановить отладку.

11. В строке меню выберите **Отладка** > **Выключить все точки останова**.

### <a name="view-a-representation-of-the-ui-elements"></a>Просмотр представления элементов пользовательского интерфейса

В работающем приложении в верхней части окна должно отображаться мини-приложение. Это вспомогательное средство времени выполнения, обеспечивающее быстрый доступ к некоторым полезным функциям отладки. Нажмите первую кнопку, которая называется **Перейти к динамическому визуальному дереву**. Должно отобразиться окно с деревом, содержащим все визуальные элементы страницы. Разверните узлы, чтобы найти добавленные кнопки.

![Снимок экрана: окно динамического визуального дерева](media/vs-2019/exploreide-live-visual-tree.png)

### <a name="build-a-release-version-of-the-application"></a>Сборка окончательной версии приложения

Теперь, когда вы проверили, что все работает, можно подготовить окончательную сборку приложения.

1. Выберите в главном меню **Сборка** > **Очистить решение** для удаления промежуточных файлов и выходных файлов, которые были созданы в ходе предыдущих сборок. Это не является обязательным, но очищает результаты отладочной сборки.

2. Измените конфигурацию сборки для HelloWPFApp с **Отладка** на **Выпуск** с помощью раскрывающегося списка на панели инструментов (сейчас это "Отладка").

3. Выполните сборку решения, выбрав **Сборка** > **Собрать решение**.

Поздравляем с завершением этого учебника! Построенный файл *.exe* находится в каталоге решения и проекта ( *...\HelloWPFApp\HelloWPFApp\bin\Release*).

## <a name="see-also"></a>См. также

::: moniker range="vs-2017"

- [Новые возможности Visual Studio 2017](../../ide/whats-new-visual-studio-2017.md)
- [Советы по повышению производительности](../../ide/productivity-features.md)

::: moniker-end

::: moniker range="vs-2019"

- [Новые возможности Visual Studio 2019](../../ide/whats-new-visual-studio-2019.md)
- [Советы по повышению производительности](../../ide/productivity-features.md)

::: moniker-end