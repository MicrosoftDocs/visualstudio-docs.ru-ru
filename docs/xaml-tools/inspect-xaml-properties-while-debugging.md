---
title: Проверять свойства XAML во время отладки | Документация Майкрософт
description: Узнайте, как использовать динамическое визуальное дерево и динамические средства обозревателя свойств во время отладки для проверки свойств XAML и получения представления элементов пользовательского интерфейса в виде дерева.
ms.custom: SEO-VS-2020
ms.date: 03/02/2021
ms.topic: how-to
ms.assetid: 390edde4-7b8d-4c89-8d69-55106b7e6b11
author: TerryGLee
ms.author: tglee
manager: jmartens
ms.workload:
- uwp
ms.openlocfilehash: 86310346566e8c937c2769a9fcc9f0d4e98b3ae2
ms.sourcegitcommit: 5fb4a67a8208707e79dc09601e8db70b16ba7192
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "112308445"
---
# <a name="inspect-xaml-properties-while-debugging"></a>Просмотр свойств XAML во время отладки

Вы можете получить представление о выполнении кода XAML в режиме реального времени с помощью **динамического визуального дерева** и **динамического обозревателя свойств**. Эти средства обеспечивают представление элементов пользовательского интерфейса выполняющегося приложения XAML в виде дерева, а также отображение свойств среды выполнения любого выбранного элемента интерфейса.

Эти средства можно использовать в следующих конфигурациях.

|Тип приложения|Операционная система и средства|
|-----------------|--------------------------------|
|Приложения Windows Presentation Foundation (4.0 и более поздних версий)|Windows 7 и более поздних версий|
|Универсальные приложения для Windows|Windows 10 и более поздней версии с [пакетом SDK для Windows 10](https://dev.windows.com/downloads/windows-10-sdk)|

## <a name="look-at-elements-in-the-live-visual-tree"></a>Просмотр элементов в динамическом визуальном дереве

Начнем с очень простого приложения WPF со списком и кнопкой. При каждом нажатии кнопки в список добавляется еще один элемент. Четные элементы показаны серым, а нечетные — желтым цветом.

### <a name="create-the-project"></a>Создание проекта

::: moniker range=">=vs-2019"

1. Создайте новое приложение C# WPF (**файл** > **создать** > **проект**, введите "C# WPF", выберите шаблон проекта **приложения WPF** , назовите проект **тестксамл**, а затем убедитесь, что в раскрывающемся списке **Целевая платформа** отображается **.NET Core 3,1** .

::: moniker-end

::: moniker range="vs-2017"

1. Создайте новое приложение c# WPF (**файл**  >  **создать**  >  **проект**, затем введите C# WPF и выберите **приложение WPF (платформа .NET Framework)**). Назовите его **TestXAML**.

::: moniker-end

1. Измените файл MainWindow.xaml следующим образом.

   ```xaml
   <Window x:Class="TestXAML.MainWindow"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:local="clr-namespace:TestXAML"
      mc:Ignorable="d"
      Title="MainWindow" Height="350" Width="525">
      <Grid>
         <Button x:Name="button" Background="LightBlue" Content="Add Item" HorizontalAlignment="Left" Margin="216,206,0,0" VerticalAlignment="Top" Width="75" Click="button_Click"/>
         <ListBox x:Name="listBox" HorizontalAlignment="Left" Height="100" VerticalAlignment="Top" Width="100" Margin="205,80,0,0"/>
      </Grid>
   </Window>
   ```

1. Добавьте следующий обработчик команд в файл MainWindow.xaml.cs:

   ```csharp
   int count;

   private void button_Click(object sender, RoutedEventArgs e)
   {
      ListBoxItem item = new ListBoxItem();
      item.Content = "Item" + ++count;
      if (count % 2 == 0)
      {
         item.Background = Brushes.LightGray;
      }
      else
      {
         item.Background = Brushes.LightYellow;
      }
      listBox.Items.Add(item);
   }
   ```

1. Выполните сборку решения и запустите отладку. (В качестве конфигурации сборки нужно выбрать отладку, а не выпуск. Дополнительные сведения о конфигурациях сборки см. в разделе [Основные сведения о конфигурациях сборки](../ide/understanding-build-configurations.md).)

   После появления этого окна в работающем приложении появится панель инструментов в приложении.

   ::: moniker range=">= vs-2019"
   ![Главное окно приложения](../debugger/media/vs-2019/livevisualtree-app.png "LiveVIsualTree-App")
   ::: moniker-end
   ::: moniker range="vs-2017"
   ![Главное окно приложения](../debugger/media/livevisualtree-app.png "LiveVIsualTree-App")
   ::: moniker-end

1. Теперь нажмите кнопку **Добавить элемент** несколько раз, чтобы добавить новые элементы в список.

### <a name="inspect-xaml-properties"></a>Проверка свойств XAML

1. Затем откройте окно **динамического визуального дерева** , нажав кнопку с крайней левой кнопкой на панели инструментов в приложении (или выбрав **Отладка > Windows > динамическое визуальное дерево**). После его открытия перетащите его с позиции закрепления, чтобы мы могли взглянуть на это окно и окно свойств в **реальном времени** рядом.

1. В окне **динамического визуального дерева** разверните узел **ContentPresenter**. Он должен содержать узлы для кнопки и списка. Разверните список (а затем **ScrollContentPresenter** и **ItemsPresenter**), чтобы найти элементы списка.

   ::: moniker range=">= vs-2019"
   Если вы не видите узел **ContentPresenter** , переключите значок **Показать только мой XAML** на панели инструментов. Начиная с Visual Studio 2019 версии 16,4, представление элементов XAML упрощено по умолчанию с помощью функции "только мой XAML". Можно также [отключить этот параметр](../debugger/general-debugging-options-dialog-box.md) в параметрах, чтобы всегда показывать все элементы XAML.
   ::: moniker-end

   Окно должно выглядеть следующим образом:

   ::: moniker range=">= vs-2019"
   ![Элементы ListBoxItems в динамическом визуальном дереве](../debugger/media/vs-2019/livevisualtree-listboxitems.png "LiveVisualTree-ListBoxItems")
   ::: moniker-end
   ::: moniker range="vs-2017"
   ![Элементы ListBoxItems в динамическом визуальном дереве](../debugger/media/livevisualtree-listboxitems.png "LiveVisualTree-ListBoxItems")
   ::: moniker-end

1. Вернитесь в окно приложения и добавьте еще несколько элементов. В **динамическом визуальном дереве** появится больше элементов списка.

1. Теперь давайте взглянем на свойства одного из элементов списка.

   Выберите первый элемент списка в **динамическом визуальном дереве** и щелкните значок **Показать свойства** на панели инструментов. Должно появиться окно **динамического обозревателя свойств**. Обратите внимание, что поле **содержимого** имеет значение «Item1» , а  >  поле **Цвет** фона — **#FFFFFFE0**.

1. Вернитесь в **динамическое визуальное дерево** и выберите второй элемент списка. **Обозреватель свойств Live** должен показывать, что поле **содержимого** имеет значение «Item2», а поле   >  **Цвет** фона — **#FFD3D3D3** (в зависимости от темы).

   > [!NOTE]
   > Желтая граница вокруг свойства в **обозревателе свойств Live** означает, что значение свойства задается через привязку, например `Color = {BindingExpression}` . Зеленая граница означает, что значение задается с помощью ресурса, например `Color = {StaticResource MyBrush}` .

   Фактическая структура XAML-кода содержит много элементов, которые, возможно, не будут интересовать вас напрямую, и в случае не слишком хорошего знания кода навигация по дереву может быть затруднительной. Поэтому **динамическое визуальное дерево** обеспечивает несколько способов, которые позволяют использовать пользовательский интерфейс приложения для поиска элемента, который вы хотите изучить.

   ::: moniker range=">= vs-2019"
   **Выберите элемент в работающем приложении**. Вы можете включить этот режим, выбрав крайнюю левую кнопку на панели инструментов **динамического визуального дерева**. Когда этот режим включен, можно выбрать элемент пользовательского интерфейса в приложении, и данные **динамического визуального дерева** (а также **динамического обозревателя свойств**) автоматически обновятся: на экран будет выведен узел в дереве, соответствующий этому элементу, и его свойства. Начиная с Visual Studio 2019 версии 16,4, можно [настроить поведение выбора элементов](../debugger/general-debugging-options-dialog-box.md).

   **Отображение графических элементов макета в работающем приложении**. Этот режим можно включить при нажатии кнопки, расположенной справа от кнопки включения выделения. Если установлен флажок **Отображение графических элементов макета**, в окне приложения отображаются горизонтальные и вертикальные линии вдоль границ выбранного объекта, чтобы можно было видеть, относительно чего он выровнен. Кроме того, отображаются прямоугольники, показывающие поля. Например, включите **элемент Выбор** и **Отображение макета** , а затем выберите в приложении текстовый блок **Добавить элемент** . В **динамическом визуальном дереве** должен появиться узел блока текста, а в **динамическом обозревателе свойств** — свойства блока текста, а также горизонтальные и вертикальные линии на его границах.

   ![LivePropertyViewer в DisplayLayout](../debugger/media/vs-2019/livevisualtreelivepropertyviewer-displaylayout.png "LiveVisualTreeLivePropertyViewer-DisplayLayout")

   **Предварительный просмотр выбора**. Этот режим можно включить, нажав третью кнопка слева на панели инструментов динамического визуального дерева. Этот режим показывает XAML-код, где был объявлен элемент, если имеется доступ к исходному коду приложения. Выберите **выбрать элемент** и **Просмотреть выбранные** элементы, а затем нажмите кнопку в нашем тестовом приложении. Файл MainWindow.xaml откроется в Visual Studio и курсор будет находится в строке, где определена кнопка.
   ::: moniker-end

   ::: moniker range="vs-2017"
   **Включение выделения в работающем приложении**. Вы можете включить этот режим, выбрав крайнюю левую кнопку на панели инструментов **динамического визуального дерева**. Когда этот режим включен, можно выбрать элемент пользовательского интерфейса в приложении, и данные **динамического визуального дерева** (а также **динамического обозревателя свойств**) автоматически обновятся: на экран будет выведен узел в дереве, соответствующий этому элементу, и его свойства.

   **Отображение графических элементов макета в работающем приложении**. Этот режим можно включить при нажатии кнопки, расположенной справа от кнопки включения выделения. Если установлен флажок **Отображение графических элементов макета**, в окне приложения отображаются горизонтальные и вертикальные линии вдоль границ выбранного объекта, чтобы можно было видеть, относительно чего он выровнен. Кроме того, отображаются прямоугольники, показывающие поля. Например, включите оба режима **Разрешить выделение** и **Отображать макет** и выберите текстовый блок **Формат вывода** в приложении. В **динамическом визуальном дереве** должен появиться узел блока текста, а в **динамическом обозревателе свойств** — свойства блока текста, а также горизонтальные и вертикальные линии на его границах.

   ![LivePropertyViewer в DisplayLayout](../debugger/media/livevisualtreelivepropertyviewer-displaylayout.png "LiveVisualTreeLivePropertyViewer-DisplayLayout")

   **Предварительный просмотр выбора**. Этот режим можно включить, нажав третью кнопка слева на панели инструментов динамического визуального дерева. Этот режим показывает XAML-код, где был объявлен элемент, если имеется доступ к исходному коду приложения. Выберите **Разрешить выделение** и **Предварительный просмотр выбора**, а затем нажмите кнопку в тестируемом приложении. Файл MainWindow.xaml откроется в Visual Studio и курсор будет находится в строке, где определена кнопка.
   ::: moniker-end

## <a name="use-xaml-tools-with-running-applications"></a>Использование средств XAML с выполняющимися приложениями

Эти средства XAML можно использовать даже при отсутствии исходного кода. При подключении к выполняющемуся приложению XAML вы также можете использовать **динамическое визуальное дерево** для элементов пользовательского интерфейса этого приложения. Ниже приведен пример, в котором используется то же тестовое приложение WPF, что и ранее.

1. Запустите приложение **TestXaml** в конфигурации выпуска. Подключиться к процессу, который выполняется в конфигурации **отладки**, нельзя.

2. Откройте второй экземпляр Visual Studio и щелкните **Отладка > Присоединение к процессу**. Найдите **TestXaml.exe** в списке доступных процессов и нажмите кнопку **Присоединить**.

3. Начнется выполнение приложения.

4. Во втором экземпляре Visual Studio откройте **динамическое визуальное дерево** (**Отладка > Окна > Динамическое визуальное дерево**). Вы должны увидеть элементы пользовательского интерфейса **TestXaml** и иметь возможность изменять их, как во время отладки приложения напрямую.

## <a name="see-also"></a>См. также раздел

[Запись и отладка выполняемого кода XAML с помощью горячей перезагрузки XAML](xaml-hot-reload.md)
