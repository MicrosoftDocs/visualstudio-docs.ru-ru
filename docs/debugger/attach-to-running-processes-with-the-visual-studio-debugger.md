---
title: Присоединение к выполняемым процессам с использованием отладчика
description: Узнайте, как подключить отладчик Visual Studio к запущенному процессу на локальном или удаленном компьютере.
ms.custom: SEO-VS-2020, seodec18
ms.date: 06/12/2020
ms.topic: conceptual
f1_keywords:
- vs.debug.processes.attach
- vs.debug.process
- vs.debug.programs
- vs.debug.detaching
- vs.debug.processes
- vs.debug.error.attach
- vs.debug.remotemachine
dev_langs:
- CSharp
- FSharp
- C++
- VB
helpviewer_keywords:
- remote debugging, attaching to programs
- processes, attaching to running processes
- Attach to Process dialog box
- debugging [Visual Studio], attaching to processes
- debugger, processes
ms.assetid: 27900e58-090c-4211-a309-b3e1496d5824
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 3a76aff1c17988f61b5f89e2e8d20ef7129efcae
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99866012"
---
# <a name="attach-to-running-processes-with-the-visual-studio-debugger"></a>Присоединение к выполняемым процессам с использованием отладчика Visual Studio

Отладчик Visual Studio можно подключить к запущенному процессу на локальном или удаленном компьютере. После выполнения процесса выберите **Отладка** > **Подключить к процессу** или нажмите клавиши **CTRL**+**ALT**+**P** в Visual Studio и используйте диалоговое окно **Подключение к процессу**, чтобы подключить отладчик к процессу.

Параметр **Подключить к процессу** можно использовать для отладки запущенных приложений на локальных или удаленных компьютерах, одновременной отладки нескольких процессов, отладки приложений, которые не были созданы в Visual Studio, или отладки любого приложения, которое не было запущено из Visual Studio с прикрепленным отладчиком. Например, если вы используете приложение без отладчика и столкнулись с исключением, можно присоединить отладчик к процессу, в котором выполняется приложение, и начать отладку.

> [!TIP]
> Не уверены, следует ли использовать параметр **Подключить к процессу** для сценария отладки? См. раздел [Общие сценарии отладки](#BKMK_Scenarios).

## <a name="attach-to-a-running-process-on-your-local-machine"></a><a name="BKMK_Attach_to_a_running_process"></a> Присоединение к выполняющемуся процессу на локальном компьютере

Сведения о том, как быстро присоединиться к процессу, подключенному ранее, см. в разделе [Повторное подключение к процессу](#BKMK_reattach).

**Порядок присоединения к процессу на локальном компьютере**

1. В Visual Studio выберите **Отладка** > **Подключить к процессу** (или нажмите клавиши **CTRL**+**ALT**+**P**), чтобы открыть диалоговое окно **Подключение к процессу**.

1. Проверьте значение параметра **Тип подключения**.

   В большинстве случаев можно использовать значение **По умолчанию**. Для некоторых сценариев может потребоваться другой тип подключения. Дополнительные сведения см. в других разделах этой статьи, а также в разделе [Общие сценарии отладки](#BKMK_Scenarios).

1. В поле **Цель подключения** укажите имя локального компьютера.

   ![Снимок экрана: диалоговое окно "Присоединение к процессу", в котором в качестве целевого объекта подключения задано имя локального компьютера.](../debugger/media/DBG_Basics_Attach_To_Process.png)

1. В списке **Доступные процессы** найдите и выберите процессы, к которым нужно присоединиться.

   - Чтобы быстро выбрать процесс, введите его имя или первую букву в поле **Фильтр процессов**.

   - Если вы не знаете имя процесса, просмотрите список или обратитесь к разделу [Общие сценарии отладки](#BKMK_Scenarios), чтобы ознакомиться с некоторыми распространенными именами процессов.

   >[!TIP]
   >Процессы могут запускаться и останавливаться в фоновом режиме, пока диалоговое окно **Подключение к процессу** открыто, поэтому список запущенных процессов может не всегда быть актуальным. Чтобы просмотреть актуальный список, можно в любое время нажать кнопку **Обновить**.

1. Убедитесь, что в окне **Присоединиться к** указан тип кода, который планируется отладить. Для большинства типов приложений можно выбрать значение по умолчанию **Автоматически**.

   При использовании типа подключения **По умолчанию** можно вручную выбрать тип кода, к которому нужно подключиться. В противном случае кнопка **Выбрать** может быть неактивна.

   Выбор кода вручную
   1. Нажмите кнопку **Выбрать**.
   1. В диалоговом окне **Выбор типа кода** нажмите кнопку **Выполнять отладку кода следующих типов**.
      Если при попытке подключиться к процессу из списка возникает ошибка, можно воспользоваться диалоговым окном [Выбор типа кода](../debugger/select-code-type-dialog-box.md), чтобы [устранить неполадку](#BKMK_Troubleshoot_attach_errors).
   1. Выберите типы кода, которые необходимо отладить.
   1. Нажмите кнопку **ОК**.

1. Выберите **Подключить**.

>[!NOTE]
>Во время отладки можно подключиться к нескольким приложениям, но в любой момент времени только один из них активен в отладчике. Можно выбрать текущую программу в панели инструментов **Место отладки** или окне **Процессы** в Visual Studio.

## <a name="attach-to-a-process-on-a-remote-computer"></a><a name="BKMK_Attach_to_a_process_on_a_remote_computer"></a> Присоединение к процессу на удаленном компьютере

В диалоговом окне **Подключение к процессу** также можно выбрать удаленный компьютер, просмотреть список доступных процессов, запущенных на этом компьютере, и подключиться к одному или нескольким процессам для отладки. На удаленном компьютере должен выполняться удаленный отладчик (*msvsmon.exe*). Дополнительные сведения см. в статье [Удаленная отладка](../debugger/remote-debugging.md).

Более полные инструкции по отладке приложений ASP.NET, развернутых в службах IIS, см. в разделе [Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md).

**Присоединение к выполняющемуся процессу на удаленном компьютере**

1. В Visual Studio выберите **Отладка** > **Подключить к процессу** (или нажмите клавиши **CTRL**+**ALT**+**P**), чтобы открыть диалоговое окно **Подключение к процессу**.

1. Проверьте значение параметра **Тип подключения**.

   В большинстве случаев можно использовать значение **По умолчанию**. В некоторых сценариях, таких как отладка Linux или контейнерного приложения, требуется другой тип подключения. Дополнительные сведения см. в других разделах этой статьи, а также в разделе [Общие сценарии отладки](#BKMK_Scenarios).

1. В поле **Целевой объект подключения** выберите удаленный компьютер одним из следующих способов.

   - Щелкните стрелку раскрывающегося списка **Целевой объект подключения** и выберите из раскрывающегося списка имя компьютера.
   - Введите имя компьютера в поле **Целевой объект подключения** и нажмите клавишу **ВВОД**.

     Убедитесь, что Visual Studio добавляет требуемый порт в имя компьютера, которое отображается в формате **\<remote computer name>:порт**.

     ::: moniker range=">= vs-2019"

     > [!NOTE]
     > Если вы не можете подключиться с помощью имени удаленного компьютера, попробуйте использовать IP-адрес и порт (например, `123.45.678.9:4022`). 4024 — это порт по умолчанию для удаленного отладчика Visual Studio 2019 x64. Сведения о других назначениях портов удаленного отладчика см. в разделе [Назначение портов удаленного отладчика](remote-debugger-port-assignments.md).

     ::: moniker-end
     ::: moniker range="vs-2017"

     > [!NOTE]
     > Если вы не можете подключиться с помощью имени удаленного компьютера, попробуйте использовать IP-адрес и порт (например, `123.45.678.9:4022`). 4022 — это порт по умолчанию для удаленного отладчика Visual Studio 2017 x64. Сведения о других назначениях портов удаленного отладчика см. в разделе [Назначение портов удаленного отладчика](remote-debugger-port-assignments.md).

     ::: moniker-end

   - Нажмите кнопку **Найти** рядом с полем **Целевой объект подключения**, чтобы открыть диалоговое окно **Удаленные подключения**. В диалоговом окне **Удаленные подключения** перечислены все устройства, которые имеются в локальной подсети или которые напрямую подключены к компьютеру. Для обнаружения удаленных устройств может потребоваться [открыть UDP-порт 3702](../debugger/remote-debugger-port-assignments.md) на сервере. Выберите нужный компьютер или устройство, после чего нажмите **Выбрать**.

   > [!NOTE]
   > Значение параметра **Тип подключения** сохраняется между сеансами отладки. Параметр **Целевой объект подключения** хранится между сеансами отладки только в случае успешного подключения отладки с этим целевым объектом.

3. Нажмите кнопку **Обновить**, чтобы заполнить список **Доступные процессы**.

    >[!TIP]
    >Процессы могут запускаться и останавливаться в фоновом режиме, пока диалоговое окно **Подключение к процессу** открыто, поэтому список запущенных процессов может не всегда быть актуальным. Чтобы просмотреть актуальный список, можно в любое время нажать кнопку **Обновить**.

4. В списке **Доступные процессы** найдите и выберите процессы, к которым нужно присоединиться.

   - Чтобы быстро выбрать процесс, введите его имя или первую букву в поле **Фильтр процессов**.

   - Если вы не знаете имя процесса, просмотрите список или обратитесь к разделу [Общие сценарии отладки](#BKMK_Scenarios), чтобы ознакомиться с некоторыми распространенными именами процессов.

   - Чтобы найти процесс, который выполняется с другой учетной записью пользователя, установите флажок **Показать процессы всех пользователей**.

     >[!NOTE]
     >Если попытаться подключиться к процессу, работающему под управлением ненадежной учетной записи, появится диалоговое окно подтверждения с предупреждением безопасности. Дополнительные сведения см. в статье [Предупреждение системы безопасности. Подключение к процессу, который принадлежит пользователю, не являющемуся доверенным, может быть опасным. Если следующие сведения не вызывают доверия, то не следует присоединяться к процессу](../debugger/security-warning-attaching-to-a-process-owned-by-an-untrusted-user.md).

5. Убедитесь, что в окне **Присоединиться к** указан тип кода, который планируется отладить. Для большинства типов приложений можно выбрать значение по умолчанию **Автоматически**.

   При использовании типа подключения **По умолчанию** можно вручную выбрать тип кода, к которому нужно подключиться. В противном случае кнопка **Выбрать** может быть неактивна.

   Выбор кода вручную
   1. Нажмите кнопку **Выбрать**.
   1. В диалоговом окне **Выбор типа кода** нажмите кнопку **Выполнять отладку кода следующих типов**.
      Если при попытке подключиться к процессу из списка возникает ошибка, можно воспользоваться диалоговым окном [Выбор типа кода](../debugger/select-code-type-dialog-box.md), чтобы [устранить неполадку](#BKMK_Troubleshoot_attach_errors).
   1. Нажмите кнопку **ОК**.

6. Выберите **Подключить**.

>[!NOTE]
>Во время отладки можно подключиться к нескольким приложениям, но в любой момент времени только один из них активен в отладчике. Можно выбрать текущую программу в панели инструментов **Место отладки** или окне **Процессы** в Visual Studio.

В некоторых случаях при отладке в сеансе удаленного рабочего стола (службы терминалов) в списке **Доступные процессы** не отображаются все доступные процессы. При работе с Visual Studio в качестве пользователя с ограниченным доступом в списке **Доступные процессы** не будут отображаться процессы, запущенные в сеансе 0, который используется для служб и других серверных процессов, включая *w3wp.exe*. Можно устранить эту проблему, запустив [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] под учетной записью администратора или запустив [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] с консоли сервера вместо сеанса служб терминалов.

Если ни один из этих обходных путей использовать невозможно, третий вариант — присоединение к процессу путем запуска `vsjitdebugger.exe -p <ProcessId>` из командной строки Windows. Можно определить идентификатор процесса с помощью *tlist.exe*. Чтобы получить файл *tlist.exe*, скачайте и установите средства отладки для Windows, которые доступны на странице [скачиваемых файлов WDK и WinDbg](/windows-hardware/drivers/download-the-wdk).

## <a name="attach-to-a-net-core-process-running-on-linux-using-ssh"></a>Подключение к процессу .NET Core под управлением Linux с помощью SSH

Дополнительные сведения см. в статье [Удаленная отладка .NET Core в Linux с помощью SSH](../debugger/remote-debugging-dotnet-core-linux-with-ssh.md).

::: moniker range=">= vs-2019"

## <a name="attach-to-a-process-running-on-a-docker-container"></a><a name="BKMK_Linux_Docker_Attach"></a> Присоединение к процессу, выполняющемуся в контейнере Docker

Начиная с Visual Studio 2019 можно подключить отладчик Visual Studio к процессу, выполняющемуся в контейнере Docker. Для контейнеров Docker в .NET Core для Linux см. раздел [Присоединение к процессу, выполняющемуся в контейнере Docker для Linux](../debugger/attach-to-process-running-in-docker-container.md#attach-to-a-process-running-on-a-linux-docker-container). Для контейнеров Docker в Windows см. раздел [Присоединение к процессу, выполняющемуся в контейнере Docker для Windows](../debugger/attach-to-process-running-in-docker-container.md#attach-to-a-process-running-on-a-windows-docker-container).

::: moniker-end

## <a name="reattach-to-a-process"></a><a name="BKMK_reattach"></a> Повторное подключение к процессу

Чтобы быстро присоединиться к процессам, к которым вы ранее были присоединены, выберите **Отладка** > **Повторно подключиться к процессу** (**SHIFT**+**ALT**+**P**). При выборе этой команды отладчик сразу же попытается присоединиться к последним процессам, к которым вы подключались, сначала попытавшись выполнить сопоставление с ИД предыдущего процесса, а если это не удается, то путем сопоставления с именем предыдущего процесса. Если совпадений не найдено или несколько процессов имеют одно и то же имя, откроется диалоговое окно **Подключение к процессу**, в котором можно выбрать правильный процесс.

> [!NOTE]
> Команда **Повторно подключиться к процессу** доступна начиная с Visual Studio 2017.

## <a name="common-debugging-scenarios"></a><a name="BKMK_Scenarios"></a> Общие сценарии отладки

Чтобы определить, следует ли использовать команду **Подключиться к процессу** и к какому процессу подключиться, используйте таблицу ниже, в которой приведены несколько распространенных сценариев отладки со ссылками на дополнительные инструкции, где это возможно. (Этот список не является исчерпывающим.)

Для некоторых типов приложений, например универсальных приложений для Windows (UWP), не следует напрямую подключаться к имени процесса. Вместо этого необходимо использовать команду **Отладка установленного пакета приложения** в Visual Studio (см. таблицу).

Чтобы отладчик мог присоединиться к коду на языке C++, код должен предоставлять `DebuggableAttribute`. Это можно добавить в код автоматически, путем связывания с параметром [/ASSEMBLYDEBUG](/cpp/build/reference/assemblydebug-add-debuggableattribute) компоновщика.

Для отладки скриптов на стороне клиента в браузере должна быть включена отладка скриптов. Для отладки клиентского скрипта в Chrome выберите **JavaScript (Chrome)** или **JavaScript (Microsoft Edge - Chromium)** в качестве типа кода, и, в зависимости от типа приложения, может потребоваться закрыть все экземпляры Chrome и запустить браузер в режиме отладки (введите `chrome.exe --remote-debugging-port=9222` в командной строке). В более ранних версиях Visual Studio в качестве отладчика скриптов для Chrome использовался **Веб-пакет**.

Чтобы быстро выбрать выполняющийся процесс для подключения, в Visual Studio нажмите клавиши **CTRL**+**ALT**+**P**, а затем введите первую букву имени процесса.

|Сценарий|Метод отладки|Имя процесса|Примечания и ссылки|
|-|-|-|-|
|Удаленная отладка ASP.NET 4 или 4.5 на сервере со службами IIS|Используйте инструменты удаленной отладки и функцию **Подключиться к процессу**|*w3wp.exe*|См. раздел [Удаленная отладка ASP.NET на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md)|
|Удаленная отладка ASP.NET Core на сервере со службами IIS|Используйте инструменты удаленной отладки и функцию **Подключиться к процессу**|*w3wp.exe* или *dotnet.exe*|Начиная с .NET Core 3 процесс *w3wp.exe* используется для [модели размещения в приложении](/aspnet/core/host-and-deploy/aspnet-core-module?view=aspnetcore-3.1&preserve-view=true#hosting-models) по умолчанию. Сведения о развертывании приложений см. в разделе [Публикация в службах IIS](/aspnet/core/host-and-deploy/iis/). Дополнительные сведения см. в разделе [Удаленная отладка ASP.NET Core на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-computer.md#BKMK_attach)|
|Отладка клиентского скрипта на локальном сервере IIS для поддерживаемых типов приложений |Используйте функцию **Подключиться к процессу**|*chrome.exe*, *MicrosoftEdgeCP.exe* или *iexplore.exe*|Необходимо включить отладку скриптов. Для Chrome необходимо также запустить Chrome в режиме отладки (введите `chrome.exe --remote-debugging-port=9222` в командной строке) и выбрать **JavaScript (Chrome)** в поле **Присоединиться к**.|
|Отладка приложения C#, Visual Basic или C++ на локальном компьютере|Используйте стандартную отладку (**F5**) или функцию **Подключиться к процессу**|*\<appname>.exe*|В большинстве случаев используется стандартная отладка, а не функция **Подключиться к процессу**.|
|Удаленная отладка классического приложения Windows|Инструменты удаленной отладки|Н/Д| См. раздел [Удаленная отладка приложения C# или Visual Basic](../debugger/remote-debugging-csharp.md) или [Удаленная отладка приложения C++](../debugger/remote-debugging-cpp.md)|
|Отладка .NET Core в Linux|Используйте функцию **Подключиться к процессу**|*dotnet.exe* или уникальное имя процесса|Сведения об использовании см. в статье [Удаленная отладка .NET Core в Linux с помощью SSH](../debugger/remote-debugging-dotnet-core-linux-with-ssh.md). Для контейнерных приложений см. раздел [Присоединение к процессу, выполняющемуся в контейнере Docker](../debugger/attach-to-process-running-in-docker-container.md#attach-to-a-process-running-on-a-linux-docker-container).|
|Отладка контейнерного приложения|Используйте функцию **Подключиться к процессу**|*dotnet.exe* или уникальное имя процесса|См. раздел [Присоединение к процессу, выполняющемуся в контейнере Docker](../debugger/attach-to-process-running-in-docker-container.md).|
|Удаленная отладка Python в Linux|Используйте функцию **Подключиться к процессу**|*debugpy*|См. раздел [Удаленное подключение с помощью инструментов Python](../python/debugging-python-code-on-remote-linux-machines.md#attach-remotely-from-python-tools).|
|Отладка приложения ASP.NET на локальном компьютере после запуска приложения без отладчика|Используйте функцию **Подключиться к процессу**|*iiexpress.exe*|Это может быть полезно для ускорения загрузки приложения, например при профилировании. |
|Отладка других поддерживаемых типов приложений в серверном процессе|Если сервер удаленный, используйте инструменты удаленной отладки и функцию **Подключиться к процессу**|*Chrome.exe*, *iexplore.exe* или другие процессы|При необходимости используйте монитор ресурсов, чтобы определить процесс. См. раздел [Удаленная отладка](../debugger/remote-debugging.md).|
|Удаленная отладка универсального приложения для Windows (UWP), OneCore, HoloLens или приложения IoT|Отладка установленного пакета приложения|Н/Д|См. раздел [Отладка установленного пакета приложения](debug-installed-app-package.md) вместо использования функции **Подключиться к процессу**|
|Отладка универсального приложения для Windows (UWP), OneCore, HoloLens или приложения IoT, которое не было запущено из Visual Studio|Отладка установленного пакета приложения|Н/Д|См. раздел [Отладка установленного пакета приложения](debug-installed-app-package.md) вместо использования функции **Подключиться к процессу**|

## <a name="use-debugger-features"></a>Использование функций отладчика

Чтобы использовать все функции отладчика Visual Studio (например, при обнаружении точек останова) при присоединении к процессу, приложение должно точно соответствовать локальным источнику и символам. То есть отладчик должен иметь возможность загрузки правильных [файлов символов (PDB)](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md). По умолчанию для этого требуется отладочная сборка.

В сценариях удаленной отладки должен быть уже открыт исходный код (или копия исходного кода) в Visual Studio. Скомпилированные двоичные файлы приложения на удаленном компьютере должны поступать из той же сборки, что и на локальном компьютере.

В некоторых локальных сценариях отладки в Visual Studio можно выполнять отладку без доступа к источнику, если в приложении есть правильные файлы символов. По умолчанию для этого требуется отладочная сборка. Дополнительные сведения см. в разделе [Указание файлов символов и исходных файлов](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md).

## <a name="troubleshoot-attach-errors"></a><a name="BKMK_Troubleshoot_attach_errors"></a> Устранение ошибок присоединения

В некоторых сценариях отладчику может потребоваться помощь, чтобы правильно определить тип отлаживаемого кода. Если значения для подключения заданы правильно (проверить процесс можно в списке **Доступные процессы**), но отладчику не удается подключиться, попробуйте выбрать наиболее подходящий тип подключения в списке **Тип подключения**. Это может потребоваться, например, при отладке приложения Linux или Python. Если используется тип подключения "По умолчанию", можно также выбрать определенный тип кода для подключения, как описано далее в этом разделе.

При присоединении отладчика к выполняющемуся процессу этот процесс может содержать один или несколько типов кода. Типы кода, к которым может присоединиться отладчик, отображаются и выбираются в диалоговом окне [Выбор типа кода](../debugger/select-code-type-dialog-box.md) .

Иногда отладчик может успешно присоединяться к одному типу кода, но не к другому. Это происходит в следующих случаях:

- При попытке присоединения к процессу, выполняющемуся на удаленном компьютере. На удаленном компьютере для одних типов кода могут иметься компоненты удаленной отладки, а для других — нет.
- При попытке присоединиться к двум или более процессам для прямой отладки базы данных. Отладка SQL поддерживает присоединение только к одному процессу.

Если отладчик может присоединиться не ко всем типам кода, отобразится сообщение со сведениями о типах, к которым присоединиться не удалось.

Если отладчик успешно подключается хотя бы к одному типу кода, то можно приступать к отладке процесса. Но отлаживать можно будет только те типы кода, к которым удалось подсоединиться. Неподключенный код в этом процессе будет по-прежнему выполняться, но задавать в этом коде точки останова, просматривать данные и выполнять другие операции отладки не удастся.

Если нужны более конкретные сведения о том, почему отладчику не удалось присоединиться к некоторому типу кода, попробуйте повторно присоединиться только к этому типу кода.

**Чтобы получить подробные сведения о том, почему не удалось присоединиться к типу кода:**

1. Отключитесь от процесса. В меню **Отладка** выберите **Отсоединить все**.

1. Вновь подключитесь к процессу, выбрав только тип кода.

    1. В диалоговом окне **Присоединение к процессу** выберите процесс в списке **Доступные процессы**.

    2. Щелкните **Выбрать**.

    3. В диалоговом окне **Выбор типа кода** выберите **Выполнять отладку кода следующих типов** и выберите тип кода, к которому не удалось присоединиться. Отмените выбор других типов кода.

    4. Нажмите кнопку **ОК**.

    5. В диалоговом окне **Подключение к процессу** нажмите **Подключиться**.

    На этот раз присоединение не пройдет полностью, и будет выдано сообщение о конкретной ошибке.

## <a name="see-also"></a>См. также

- [Отладка нескольких процессов](../debugger/debug-multiple-processes.md)
- [JIT-отладка](../debugger/just-in-time-debugging-in-visual-studio.md)
- [Удаленная отладка](../debugger/remote-debugging.md)
