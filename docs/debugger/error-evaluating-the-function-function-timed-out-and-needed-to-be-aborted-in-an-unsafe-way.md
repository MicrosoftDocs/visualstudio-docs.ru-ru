---
title: Истекло время ожидания при вычислении функции &apos;функция&apos;, поэтому его требуется завершить небезопасным образом | Документация Майкрософт
description: 'Полный текст сообщения: Истекло время ожидания при вычислении функции "функция", поэтому его требуется завершить небезопасным образом.'
ms.date: 06/18/2021
ms.topic: error-reference
ms.custom: contperf-fy21q4
f1_keywords:
- vs.debug.error.unsafe_func_eval_abort
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 94c308e9ec960f744a98f0f930999df36afff475
ms.sourcegitcommit: d3658667e768d7516cbf4461ec47bf24c8fcb7e6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2021
ms.locfileid: "112925011"
---
# <a name="error-evaluating-the-function-39function39-timed-out-and-needed-to-be-aborted-in-an-unsafe-way"></a>Ошибка: Истекло время ожидания при вычислении функции &#39;функция&#39;, поэтому его требуется завершить небезопасным образом

Полный текст сообщения: Истекло время ожидания при вычислении функции "функция", поэтому его требуется завершить небезопасным образом. Это могло привести к повреждению целевого процесса.

Чтобы упростить проверку состояния для объектов .NET, отладчик автоматически выполняет дополнительный код в отлаживаемом процессе (обычно это методы получения свойств и функции ToString). В большинстве случаев эти функции выполняются быстро и значительно упрощают отладку. Однако отладчик не запускает приложение в песочнице. Поэтому если метод получения свойств или метод ToString вызывает собственную функцию платформы и эта функция перестает отвечать, время ожидания может длиться бесконечно. Если вы увидите указанное выше сообщение об ошибке, значит, возникла именно такая ситуация.

Одна из распространенных причин возникновения этой проблемы связана с тем, что когда отладчик вычисляет свойство, он разрешает выполнение только проверяемого потока. Поэтому если свойство ожидает выполнения других потоков в отлаживаемом приложении, причем среда выполнения .NET не может прервать это ожидание, возникает данная проблема.

## <a name="to-correct-this-error"></a>Исправление ошибки

В следующих разделах приведено несколько возможных решений для этой проблемы.

## <a name="solution-1-prevent-the-debugger-from-calling-the-getter-property-or-tostring-method"></a>Решение 1. Запрет вызова метода получения свойств или метода ToString в отладчике

В сообщении об ошибке будет указано имя функции, которую отладчик пытался вызвать. Если вы можете изменить эту функцию, запретите отладчику вызывать метод получения свойств или метод ToString. Выполните одно из указанных ниже действий.

* Укажите в методе любой другой тип кода, кроме метода получения свойств и метода ToString, и проблема исчезнет.
  -или-
* (Для ToString.) Определите для типа атрибут [DebuggerDisplay](../debugger/using-the-debuggerdisplay-attribute.md), чтобы отладчик мог вычислить другое значение, кроме ToString.
  -или-
* (Для метода получения свойства.) Установите для свойства атрибут [System.Diagnostics.DebuggerBrowsable(DebuggerBrowsableState.Never)](/dotnet/api/system.diagnostics.debuggerbrowsableattribute). Это может быть полезно, если какой-то из ваших методов должен оставаться свойством для обеспечения совместимости с API, хотя по сути является настоящим методом.

## <a name="solution-2-have-the-target-code-ask-the-debugger-to-abort-the-evaluation"></a>Решение 2. Запрос на прерывание вычисления отладчиком в целевом коде

В сообщении об ошибке будет указано имя функции, которую отладчик пытался вызвать. Если метод получения свойств или метод ToString иногда не выполняется правильно, особенно когда проблема в том, что коду требуется другой поток для выполнения кода, тогда функция реализации может вызвать [System.Diagnostics.Debugger.NotifyOfCrossThreadDependency](/dotnet/api/system.diagnostics.debugger.notifyofcrossthreaddependency), чтобы запросить прерывание вычисления функции отладчиком. При использовании этого решения можно по-прежнему явно вычислять функции, но по умолчанию при вызове NotifyOfCrossThreadDependency выполнение останавливается.

## <a name="solution-3-disable-all-implicit-evaluation"></a>Решение 3. Отключение всех неявных вычислений

Если ни одно из предыдущих решений не устраняет проблему, перейдите в раздел **Средства** > **Параметры** и снимите флажок **Отладка** > **Общие** > **Включить вычисление свойства и другие неявные вызовы функций**. Это отключит большинство неявных вычислений функций, что должно устранить проблему.

## <a name="solution-4-check-compatibility-with-third-party-developer-tools"></a>Решение 4. Проверка совместимости со сторонними средствами для разработчиков

Если вы используете Resharper, ознакомьтесь с рекомендациями в [описании этой проблемы статье](https://youtrack.jetbrains.com/issue/RSRP-476824).

## <a name="solution-5-enable-managed-compatibility-mode"></a>Решение 5. Включение режима совместимости управляемого кода

Если переключиться на модуль отладки прежней версии, можно устранить эту ошибку. Выберите пункт **Сервис** > **Параметры**, а затем выберите параметр **Отладка** > **Общие** > **Использовать режим совместимости управляемого кода**. Дополнительные сведения см. в статье [Общие параметры отладки](../debugger/general-debugging-options-dialog-box.md).
