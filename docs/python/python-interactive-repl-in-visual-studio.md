---
title: Интерактивное окно Python (REPL)
description: Быстрая разработка кода Python в Visual Studio с помощью интерактивного окна (REPL).
ms.date: 02/11/2019
ms.topic: how-to
author: JoshuaPartlow
ms.author: joshuapa
manager: jmartens
ms.custom: seodec18
ms.workload:
- python
- data-science
ms.openlocfilehash: 21115673a41e26b2f1685442d2ed0ad93a147990
ms.sourcegitcommit: 4908561809ad397c99cf204f52d5e779512e502c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "112254892"
---
# <a name="work-with-the-python-interactive-window"></a>Работа с интерактивным окном Python

Visual Studio предоставляет интерактивное окно для цикла REPL (read–eval–print loop) отдельно для каждого окружения Python, что дает ряд преимуществ над интерфейсом REPL из командной строки *python.exe*. В **интерактивном** окне (открывается с помощью команд меню **Просмотр** > **Другие окна** >  **&lt;окружение&gt; Интерактивное окно**) можно ввести произвольный код Python и немедленно увидеть результаты. Это помогает вам изучать API и экспериментировать с ним, а также интерактивно разрабатывать рабочий код для добавления в проекты.

![Интерактивное окно Python](media/interactive-window.png)

Visual Studio предоставляет ряд режимов REPL Python.

| REPL | Описание | Редактирование | Отладка | Образы |
| --- | --- | --- | --- | --- |
| Стандартный | Режим REPL по умолчанию, взаимодействует с Python напрямую | Стандартное редактирование (многострочное редактирование и т. д.) | Да, через `$attach` | Нет |
| Отладка | Режим REPL по умолчанию, взаимодействует с отлаженным процессом Python | Стандартное редактирование | Только отладка | Нет |
| IPython | REPL взаимодействует с серверной частью IPython | Команды IPython, средства Pylab | Нет | Да, встроенные в REPL |
| IPython без Pylab | REPL взаимодействует с серверной частью IPython | Стандартный IPython | Нет | Да, в отдельном окне |

В этой статье описаны **стандартный** режим REPL и режим **отладки** REPL. Дополнительные сведения о режимах IPython см. в руководстве по [использованию IPython в интерактивном окне](interactive-repl-ipython.md).

Подробное пошаговое руководство с примерами, включая взаимодействие с редактором, например с помощью клавиш **CTRL**+**ВВОД**, см. в [шаге 3 в руководстве: использование интерактивного окна REPL](tutorial-working-with-python-in-visual-studio-step-03-interactive-repl.md).

## <a name="open-an-interactive-window"></a>Открытие интерактивного окна

Существует несколько способов открыть для окружения **интерактивное** окно.

Первый способ — переключитесь в окно окружений Python (**Просмотр** > **Другие окна** > **Окружения Python** или **CTRL**+**K** > **CTRL**+ **`** ) и выберите команду **Открыть интерактивное окно** или нажмите кнопку выбранного окружения.

![Ссылка на интерактивное окно в окне Python Environments (Среды Python)](media/interactive-window-opening.png)

Второй способ — в нижней части меню **Просмотр** > **Другие окна** находится команда **Интерактивное окно Python** для вашего окружения по умолчанию, а также команда для перехода в окно **Окружения**:

![Пункты меню интерактивного окна после выбора "Просмотр" > "Другие окна"](media/interactive-window-menu.png)

Третий способ — **интерактивное** окно можно открыть в файле запуска проекта или с помощью отдельного файла, выбрав команду меню **Отладка** > **Выполнить \<Project | File> в интерактивном** окне Python (**SHIFT**+**ALT**+**F5**):

![Пункт меню Execute Project in Python Interactive (Выполнить проект в интерактивном окне Python)](media/interactive-execute-project.png)

Наконец, можно выбрать код в файле и использовать описанную ниже [команду **Отправить код в интерактивное окно**](#send-to-interactive-command).

## <a name="interactive-window-options"></a>Параметры интерактивного окна

Вы можете управлять разными аспектами **интерактивного** окна с помощью меню **Инструменты** > **Параметры** > **Python** > **Интерактивные окна** (см. [Параметры](python-support-options-and-settings-in-visual-studio.md)):

![Параметры интерактивного окна Python](media/options-interactive-windows.png)

## <a name="use-the-interactive-window"></a>Работа с интерактивным окном Python

Открыв **интерактивное** окно, вы можете вводить в него отдельные строки кода в ответ на приглашение **\>\>\>** . **Интерактивное** окно выполняет код в каждой строке по мере ввода, включая импорт модулей, определение переменных и т. д.

![Интерактивное окно Python](media/interactive-window.png)

Исключением является ситуация, когда для получения законченного оператора требуются дополнительные строки кода, например, когда оператор `for` заканчивается точкой с запятой, как показано выше. В таких случаях в начале строки отображаются символы **...** , указывая, что вам нужно ввести дополнительные строки для блока, как показано в четвертой и пятой строке на приведенном выше рисунке. Когда вы завершите ввод клавишей **ВВОД** в пустой строке, **интерактивное** окно закроется и блок выполнится в интерпретаторе.

> [!Tip]
> **Интерактивное** окно повышает удобство работы с обычными условиями цикла REPL в командной строке Python, автоматически выделяя отступами операторы, принадлежащие к окружающей области видимости. В журнале (можно отозвать с помощью стрелки вверх) также представлены многострочные элементы, в то время как в среде REPL с командной строкой содержатся только единичные строки.

<a name="meta-commands"></a>**Интерактивное** окно также поддерживает несколько метакоманд. Все метакоманды начинаются с `$`. Чтобы получить список метакоманд, введите `$help`, а для получения сведений об использовании конкретной команды введите `$help <command>`.

:::moniker range="<=vs-2017"

| Метакоманда | Описание |
| --- | --- |
| `$$` | Вставляет комментарий, благодаря чему можно комментировать код на протяжении всего сеанса. |
| `$attach` | Присоединяет отладчик Visual Studio к процессу окна REPL для включения отладки. |
| `$cls`, `$clear` | Удаляет содержимое окна редактора, не затрагивая журнал и контекст выполнения. |
| `$help` | Выводит список команд или справку по определенной команде. |
| `$load` | Загружает команды из файла и выполняет их до завершения. |
| `$mod` | Переключает текущую область на модуль с указанным именем. |
| `$reset` | Сбрасывает среду выполнения до начального состояния, но сохраняет историю. |
| `$wait` | Ожидает на протяжении как минимум указанного числа миллисекунд. |

:::moniker-end

:::moniker range=">=vs-2019"

| Метакоманда | Описание |
| --- | --- |
| `$$` | Вставляет комментарий, благодаря чему можно комментировать код на протяжении всего сеанса. |
| `$cls`, `$clear` | Удаляет содержимое окна редактора, не затрагивая журнал и контекст выполнения. |
| `$help` | Выводит список команд или справку по определенной команде. |
| `$load` | Загружает команды из файла и выполняет их до завершения. |
| `$mod` | Переключает текущую область на модуль с указанным именем. |
| `$reset` | Сбрасывает среду выполнения до начального состояния, но сохраняет историю. |
| `$wait` | Ожидает на протяжении как минимум указанного числа миллисекунд. |

:::moniker-end

Команды также допускают расширение с помощью расширений Visual Studio путем реализации и экспорта `IInteractiveWindowCommand` ([пример](https://github.com/Microsoft/PTVS/blob/master/Python/Product/PythonTools/PythonTools/Repl/InteractiveWindowCommands.cs#L85)).

## <a name="switch-scopes"></a>Переключение областей видимости

По умолчанию область действия **интерактивного** окна проекта ограничена файлом запуска проекта, как и при запуске из командной строки. Для автономного файла действия выполняются в области этого файла. Но в любой момент сеанса REPL вы можете изменить область с помощью раскрывающегося меню в верхней части **интерактивного** окна:

![Области интерактивного окна](media/interactive-scopes.png)

После импорта модуля, например с помощью команды `import importlib`, в раскрывающемся списке отображаются параметры, позволяющие переключиться в любую область этого модуля. В **интерактивном** окне появляется сообщение, определяющее новую область, помогая вам отслеживать изменение состояний во время сеанса.

После ввода `dir()` в области отобразятся допустимые идентификаторы этой области, включая имена функций, классы и переменные. Например, если ввести `import importlib`, за которым следует `dir()`, отобразится следующее:

![Интерактивное окно в области importlib](media/interactive-importlib-scope.png)

## <a name="send-to-interactive-command"></a>Команда "Отправить код в интерактивное окно"

Кроме выполнения действий непосредственно в **интерактивном** окне, вы можете выбрать любой код в редакторе, щелкнуть его правой кнопкой мыши и выбрать **Отправить в интерактивное окно** или нажать клавиши **CTRL**+**ВВОД**.

![Команда меню "Отправить в Interactive"](media/interactive-send-to.png)

Эта команда также удобна для итеративной или эволюционной разработки кода, включая тестирование кода по мере разработки. Например, после того как вы отправили фрагмент кода в **интерактивное** окно и увидели результат его выполнения, можно снова отобразить этот код нажатием стрелки "вверх", внести изменения и быстро проверить результат, нажав клавиши **CTRL**+**ВВОД**. (Нажатие клавиши **ВВОД** в конце входной строки также выполняет введенный код, но при нажатии этой клавиши в середине строки происходит вставка новой строки.) Внеся все необходимые изменения в код, можно легко скопировать его обратно в файл проекта.

> [!Tip]
> По умолчанию Visual Studio удаляет символы **>>>** и **...** . REPL выводит предупреждение при вставке кода из **интерактивного** окна в редактор. Это поведение можно изменить на вкладке **Инструменты** > **Параметры** > **Текстовый редактор** > **Python** > **Дополнительно** с помощью параметра **Вставка удаляет запросы REPL**. См. раздел [Параметры. Прочие параметры](python-support-options-and-settings-in-visual-studio.md#miscellaneous-options).

<!-- After 15.3 is released, you can also press **Undo** after pasting to restore prompts. Press **Undo** a second time to remove the pasted code entirely. -->

## <a name="work-with-code-cells"></a>Работа с ячейками кода

Ячейки кода, которые поддерживаются различными текстовыми редакторами, можно использовать в ходе анализа данных.

Например, при использовании файла кода в качестве электронного блокнота часто требуется отправить целиком небольшой блок кода. Чтобы сгруппировать код, пометьте его как *ячейку кода*, добавив в начало ячейки заметку, начинающуюся с `#%%`, чтобы завершить предыдущую. Ячейки кода можно свернуть и развернуть, а с помощью клавиш **CTRL**+**ВВОД** внутри ячейки кода ее можно целиком отправить в **интерактивное** окно и перейти к следующей ячейке.

Visual Studio также обнаруживает ячейки кода, начинающиеся с таких заметок, как `# In[1]:`, что соответствует формату, получаемому при экспорте записной книжки Jupyter в файл Python. Такое обнаружение позволяет легко запустить записную книжку из компонента [Записные книжки Azure](https://notebooks.azure.com/), скачав ее в виде файла Python, открыв в Visual Studio и выполнив поочередно каждую ячейку с помощью клавиш **CTRL**+**ВВОД**.

![Интерактивные ячейки кода](media/interactive-code-cells.png)

## <a name="intellisense-behavior"></a>Поведение IntelliSense

В **интерактивном** окне применяется технология IntelliSense на основе используемых объектов, в отличие от редактора кода, в котором IntelliSense основывается только на анализе исходного кода. Эти предложения в **интерактивном** окне более точные, особенно при работе с динамически создаваемым кодом. Недостаток заключается в том, что функции с побочными эффектами (например, запись сообщений) могут повлиять на процесс разработки.

Если это является проблемой, измените параметры, выбрав **Инструменты** > **Параметры** > **Python** > **Интерактивные окна** в группе **Режим завершения**, как указано в описании [параметров интерактивных окон](python-support-options-and-settings-in-visual-studio.md#interactive-windows-options).
