---
title: 'Руководство по Django в Visual Studio, шаг 1: основы Django'
titleSuffix: ''
description: Пошаговое руководство по основам Django в контексте проектов Visual Studio, демонстрирующих поддержку Visual Studio для разработки Django.
ms.date: 11/19/2018
ms.topic: tutorial
author: JoshuaPartlow
ms.author: joshuapa
manager: jmartens
ms.custom: seodec18
ms.workload:
- python
- data-science
ms.openlocfilehash: afde24347237ed3fc87d7a00ebdf21787d78909c
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99942665"
---
# <a name="tutorial-get-started-with-the-django-web-framework-in-visual-studio"></a>Руководство. Начало работы с веб-платформой Django в Visual Studio

[Django](https://www.djangoproject.com/) — это высокоуровневая платформа Python для быстрого создания безопасных и масштабируемых веб-систем. В этом руководстве представлены сведения о платформе Django в контексте шаблонов проекта, предоставляемых Visual Studio для упрощения создания веб-приложений на основе Django.

В этом руководстве описано следующее.

> [!div class="checklist"]
> - создавать базовый проект Django в репозитории Git с помощью шаблона "Пустой веб-проект Django" (этап 1);
> - создавать приложение Django с одной страницей и преобразовать эту страницу для просмотра с помощью шаблона (шаг 2);
> - обслуживать статические файлы, добавлять страницы и использовать наследование шаблонов (шаг 3);
> - использовать шаблон веб-проекта Django для создания приложения с несколькими страницами и адаптивным дизайном (этап 4);
> - выполнять проверку подлинности пользователей (шаг 5);
> - с помощью шаблона веб-проекта опроса Django создать приложение, использующее модели, миграции базы данных и настройки в интерфейсе администратора (шаг 6).

## <a name="prerequisites"></a>предварительные требования

- Visual Studio 2017 или более поздней версии в системе Windows со следующими параметрами:
  - Рабочая нагрузка **Разработка на Python** (вкладка **Рабочая нагрузка** в установщике). Инструкции см. в статье [Установка поддержки Python в Visual Studio](installing-python-support-in-visual-studio.md).
  - **Git для Windows** и **расширение GitHub для Visual Studio** на вкладке **Отдельные компоненты** в разделе **Средства кода**.

Шаблоны проектов Django также входят в состав всех ранних версий инструментов Python для Visual Studio, хотя сведения могут отличаться от рассматриваемых в этом руководстве (особенно это касается более ранних версий платформы Django).

Разработка Python в настоящее время не поддерживается в Visual Studio для Mac. В системах Mac и Linux используйте [расширение Python в Visual Studio Code](https://code.visualstudio.com/docs/python/python-tutorial).

### <a name="visual-studio-projects-and-django-projects"></a>Проекты Visual Studio и проекты Django

В терминологии Django "проект Django" состоит из нескольких файлов конфигурации на уровне сайта вместе с одним или несколькими "приложениями", развертываемыми на веб-узел для создания полного веб-приложения. Проект Django может содержать несколько приложений. Точно так же приложение может находиться в нескольких проектах Django.

Проект Visual Studio может содержать проект Django вместе с несколькими приложениями. В целях упрощения в этом руководстве для проекта Visual Studio используется понятие "проект". Когда же говорится о проекте Django, используется конкретное словосочетание "проект Django".

Во время работы с этим руководством вы создадите одно решение Visual Studio с тремя отдельными проектами Django, каждый из которых содержит одно приложение Django. Сохраняя проекты в одном и том же решении, вы можете легко переключаться между различными файлами для сравнения.

## <a name="step-1-1-create-a-visual-studio-project-and-solution"></a>Шаг 1–1. Создание проекта и решения Visual Studio

Обычно при работе с Django из командной строки нужно сначала создать проект, выполнив команду `django-admin startproject <project_name>`. В Visual Studio использование шаблона "Пустой веб-проект Django" обеспечивает ту же структуру, что и в проекте и решении Visual Studio.

1. В Visual Studio выберите **Файл** > **Создать** > **Проект**, выполните поиск по запросу "Django" и выберите шаблон **Пустой веб-проект Django**. (Шаблон также можно найти в папке **Python** > **Интернет** в списке слева.)

    ![Диалоговое окно нового проекта в Visual Studio для пустого веб-проекта Django](media/django/step01-new-blank-project.png)

1. В нижней части диалогового окна в полях введите следующие сведения (как показано на предыдущем рисунке), а затем нажмите кнопку **ОК**.

    - **Имя**. В качестве имени проекта Visual Studio укажите **BasicProject**. Это имя используется также и для проекта Django.
    - **Расположение**. Укажите расположение для создания решения и проекта Visual Studio.
    - **Решение**. Оставьте в этом поле значение по умолчанию **Создать новое решение**.
    - **Имя решения**. Укажите **LearningDjango**. В этом руководстве данное имя подходит для решения как контейнер для нескольких проектов.
    - **Создать каталог для решения**. Оставьте флажок установленным (по умолчанию).
    - **Создать новый репозиторий Git**. Выберите этот параметр (по умолчанию флажок не установлен), чтобы при создании решения в Visual Studio был создан локальный репозиторий Git. Если этот параметр не отображается, запустите Visual Studio Installer и добавьте **Git для Windows** и **Расширение GitHub для Visual Studio** на вкладке **Отдельные компоненты** в разделе **Средства для работы с кодом**.

1. Через некоторое время в Visual Studio отобразится диалоговое окно с сообщением **Для этого проекта требуются внешние пакеты** (как показано ниже). Это диалоговое окно открывается, так как шаблон включает файл *requirements.txt*, ссылающийся на последнюю версию пакета Django 1.x. (Выберите **Показать необходимые пакеты**, чтобы просмотреть точный список зависимостей.)

    ![Запрос внешних пакетов для проекта](media/django/step01-requirements-prompt-install-myself.png)

1. Выберите параметр **I will install them myself** (Я установлю их самостоятельно). В ближайшее время вы можете создать виртуальное окружение и исключить его из системы управления версиями. (Окружение всегда можно создать из *requirements.txt*.)

## <a name="step-1-2-examine-the-git-controls-and-publish-to-a-remote-repository"></a>Шаг 1–2. Проверка элементов управления Git и публикация в удаленном репозитории

Так как вы выбрали **Создать новый репозиторий Git** в диалоговом окне **Новый проект**, проект уже был зафиксирован в локальной системе управления версиями сразу после завершения процесса создания. На этом шаге вы ознакомитесь с элементами управления Git в Visual Studio и окном **Team Explorer**, в котором вы будете работать с системой управления версиями.

1. Проверьте элементы управления Git в нижнем углу главного окна Visual Studio. Эти элементы управления отображаются в следующем порядке (слева направо): неотправленные фиксации, незафиксированные изменения, имя репозитория и текущая ветвь.

    ![Элементы управления Git в окне Visual Studio](media/django/step01-git-controls.png)

    > [!Note]
    > Если вы не выбрали параметр **Создать новый репозиторий Git** в диалоговом окне **Новый проект**, элементы управления Git отображают только команду **Добавить в систему управления версиями**, которая создает локальный репозиторий.
    >
    > ![Добавление в систему управления версиями в Visual Studio (если не создан репозиторий)](media/django/step01-git-add-to-source-control.png)

1. Нажмите кнопку "Изменить" и в Visual Studio на странице **изменений** откроется окно **Team Explorer**. Так как созданный проект уже зафиксирован в системе управления версиями автоматически, ожидающие изменения не отобразятся.

    ![Окно Team Explorer на странице изменений](media/django/step01-team-explorer-changes.png)

1. В строке состояния Visual Studio нажмите кнопку фиксации (стрелка вверх со значением **2**), чтобы открыть страницу **Синхронизация** в **Team Explorer**. Так как у вас есть только локальный репозиторий, страница предоставляет простые варианты для публикации репозитория для разных удаленных репозиториев.

    ![Окно Team Explorer с доступными вариантами репозитория Git для системы управления версиями](media/django/step01-team-explorer.png)

    Для своих проектов вы можете выбрать любую службу. В этом руководстве используется GitHub. Завершенный пример кода для работы см. в репозитории [Microsoft/python-sample-vs-learning-django](https://github.com/Microsoft/python-sample-vs-learning-django).

1. При выборе любого из элементов управления **Публикация** **Team Explorer** предложит проверить зависимости для получения дополнительной информации. Например, при публикации примера для этого руководства сначала нужно было создать репозиторий, и в этом случае параметр **Отправить в удаленный репозиторий** использовался с URL-адресом репозитория.

    ![Окно Team Explorer для отправки в имеющийся удаленный репозиторий](media/django/step01-push-to-github.png)

    Если у вас нет репозитория, параметры **Опубликовать в GitHub** и **Отправить в Azure DevOps** позволяют создать его непосредственно из Visual Studio.

1. При работе с этим руководством вы будете периодически использовать элементы управления в Visual Studio для фиксации и отправки изменений. Мы напомним вам об этом при необходимости.

> [!Tip]
> Для быстрого перемещения в **Team Explorer** выберите заголовок (**Изменения** или **Отправить**), чтобы открыть контекстное меню доступных страниц.

### <a name="question-what-are-some-advantages-of-using-source-control-from-the-beginning-of-a-project"></a>Вопрос. Каковы преимущества использования системы управления версиями с самого начала проекта?

Ответ. Прежде всего использование системы управления версиями с самого начала, особенно если вы также используете удаленный репозиторий, обеспечивает регулярное резервное копирование вашего проекта. В отличие от поддержки проекта только в локальной файловой системе, система управления версиями также предоставляет полную историю изменений и возможность отменить изменения одного файла или всего проекта. История изменений помогает определить причину регрессий (сбои при тестировании). Кроме того, система управления версиями необходима в случае, если над проектом работают несколько человек. Она управляет перезаписыванием и обеспечивает разрешение конфликтов. Наконец, система управления версиями, которая является формой автоматизации, отлично подходит для автоматизации сборки, тестирования и управления выпусками. Это первый шаг в использовании DevOps для проекта, и так как барьеры для входа настолько низки, нет оснований не использовать систему управления версиями с самого начала.

Дополнительные сведения о системе управления версиями как средства автоматизации см. в статье [Mobile DevOps - The Source of Truth: The Role of Repositories in DevOps](/archive/msdn-magazine/2016/september/mobile-devops-the-source-of-truth-the-role-of-repositories-in-devops) (DevOps для мобильных устройств. Источник правды. Роль репозиториев в DevOps) в журнале MSDN. Эта статья написана для мобильных приложений, однако она применима также и к веб-приложениям.

### <a name="question-can-i-prevent-visual-studio-from-auto-committing-a-new-project"></a>Вопрос. Можно ли отменить автоматическую фиксацию нового проекта в Visual Studio?

Ответ. Да. Чтобы отключить автоматическую фиксацию, перейдите на страницу **Параметры** в **Team Explorer**, выберите **Git** > **Глобальные параметры**, снимите флажок **Commit changes after merge by default** (Фиксировать изменения после объединения по умолчанию), а затем нажмите кнопку **Обновить**.

## <a name="step-1-3-create-the-virtual-environment-and-exclude-it-from-source-control"></a>Шаг 1–3. Создание виртуального окружения и его исключение из системы управления версиями

Теперь, когда вы настроили систему управления версиями для своего проекта, можно создать виртуальное окружение, которое содержит необходимые пакеты Django для проекта. Затем с помощью **Team Explorer** вы сможете исключить папку окружения из системы управления версиями.

1. В **обозревателе решений** щелкните правой кнопкой мыши элемент **Окружения Python** и выберите **Добавление виртуального окружения**.

    ![Команда "Добавление виртуального окружения" в обозревателе решений](media/django/step01-add-virtual-environment-command.png)

1. Откроется диалоговое окно **Добавление виртуального окружения** с сообщением **Найден файл requirements.txt**. Это сообщение указывает, что Visual Studio использует данный файл для настройки виртуального окружения.

    ![Диалоговое окно "Добавление виртуального окружения" с сообщением о наличии файла requirements.txt](media/django/step01-add-virtual-environment-found-requirements.png)

1. Нажмите кнопку **Создать**, чтобы принять параметры по умолчанию. (При желании вы можете изменить имя виртуального окружения, просто изменив имя своей подпапки. Однако `env` является стандартным соглашением.)

1. Согласитесь с привилегиями администратора при появлении запроса, а затем подождите несколько минут, пока Visual Studio загружает и устанавливает пакеты. Для Django этот процесс представляет собой расширение нескольких тысяч файлов в примерно столько же подпапок! Ход выполнения отображается в окне **Вывод** Visual Studio. Во время ожидания просмотрите раздел вопросов.

1. В элементах управления Visual Studio Git (в строке состояния) выберите индикатор изменений (со значением **99&#42;** ), который открывает страницу **Изменения** в **Team Explorer**.

    Создание виртуального окружения привело к многочисленным изменениям, но вам не нужно включать их в систему управления версиями, потому что вы (или кто-то еще, клонирующий проект) в любое время сможете воссоздать окружение из *requirements.txt*.

    Чтобы исключить виртуальное окружение, щелкните правой кнопкой мыши папку **env** и выберите **Игнорировать эти локальные элементы**.

    ![Игнорирование виртуального окружения в изменениях системы управления версиями](media/django/step01-ignore-local-items.png)

1. После исключения виртуального окружения единственными оставшимися изменениями являются файл проекта и *.gitignore*. Файл *.gitignore* содержит добавленную запись для папки виртуального окружения. Вы можете дважды щелкнуть файл, чтобы увидеть различия.

1. Введите сообщение о фиксации и нажмите кнопку **Зафиксировать все**, а затем при желании отправьте фиксации в удаленный репозиторий.

### <a name="question-why-do-i-want-to-create-a-virtual-environment"></a>Вопрос. Зачем нужно создавать виртуальное окружение?

Ответ. Виртуальное окружение — это хороший способ изолировать конкретные зависимости вашего приложения. Такая изоляция позволяет избежать конфликтов в глобальном окружении Python и помогает как тестированию, так и совместной работе. Позже при разработке приложения вы неизменно используете множество необходимых пакетов Python. Сохраняя пакеты в виртуальном окружении, зависящем от проекта, вы сможете легко обновить файл *requirements.txt* проекта, описывающий это окружение в системе управления версиями. При копировании проекта на любые другие компьютеры, включая серверы сборки, серверы развертывания и другие компьютеры разработки, легко воссоздать окружение, используя только *requirements.txt* (поэтому окружение не должно находиться в системе управления версиями). См. дополнительные сведения о [виртуальных окружениях](selecting-a-python-environment-for-a-project.md#use-virtual-environments).

### <a name="question-how-do-i-remove-a-virtual-environment-thats-already-committed-to-source-control"></a>Вопрос. Как удалить виртуальное окружение, которое уже было привязано к системе управления версиями?

Ответ. Сначала измените файл *.gitignore*, чтобы исключить папку. Найдите раздел с комментарием `# Python Tools for Visual Studio (PTVS)` в конце и добавьте новую строку для папки виртуального окружения, например `/BasicProject/env`. (Так как в Visual Studio файл не отображается в **обозревателе решений**, откройте его напрямую с помощью команды меню **Файл** > **Открыть** > **Файл**. Вы также можете открыть файл из **Team Explorer**. На странице **Параметры** выберите **Параметры репозитория**, перейдите в раздел **Пропуск и файлы атрибутов**, а затем щелкните ссылку **Изменить** рядом с **.gitignore**.)

Во-вторых, откройте окно команд, перейдите к папке типа *BasicProject*, содержащей папку виртуального окружения, например *env*, и выполните команду `git rm -r env`. Затем скопируйте эти изменения из командной строки (`git commit -m 'Remove venv'`) или зафиксируйте на странице **изменений** в **Team Explorer**.

## <a name="step-1-4-examine-the-boilerplate-code"></a>Шаг 1–4. Изучение стереотипного кода

После завершения создания проекта изучите стереотипный код проекта Django (который снова совпадает с кодом, созданным командой CLI `django-admin startproject <project_name>`).

1. В проекте в качестве корневого компонента используется административная служебная программа командной строки Django *manage.py*, которую Visual Studio автоматически устанавливает в качестве файла запуска проекта. Запустите служебную программу в командной строке с помощью `python manage.py <command> [options]`. Для выполнения стандартных задач Django Visual Studio предоставляет удобные команды меню. В **обозревателе решений** щелкните проект правой кнопкой мыши и выберите пункт **Python**, чтобы открыть список. Некоторые из этих команд используются при работе с данным руководством.

    ![Команды Django в контекстном меню проекта Python](media/django/step01-django-commands-menu.png)

2. В вашем проекте находится папка с именем проекта. В ней содержатся основные файлы проекта Django.

   - *__init.py* — пустой файл, который сообщает Python, что эта папка представляет собой пакет Python.
   - *wsgi.py* — точка входа для веб-серверов, совместимых с WSGI, для использования в проекте. Обычно этот файл не нужно изменять, так как он предоставляет обработчики для рабочих веб-серверов.
   - Файл *settings.py* содержит параметры для проекта Django, которые вы изменяете в процессе разработки веб-приложения.
   - Файл *urls.py* содержит таблицу содержимого для проекта Django, которое вы также изменяете в процессе разработки.

     ![Файлы проекта Django в обозревателе решений](media/django/step01-django-project-in-solution-explorer.png)

3. Как отмечалось ранее, шаблон Visual Studio также добавляет в проект файл *requirements.txt*, определяющий зависимость пакета Django. Этот файл предлагает создать виртуальное окружение при первом создании проекта.

### <a name="question-can-visual-studio-generate-a-requirementstxt-file-from-a-virtual-environment-after-i-install-other-packages"></a>Вопрос. Может ли Visual Studio создать файл requirements.txt из виртуального окружения после установки других пакетов?

Ответ. Да. Разверните узел **Окружения Python**, щелкните свое виртуальное окружение правой кнопкой мыши и выберите команду **Создать requirements.txt**. Эту команду хорошо использовать периодически при изменении окружения и фиксировать изменения в файле *requirements.txt* в системе управления версиями вместе с любыми другими изменениями кода, которые зависят от этого окружения. Если вы настроили непрерывную интеграцию на сервере сборки, каждый раз при изменении окружения необходимо создавать файл и фиксировать изменения.

## <a name="step-1-5-run-the-empty-django-project"></a>Шаг 1–5. Запуск пустого проекта Django

1. В Visual Studio выберите **Отладка** > **Начать отладку** (**F5**) или нажмите кнопку **Веб-сервер** на панели инструментов (браузер может отличаться).

    ![Кнопка панели инструментов запуска веб-сервера в Visual Studio](media/django/run-web-server-toolbar-button.png)

1. Запуск сервера означает запуск команды `manage.py runserver <port>`, которая запускает встроенный сервер разработки Django. Если в Visual Studio отображается сообщение **Не удалось запустить отладчик** с сообщением об отсутствии файла запуска, щелкните правой кнопкой мыши файл **manage.py** в **обозревателе решений** и выберите пункт **Задать как файл запуска**.

1. При запуске сервера откроется окно консоли, в котором также отображается журнал сервера. Visual Studio автоматически открывает браузер для `http://localhost:<port>`. Однако, так как в проекте Django нет приложений, Django отображает только страницу по умолчанию, чтобы сообщить о нормальном состоянии процесса работы.

    ![Представление проекта Django по умолчанию](media/django/step01-first-run-success.png)

1. По окончании остановите сервер, закрыв консольное окно или используя команду **Отладка** > **Остановить отладку** в Visual Studio.

### <a name="question-is-django-a-web-server-as-well-as-a-framework"></a>Вопрос. Является ли Django веб-сервером и платформой?

Ответ. Да и нет. Django имеет встроенный веб-сервер, который используется для целей разработки. Этот веб-сервер используется, когда вы запускаете веб-приложение локально, например при отладке в Visual Studio. Однако при развертывании на веб-узел Django вместо него использует веб-сервер узла. Модуль *wsgi.py* в проекте Django отвечает за подключение к рабочим серверам.

### <a name="question-whats-the-difference-between-using-the-debug-menu-commands-and-the-server-commands-on-the-projects-python-submenu"></a>Вопрос. В чем разница между использованием команд меню "Отладка" и команд сервера в подменю проекта Python?

Ответ. В дополнение к командам меню **Отладка** и кнопкам панели инструментов вы также можете запустить сервер с помощью команд **Python** > **Запуск сервера** или **Python** > **Запуск сервера отладки** в контекстном меню проекта. Обе команды открывают окно консоли, в котором содержится локальный URL-адрес (localhost:port) для работающего сервера. Однако вы должны вручную открыть браузер с этим URL-адресом. Запуск сервера отладки автоматически не запускает отладчик Visual Studio. При желании вы можете присоединить отладчик к процессу позже с помощью команды **Отладка** > **Присоединение к процессу**.

## <a name="next-steps"></a>Дальнейшие действия

На данный момент основной проект Django не содержит приложений. Вы создаете приложение на следующем шаге. Так как вы обычно больше работаете с приложениями Django, чем с проектом Django, нет необходимости подробнее изучать стереотипные файлы.

> [!div class="nextstepaction"]
> [Tutorial step 2: Create a Django app with views and page templates](learn-django-in-visual-studio-step-02-create-an-app.md) (Руководство (шаг 2). Создание приложения Django с представлениями и шаблонами страниц)

## <a name="go-deeper"></a>Дополнительные подробности

- Код проекта Django: [Writing your first Django app, part 1](https://docs.djangoproject.com/en/2.0/intro/tutorial01/) (Написание первого приложения Django (часть 1)) (docs.djangoproject.com)
- Административная служебная программа: [django-admin и manage.py](https://docs.djangoproject.com/en/2.0/ref/django-admin/) (docs.djangoproject.com)
- Руководство по исходному коду на сайте GitHub: [Microsoft/python-sample-vs-learning-django](https://github.com/Microsoft/python-sample-vs-learning-django)