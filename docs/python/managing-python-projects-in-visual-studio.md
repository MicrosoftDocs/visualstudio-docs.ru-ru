---
title: Управление проектами приложений Python
description: Проекты в Visual Studio управляют зависимостями между файлами и сложными связями в приложении.
ms.date: 03/18/2019
ms.topic: conceptual
author: JoshuaPartlow
ms.author: joshuapa
manager: jmartens
ms.custom: seodec18
ms.workload:
- python
- data-science
ms.openlocfilehash: c9a20ea3baee84657e26e2d98bb5726c20ceba9e
ms.sourcegitcommit: 4908561809ad397c99cf204f52d5e779512e502c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "112254905"
---
# <a name="python-projects-in-visual-studio"></a>Проекты Python в Visual Studio

Приложения Python обычно определяются только с помощью файлов и папок, но такая структура может усложнить работу, так как приложения увеличиваются в размере и могут содержать автоматически сгенерированные файлы, JavaScript для веб-приложений и т. д. Проект Visual Studio помогает управлять этими сложными моментами. Проект (файл *.pyproj*) определяет все исходные файлы и файлы содержимого, связанные с проектом, содержит сведения о сборке каждого файла, хранит информацию для интеграции с системами управления версиями и помогает упорядочить приложение в виде логических компонентов.

![Проект Python в обозревателе решений](media/projects-solution-explorer.png)

Кроме того, проекты всегда управляются в *решении* Visual Studio, которое может содержать любое число проектов с возможностью ссылаться друг на друга. Например, проект Python может ссылаться на проект C++, который реализует модуль расширения. Благодаря этой связи Visual Studio автоматически создает проект C++ (при необходимости), когда вы запускаете отладку проекта Python. (Общие сведения см. в статье [Решения и проекты в Visual Studio](../ide/solutions-and-projects-in-visual-studio.md).)

Visual Studio предоставляет множество шаблонов проектов Python, позволяющих быстро настроить несколько структур приложений, а также шаблон для создания проекта из существующего дерева папок и шаблон для создания пустого проекта. Список шаблонов см. в разделе [Шаблоны проектов](#project-templates).

<a name="lightweight-usage-project-free"></a>

::: moniker range=">=vs-2019"
> [!Tip]
> В Visual Studio 2019 можно открыть папку с кодом Python и выполнить этот код, не создавая проект Visual Studio и файлы решения. Дополнительные сведения см. в разделе [Краткое руководство. Открытие и выполнение кода Python в папке](quickstart-05-python-visual-studio-open-folder.md). Но файл проекта имеет ряд важных преимуществ, которые мы описали в этой статье.
::: moniker-end

> [!Tip]
> Все версии Visual Studio нормально работают с кодом Python даже без проекта. Например, можно открыть сам файл Python и выполнить автозавершение и отладку, а также использовать функцию IntellSense. Для этого щелкните правой кнопкой мыши в редакторе и выберите пункт **Запуск с отладкой**. Такой код всегда использует глобальное окружение по умолчанию, однако при работе могут возникать неверные завершения или ошибки, если код предназначен для другого окружения. Кроме того, Visual Studio анализирует все файлы и пакеты в папке, из которой открыт один файл, что может значительно расходовать время ЦП.
>
> Проект Visual Studio можно создать из существующего кода, как описано в разделе [Создание проекта из существующих файлов](#create-project-from-existing-files).

![значок кинокамеры для видео](../install/media/video-icon.png "Посмотрите видео") [Подробный обзор. Использование системы управления версиями в проектах Python](https://youtu.be/Aq8eqApnugM) (8 мин 55 с, youtube.com).

## <a name="add-files-assign-a-startup-file-and-set-environments"></a>Добавление файлов, назначение файла запуска и настройка сред

При разработке приложения обычно требуется добавить в проект новые файлы различных типов. Чтобы это сделать, щелкните правой кнопкой мыши проект, выберите **Добавить** > **Существующий элемент** и перейдите к нужному файлу. Можно также выбрать **Добавить** > **Новый элемент**. Появится диалоговое окно с различными шаблонами элементов. Как описано в справочнике по [шаблонам элементов](python-item-templates.md), доступны такие варианты: пустые файлы Python, класс Python, модульный тест и различные файлы, связанные с веб-приложениями. Вы можете испробовать эти варианты с помощью тестового проекта, чтобы узнать о возможностях вашей версии Visual Studio.

Каждый проект Python имеет один назначенный файл запуска, выделенный полужирным шрифтом в **обозревателе решений**. Это файл, который запускается, когда вы запускаете отладку (**F5** или **Отладка** > **Начать отладку**) или выполняете проект в **интерактивном** окне (**SHIFT**+**ALTF**+**5** или **Отладка** > **Выполнить проект в интерактивном окне Python**). Чтобы изменить его, щелкните правой кнопкой мыши новый файл и выберите действие **Назначить автозапускаемым элементом** (или **Задать как файл запуска** в ранних версиях Visual Studio).

> [!Tip]
> Если удалить выбранный файл запуска из проекта и не выбрать новый, Visual Studio не будет знать, с какого файла Python нужно начинать выполнение проекта. В этом случае в Visual Studio 2017 версии 15.6 и более поздних версий возникает ошибка. В более ранних версиях либо открывается окно вывода с запущенным интерпретатором Python, либо окно вывода появляется, но почти сразу же исчезает. Если у вас возникла подобная ситуация, убедитесь, что назначен файл запуска.
>
> Чтобы окно вывода оставалось открытым, щелкните правой кнопкой мыши проект, выберите **Свойства**, откройте вкладку **Отладка**, а затем добавьте `-i` в поле **Аргументы интерпретатора**. Этот аргумент вынуждает интерпретатор перейти в интерактивный режим после завершения программы, оставив окно открытым, пока вы не нажмете клавиши **CTRL**+**Z** > **ВВОД** для выхода.

::: moniker range="vs-2017"
Новый проект всегда по умолчанию связан с глобальной средой Python. Чтобы связать проект с другим окружением (включая виртуальные), в проекте щелкните правой кнопкой мыши узел **Окружения Python** и выберите команду **добавления или удаления окружений Python**.
::: moniker-end
::: moniker range=">=vs-2019"
Новый проект всегда по умолчанию связан с глобальной средой Python. Чтобы связать проект с другим окружением (в том числе виртуальным), в проекте щелкните правой кнопкой мыши узел **Окружения Python** и выберите команду **Добавить окружение...**, а затем выберите нужные окружения. Можно также использовать элемент управления с раскрывающимся списком окружений на панели инструментов, чтобы выбрать окружение или добавить в проект новое.

![Команда "Добавить окружение" на панели инструментов Python](media/environments/environments-toolbar-2019.png)
::: moniker-end

Чтобы изменить активное окружение, в **обозревателе решений** щелкните правой кнопкой мыши нужное окружение и выберите действие **Активировать окружение**. Дополнительные сведения см. в разделе о [выборе окружения для проекта](selecting-a-python-environment-for-a-project.md).

![Активация среды для проектов Python](media/projects-activate-environment.png)

<a name="project-types"></a>

## <a name="project-templates"></a>Шаблоны проектов

Visual Studio предоставляет несколько способов настройки проекта Python — с нуля или из существующего кода. Чтобы использовать шаблон, выберите команду меню **Файл** > **Создать** > **Проект** или щелкните правой кнопкой мыши решение в **обозревателе решений** и выберите **Добавить** > **Новый проект**. В любом случае отобразится диалоговое окно **Новый проект**. Чтобы просмотреть шаблоны конкретно для Python, выполните поиск по запросу "Python" или последовательно выберите **Установленные** > **Python**:

![Диалоговое окно создания проекта с шаблонами Python](media/projects-new-project-dialog.png)

::: moniker range="<=vs-2017"

В следующей таблице перечислены шаблоны, доступные в Visual Studio 2017 (не все шаблоны доступны в предыдущих версиях).

| Шаблон | Описание |
| --- | --- |
| [**На основе существующего кода Python**](#create-project-from-existing-files) | Создает проект Visual Studio из существующего кода Python в структуре папок.  |
| **Приложение Python** | Структура базового проекта для нового приложения Python с одним пустым исходным файлом. По умолчанию проект выполняется в консоли интерпретатора глобальной среды по умолчанию, которую можно изменить, [назначив другую среду](selecting-a-python-environment-for-a-project.md). |
| [**Облачная служба Azure**](python-azure-cloud-service-project-template.md) | Проект для облачной службы Azure, написанный на Python. |
| [**Веб-проекты**](python-web-application-project-templates.md) | Проекты для веб-приложений на базе различных платформ, включая Bottle, Django и Flask. |
| **Приложение с IronPython** | Аналогичен шаблону приложения Python, но по умолчанию использует интерпретатор IronPython, поддерживающий взаимодействие .NET и смешанный режим отладки с использованием языков .NET. |
| **Приложение WPF с IronPython** | Структура проекта, использующая IronPython с XAML-файлами Windows Presentation Foundation для пользовательского интерфейса приложения. Visual Studio предоставляет конструктор пользовательского интерфейса XAML, возможность написания кода программной части на Python, а также возможность запуска приложения без отображения консоли. |
| **Веб-страница с IronPython и Silverlight** | Это проект IronPython, который выполняется в браузере с подключаемым модулем Silverlight. Код приложения Python добавляется на веб-страницу в виде скрипта. Стандартный тег скрипта получает часть кода JavaScript, который инициализирует IronPython, выполняющийся в Silverlight, откуда код Python может взаимодействовать с моделью DOM. |
| **Приложение Windows Forms с IronPython** | Структура проекта, использующая IronPython с пользовательским интерфейсом, созданным с помощью кода и Windows Forms. Приложение запускается без вывода консоли. |
| **Фоновое приложение (Интернет вещей)** | Поддерживает развертывание проектов Python для работы в качестве фоновых служб на устройствах. Дополнительные сведения см. на странице [центра разработчиков Интернета вещей Windows](https://dev.windows.com/en-us/iot). |
| **Модуль расширения Python** | Этот шаблон отображается в области Visual C++, если вы уже установили **Собственные средства разработки Python** с рабочей нагрузкой Python в Visual Studio 2017 или более поздней версии (см. раздел [Установка](installing-python-support-in-visual-studio.md)). Он предоставляет базовую структуру для библиотеки DLL расширения C++, как описано в статье [Создание расширения C++ для Python](working-with-c-cpp-python-in-visual-studio.md). |
::: moniker-end

::: moniker range=">=vs-2019"

В следующей таблице перечислены шаблоны, доступные в Visual Studio 2019 (не все шаблоны доступны в предыдущих версиях).

| Шаблон | Описание |
| --- | --- |
| [**На основе существующего кода Python**](#create-project-from-existing-files) | Создает проект Visual Studio из существующего кода Python в структуре папок.  |
| **Приложение Python** | Структура базового проекта для нового приложения Python с одним пустым исходным файлом. По умолчанию проект выполняется в консоли интерпретатора глобальной среды по умолчанию, которую можно изменить, [назначив другую среду](selecting-a-python-environment-for-a-project.md). |
| [**Веб-проекты**](python-web-application-project-templates.md) | Проекты для веб-приложений на базе различных платформ, включая Bottle, Django и Flask. |
| **Приложение с IronPython** | Аналогичен шаблону приложения Python, но по умолчанию использует интерпретатор IronPython, поддерживающий взаимодействие .NET и смешанный режим отладки с использованием языков .NET. |
| **Приложение WPF с IronPython** | Структура проекта, использующая IronPython с XAML-файлами Windows Presentation Foundation для пользовательского интерфейса приложения. Visual Studio предоставляет конструктор пользовательского интерфейса XAML, возможность написания кода программной части на Python, а также возможность запуска приложения без отображения консоли. |
| **Веб-страница с IronPython и Silverlight** | Это проект IronPython, который выполняется в браузере с подключаемым модулем Silverlight. Код приложения Python добавляется на веб-страницу в виде скрипта. Стандартный тег скрипта получает часть кода JavaScript, который инициализирует IronPython, выполняющийся в Silverlight, откуда код Python может взаимодействовать с моделью DOM. |
| **Приложение Windows Forms с IronPython** | Структура проекта, использующая IronPython с пользовательским интерфейсом, созданным с помощью кода и Windows Forms. Приложение запускается без вывода консоли. |
| **Фоновое приложение (Интернет вещей)** | Поддерживает развертывание проектов Python для работы в качестве фоновых служб на устройствах. Дополнительные сведения см. на странице [центра разработчиков Интернета вещей Windows](https://dev.windows.com/en-us/iot). |
| **Модуль расширения Python** | Этот шаблон отображается в области Visual C++, если вы уже установили **Собственные средства разработки Python** с рабочей нагрузкой Python в Visual Studio 2017 или более поздней версии (см. раздел [Установка](installing-python-support-in-visual-studio.md)). Он предоставляет базовую структуру для библиотеки DLL расширения C++, как описано в статье [Создание расширения C++ для Python](working-with-c-cpp-python-in-visual-studio.md). |
::: moniker-end

> [!Note]
> Так как Python является интерпретируемым языком, проекты Python в Visual Studio не создают отдельный исполняемый файл, как это делают проекты, написанные на других компилируемых языках программирования (например, C#). Дополнительные сведения см. в разделе [вопросов и ответов](overview-of-python-tools-for-visual-studio.md#questions-and-answers).

<a name="create-project-from-existing-files"></a>

### <a name="create-a-project-from-existing-files"></a>Создание проекта на основе имеющихся файлов

> [!Important]
> Описанный здесь процесс не перемещает и не копирует исходные файлы. Если вы хотите работать с копией, сначала создайте дубликат папки.

[!INCLUDE[project-from-existing](includes/project-from-existing.md)]

## <a name="linked-files"></a>Связанные файлы

Связанные файлы — это файлы, которые добавлены в проект, но при этом находятся за пределами папок проекта приложения. Они отображаются в **обозревателе решений** как обычные файлы с перекрывающимся значком ярлыка: ![значок связанного файла](media/projects-linked-file-icon.png)

Связанные файлы указаны в файле *PYPROJ* с помощью элемента `<Compile Include="...">`. Связанные файлы могут быть неявными, если они используют относительный путь за пределами структуры каталогов, или явными, если они используют пути в **обозревателе решений**:

```xml
<Compile Include="..\test2.py">
    <Link>MyProject\test2.py</Link>
</Compile>
```

Связанные файлы игнорируются при выполнении любого из следующих условий:

- Связанный файл содержит метаданные связи, и путь, указанный в атрибуте Include, находится в пределах каталога проекта.
- Связанный файл дублирует файл, который существует в иерархии проекта.
- Связанный файл содержит метаданные связи, и путь является относительным путем вне иерархии проекта.
- Путь связи является корневым.

### <a name="work-with-linked-files"></a>Работа со связанными файлами

Чтобы добавить существующий элемент в качестве связи, щелкните правой кнопкой мыши папку проекта, в которую вы хотите добавить файл, а затем выберите **Добавить** > **Существующий элемент**. В открывшемся диалоговом окне выберите файл и щелкните **Добавить как связь** в раскрывающемся списке кнопки **Добавить**. Если конфликтующие файлы отсутствуют, эта команда создает связь в выбранной папке. Связь не добавится, если файл с таким именем уже существует или связь с этим файлом уже существует в проекте.

При попытке создать связь с файлом, который уже существует в папке проекта, он добавляется как обычный файл, а не как связанный. Чтобы преобразовать файл в связь, выберите **Файл** > **Сохранить как** и сохраните файл в расположение вне иерархии проекта. Visual Studio автоматически преобразует его в связь. Аналогичным образом можно преобразовать связь обратно с помощью команды **Файл** > **Сохранить как** и сохранить файл в иерархии проекта.

При перемещении связанного файла в **обозревателе решений** связь также перемещается, но фактический файл при этом не затрагивается. Аналогичным образом, удаление связи приведет к удалению только связи, не затрагивая сам файл.

Связанные файлы нельзя переименовать.

## <a name="references"></a>Ссылки

Проекты Visual Studio поддерживают добавление ссылок на проекты и расширения, которые отображаются в узле **Ссылки** в **обозревателе решений**.

![Ссылки на расширения в проектах Python](media/projects-extension-references.png)

Ссылки на расширения обычно указывают зависимости между проектами и используются для обеспечения IntelliSense во время разработки или связывания во время компиляции. Проекты Python используют ссылки подобным образом, но из-за динамической природы Python они в основном используются во время разработки для предоставления усовершенствованной функции IntelliSense. Они также могут использоваться для развертывания в Microsoft Azure с целью установки дополнительных зависимостей.

### <a name="extension-modules"></a>Модули расширений

Ссылка на файл *PYD* позволяет использовать IntelliSense для созданного модуля. Visual Studio загружает файл *PYD* в интерпретатор Python и анализирует его типы и функции. Программа также пытается выполнить синтаксический анализ строк функций в документе, чтобы предоставить справку по сигнатурам.

Если в любой момент модуль расширения обновляется на диске, Visual Studio повторно анализирует модуль в фоновом режиме. Это не влияет на поведение во время выполнения, но некоторые варианты завершения остаются недоступными до завершения анализа.

Необходимо добавить [путь поиска](search-paths.md) к папке, содержащей модуль.

### <a name="net-projects"></a>Проекты .NET

При работе с IronPython можно добавить ссылки на сборки .NET, чтобы активировать использование IntelliSense. Для проектов .NET в решении щелкните правой кнопкой мыши узел **Ссылки** в проекте Python, выберите **Добавить ссылку**, щелкните вкладку **Проекты** и найдите нужный проект. Для библиотек DLL, которые вы скачали отдельно, выберите вкладку **Обзор** и перейдите к требуемой библиотеке DLL.

Так как ссылки в IronPython недоступны до вызова `clr.AddReference('<AssemblyName>')`, в сборку также нужно добавить соответствующий вызов `clr.AddReference`. Обычно он добавляется в начале кода. Например, код, созданный в Visual Studio с помощью шаблона проекта **Приложение Windows Forms IronPython**, включает в себя два вызова в начале файла:

```python
import clr
clr.AddReference('System.Drawing')
clr.AddReference('System.Windows.Forms')

from System.Drawing import *
from System.Windows.Forms import *

# Other code omitted
```

### <a name="webpi-projects"></a>Проекты WebPI

Можно добавить ссылки на записи продукта WebPI для развертывания в облачных службах Microsoft Azure, где можно установить дополнительные компоненты с помощью веб-канала WebPI. По умолчанию отображаемый веб-канал предназначен только для Python и содержит Django, CPython и другие основные компоненты. Также можно выбрать собственный веб-канал, как показано ниже. При публикации в Microsoft Azure задача установки устанавливает все продукты, на которые имеются ссылки.

> [!IMPORTANT]
> Проекты WebPI недоступны в Visual Studio 2017 или Visual Studio 2019.

![Ссылки на WebPI](media/projects-webPI-components.png)
