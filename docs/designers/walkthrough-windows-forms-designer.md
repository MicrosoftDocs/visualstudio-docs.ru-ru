---
title: Руководство по использованию конструктора Windows Forms
description: Сведения о том, как создать приложение с помощью различных инструментов, предоставляемых конструктором Windows Forms. Приложение — это настраиваемый элемент управления, использующий многие доступные функции макета.
ms.custom: SEO-VS-2020
ms.date: 08/09/2019
ms.topic: tutorial
helpviewer_keywords:
- Windows Forms Designer, get started
author: TerryGLee
ms.author: tglee
manager: jmartens
ms.openlocfilehash: 5803530290988affd6cfbb8342f3b1d545238985
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99947856"
---
# <a name="tutorial-get-started-with-windows-forms-designer"></a>Учебник. Начало работы с конструктором Windows Forms

Конструктор Windows Forms предоставляет множество средств для создания приложений Windows Forms. В этой статье показано, как создать приложение с помощью различных средств, предоставляемых конструктором, и выполнять такие задачи:

- размещать элементы управления с помощью линий привязки;
- выполнять задачи конструктора с помощью смарт-тегов;
- устанавливать поля и отбивки для элементов управления;
- располагать элементы управления с помощью элемента управления <xref:System.Windows.Forms.TableLayoutPanel>;
- разделять макет элемента управления с помощью элемента управления <xref:System.Windows.Forms.SplitContainer>;
- просматривать макет в окне "Структура документа";
- размещать элементы управления с отображением размера и сведений о расположении;
- задавать значения свойств в окне "Свойства".

В итоге вы создадите пользовательский элемент управления, используя разнообразные функции макета, которые доступны в конструкторе Windows Forms. Этот элемент управления реализует пользовательский интерфейс для простого калькулятора. На следующем изображении показан общий макет элемента управления калькулятора.

![Пользовательский интерфейс калькулятора из руководства](media/calculator-ui.gif)

## <a name="create-the-custom-control-project"></a>Создание проекта пользовательского элемента управления

Первым шагом является создание проекта элемента управления DemoCalculator.

1. Откройте Visual Studio и создайте проект категории **Библиотека элементов управления Windows Forms**. Задайте проекту имя **DemoCalculatorLib**.

   ::: moniker range=">=vs-2019"

   ![Шаблон библиотеки элементов управления Windows Forms в Visual Studio 2019](media/windows-forms-control-library-template.png)

   ::: moniker-end

2. Чтобы переименовать файл, в **обозревателе решений** щелкните правой кнопкой мыши элемент **UserControl1.vb** или **UserControl1.cs**, выберите **Переименовать** и замените имя файла на DemoCalculator.vb или DemoCalculator.cs. Чтобы переименовать все ссылки на элемент кода UserControl1, в соответствующем запросе выберите **Да**.

В конструктор Windows Forms отображается поверхность конструктора для элемента управления DemoCalculator. В этом представлении можно графически спроектировать внешний вид элемента управления, выбрав элементы управления и компоненты на панели элементов и поместив их на поверхности конструктора. Дополнительные сведения см. в статье о [разновидностях пользовательских элементов управления](/dotnet/framework/winforms/controls/varieties-of-custom-controls).

## <a name="design-the-control-layout"></a>Разработка макета элемента управления

Элемент управления DemoCalculator содержит несколько элементов управления Windows Forms. На этом этапе вы зададите расположение элементов управления с помощью конструктора Windows Forms.

1. В конструкторе Windows Forms увеличьте размер элемента управления DemoCalculator, выбрав маркер изменения размера в правом нижнем углу и перетащив его вниз и вправо. В правом нижнем углу Visual Studio просмотрите сведения о размере и расположении элементов управления. Задайте элементу управления ширину 500 и высоту 400, наблюдая за сведениями о размере при изменении размера элемента управления.

2. На **панели элементов** выберите узел **Контейнеры**, чтобы открыть его. Выберите элемент управления **SplitContainer** и перетащите его на поверхность конструктора.

   Элемент `SplitContainer` появится на поверхности конструктора элемента управления DemoCalculator.

    > [!TIP]
    > Размер элемента управления `SplitContainer` автоматически устанавливается в соответствии с размером элемента управления DemoCalculator. В окне **Свойства** проверьте свойства, заданные для элемента управления `SplitContainer`. Найдите свойство <xref:System.Windows.Forms.SplitContainer.Dock%2A>. Ему задано значение [DockStyle.Fill](xref:System.Windows.Forms.DockStyle.Fill). Это означает, что размер элемента управления `SplitContainer` устанавливается в соответствии с границами элемента управления DemoCalculator. Измените размер элемента управления DemoCalculator, чтобы проверить это поведение.

3. В окне **Свойства** замените значение свойства <xref:System.Windows.Forms.SplitContainer.Dock%2A> на `None`.

    Элемент управления `SplitContainer` уменьшится до размера по умолчанию и больше не будет меняться при изменении размера элемента управления DemoCalculator.

4. Щелкните глиф смарт-тега (![Глиф смарт-тега](media/smart-tag-glyph.gif)) в правом верхнем углу элемента управления `SplitContainer`. Выберите **Закрепить в родительском контейнере**, чтобы присвоить свойству `Dock` значение `Fill`.

    Элемент управления `SplitContainer` закрепится по границам элемента управления DemoCalculator.

    > [!NOTE]
    > Для некоторых элементов управления доступны смарт-теги, упрощающие проектирование. Дополнительные сведения см. в разделе [Пошаговое руководство: выполнение типичных задач с помощью смарт-тегов в элементах управления Windows Forms](/dotnet/framework/winforms/controls/performing-common-tasks-using-smart-tags-on-wf-controls).

5. Выберите вертикальную границу между панелями и перетащите ее вправо, так чтобы большую часть заняла левая панель.

    `SplitContainer` разделяет элемент управления DemoCalculator на две панели с разделяющей их границей, которую можно перемещать. На левой панели будут находиться кнопки калькулятора и экран, а на правой будет отображаться запись арифметических операций, выполненных пользователем.

6. В окне **Свойства** замените значение свойства `BorderStyle` на `Fixed3D`.

7. На **панели элементов** выберите узел **Стандартные элементы управления**, чтобы открыть его. Выберите элемент управления `ListView` и перетащите его на правую панель элемента управления `SplitContainer`.

8. Выберите глиф смарт-тега элемента управления `ListView`. На панели смарт-тегов замените значение параметра `View` на `Details`.

9. На панели смарт-тегов выберите **Изменить столбцы**.

   Откроется диалоговое окно **Редактор коллекции ColumnHeader**.

10. В диалоговом окне **Редактор коллекции ColumnHeader** выберите **Добавить**, чтобы добавить столбец в элемент управления `ListView`. Измените значение свойства элемента управления `Text` на **Журнал**. Нажмите кнопку **ОК**, чтобы создать столбец.

11. На панели смарт-тегов выберите **Закрепить в родительском контейнере**, а затем щелкните глиф смарт-тега, чтобы закрыть панель смарт-тегов.

12. С **панели элементов** узла **Контейнеры** перетащите элемент управления `TableLayoutPanel` на левую панель элемента управления `SplitContainer`.

    Элемент управления `TableLayoutPanel` отобразится на поверхности конструктора с открытой панелью смарт-тегов. Элемент управления `TableLayoutPanel` упорядочивает свои дочерние элементы управления в сетке. Элемент управления `TableLayoutPanel` будет содержать экран и кнопки элемента управления DemoCalculator. Дополнительные сведения см. в разделе [Пошаговое руководство: упорядочение элементов управления в формах Windows Forms с помощью элемента TableLayoutPanel](/dotnet/framework/winforms/controls/walkthrough-arranging-controls-on-windows-forms-using-a-tablelayoutpanel).

13. На панели смарт-тегов выберите **Правка строк и столбцов**.

    Откроется диалоговое окно **Стили столбцов и строк**.

14. Нажимайте кнопку **Добавить**, пока не добавятся пять столбцов. Выберите все пять столбцов, а затем в поле **Тип размера** выберите **Процент**. Параметру **Процент** задайте значение **20**. При этом каждому столбцу задается одинаковая ширина.

15. В разделе **Показать** выберите **Строки**.

16. Нажимайте кнопку **Добавить**, пока не добавятся пять строк. Выберите все пять строк, а затем в поле **Тип размера** выберите **Процент**. Параметру **Процент** задайте значение **20**. При этом каждой строке задается одинаковая высота.

17. Нажмите кнопку **ОК**, чтобы применить изменения, и щелкните глиф смарт-тега, чтобы закрыть панель смарт-тегов.

18. В окне **Свойства** замените значение свойства `Dock` на `Fill`.

## <a name="populate-the-control"></a>Заполнение элемента управления

Теперь, когда макет элемента управления настроен, можно добавить в элемент управления DemoCalculator кнопки и экран.

1. На **панели элементов** выберите значок элемента управления `TextBox`.

   Элемент управления `TextBox` помещается в первую ячейку элемента управления `TableLayoutPanel`.

2. В окне **Свойства** замените значение свойства ColumnSpan элемента управления `TextBox` на **5**.

   Элемент управления `TextBox` переместится в центр своей строки.

3. Замените значение свойства `Anchor` элемента управления `TextBox` на `Left`, `Right`.

   Элемент управления `TextBox` расширится по горизонтали, заняв все пять столбцов.

4. Измените значение свойства `TextBox` элемента управления `TextAlign` на `Right`.

5. В окне **Свойства** разверните узел свойства `Font`. Задайте значение **14** для `Size` и **true** для `Bold` у элемента управления `TextBox`.

6. Выберите элемент управления `TableLayoutPanel`.

7. На **панели элементов** выберите значок `Button`.

   Элемент управления `Button` разместится в следующей свободной ячейке элемента управления `TableLayoutPanel`.

8. На **панели элементов** выберите `Button` еще четыре раза, чтобы заполнить вторую строку элемента управления `TableLayoutPanel`.

9. Выберите все пять элементов управления `Button`, удерживая нажатой клавишу **SHIFT**. Нажмите клавиши **CTRL**+**C**, чтобы скопировать элементы управления `Button` в буфер обмена.

10. Трижды нажмите сочетание клавиш **CTRL**+**V**, чтобы вставить скопированные элементы управления `Button` в оставшиеся строки элемента управления `TableLayoutPanel`.

11. Выберите все 20 элементов управления `Button`, удерживая нажатой клавишу **SHIFT**.

12. В окне **Свойства** замените значение свойства `Dock` на `Fill`.

    Все элементы управления `Button` закрепятся в своих ячейках.

13. В окне **Свойства** разверните узел свойства `Margin`. Для `All` задайте значение **5**.

    Всем элементам управления `Button` задается меньший размер, чтобы увеличить поля между ними.

14. Выберите **button10** и **button20**, после чего нажмите клавишу **DELETE**, чтобы удалить их из макета.

15. Выберите **button5** и **button15**, после чего замените значение их свойства `RowSpan` на **2**. Это будут кнопки **очистки** и **=** для элемента управления DemoCalculator.

## <a name="use-the-document-outline-window"></a>Использование окна структуры документа

Если в элементе управления или форме присутствует несколько элементов управления, перемещаться по макету удобнее с помощью окна "Структура документа".

1. В строке меню выберите **Вид** > **Другие окна** > **Структура документа**.

   В этом окне структура элемента управления DemoCalculator и его составных элементов управления представлена в виде дерева. Дочерние элементы управления контейнерных элементов управления, таких как `SplitContainer`, отображаются в виде подузлов дерева. Окно также позволяет переименовывать размещенные элементы управления.

2. В окне **Структура документа** щелкните правой кнопкой мыши элемент **button1**, чтобы выбрать его, после чего щелкните **Переименовать**. Замените его имя на sevenButton.

3. В окне **Структура документа** замените имена элементов управления `Button`, заданные конструктором, на имена для рабочей среды согласно следующему списку:

   - button1 на **sevenButton**;

   - button2 на **eightButton**;

   - button3 на **nineButton**;

   - button4 на **divisionButton**;

   - button5 на **clearButton**;

   - button6 на **fourButton**;

   - button7 на **fiveButton**;

   - button8 на **sixButton**;

   - button9 на **multiplicationButton**;

   - button11 на **oneButton**;

   - button12 на **twoButton**;

   - button13 на **threeButton**;

   - button14 на **subtractionButton**;

   - button15 на **equalsButton**;

   - button16 на **zeroButton**;

   - button17 на **changeSignButton**;

   - button18 на **decimalButton**;

   - button19 на **additionButton**;

4. С помощью окон **Структура документа** и **Свойства** измените значения свойства `Text` для каждого имени элемента управления `Button` согласно следующему списку:

   - для элемента управления sevenButton замените свойство текста на **7**;

   - для элемента управления eightButton замените свойство текста на **8**;

   - для элемента управления nineButton замените свойство текста на **9**;

   - для элемента управления divisionButton замените свойство текста на **/** (косая черта);

   - для элемента управления clearButton замените свойство текста на **Clear**;

   - для элемента управления fourButton замените свойство текста на **4**;

   - для элемента управления fiveButton замените свойство текста на **5**;

   - для элемента управления sixButton замените свойство текста на **6**;

   - для элемента управления multiplicationButton замените свойство текста на **\*** (звездочка);

   - для элемента управления oneButton замените свойство текста на **1**;

   - для элемента управления twoButton замените свойство текста на **2**;

   - для элемента управления threeButton замените свойство текста на **3**;

   - для элемента управления subtractionButton замените свойство текста на **-** (дефис);

   - для элемента управления equalsButton замените свойство текста на **=** (знак равенства);

   - для элемента управления zeroButton замените свойство текста на **0**;

   - для элемента управления changeSignButton замените свойство текста на **+/-** ;

   - для элемента управления decimalButton замените свойство текста на **.** (точка);

   - для элемента управления additionButton замените свойство текста на **+** (знак "плюс");

5. На поверхности конструктора выберите все элементы управления `Button`, удерживая нажатой клавишу **SHIFT**.

6. В окне **Свойства** разверните узел свойства `Font`. Задайте значение **14** для `Size` и **true** для `Bold` у всех элементов управления `Button`.

На этом разработка элемента управления DemoCalculator завершена. Остается только добавить логику калькулятора.

## <a name="implement-event-handlers"></a>Добавление обработчиков событий

Кнопки в элементе управления DemoCalculator имеют обработчики событий, которые можно использовать для реализации большей части логики калькулятора. Конструктор Windows Forms позволяет реализовать заглушки всех обработчиков событий для всех кнопок одним выбором.

1. На поверхности конструктора выберите все элементы управления `Button`, удерживая нажатой клавишу **SHIFT**.

2. Выберите один из элементов управления `Button`.

   В редакторе кода откроются обработчики событий, созданные конструктором.

## <a name="test-the-control"></a>Тестирование элемента управления

Поскольку элемент управления DemoCalculator наследуется от класса <xref:System.Windows.Forms.UserControl>, его поведение можно проверить с помощью **Контейнера для тестирования пользовательских элементов управления**. Дополнительные сведения см. в разделе [Практическое руководство. Тестирование поведения элемента UserControl во время выполнения](/dotnet/framework/winforms/controls/how-to-test-the-run-time-behavior-of-a-usercontrol).

1. Нажмите клавишу **F5**, чтобы собрать и запустить элемент управления DemoCalculator в **Контейнере для тестирования пользовательских элементов управления**.

2. Выберите границу между панелями `SplitContainer` и перетащите ее влево и вправо. Размеры элемента `TableLayoutPanel` и всех его дочерних элементов управления будут изменяться в соответствии с доступным пространством.

3. Завершив тестирование элемента управления, нажмите кнопку **Закрыть**.

## <a name="use-the-control-on-a-form"></a>Использование элемента управления в форме

Элемент управления DemoCalculator можно использовать в других составных элементах управления или в форме. Ниже описано, как это сделать.

### <a name="create-the-project"></a>Создание проекта

Первым шагом является создание проекта приложения. В этом проекте выполняется сборка приложения, демонстрирующего работу пользовательского элемента управления.

1. Создайте проект **Приложение Windows Forms** с именем **DemoCalculatorTest**.

2. В **обозревателе решений** щелкните правой кнопкой мыши проект **DemoCalculatorTest** и выберите **Добавить ссылку**, чтобы открыть диалоговое окно **Добавление ссылки**.

3. Перейдите на вкладку **Проекты** и выберите проект DemoCalculatorLib, чтобы добавить ссылку на тестовый проект.

4. В **обозревателе решений** щелкните правой кнопкой мыши **DemoCalculatorTest** и выберите пункт **Назначить запускаемым проектом**.

5. В конструкторе Windows Forms увеличьте размер формы примерно до **700 x 500**.

### <a name="use-the-control-in-the-forms-layout"></a>Использование элемента управления в макете формы

Чтобы использовать элемент управления DemoCalculator в приложении, его необходимо поместить в форму.

1. На **панели элементов** разверните узел **Компоненты DemoCalculatorLib**.

2. Перетащите элемент управления **DemoCalculator** с **панели элементов** в форму. Переместите элемент управления в левый верхний угол формы. Когда элемент управления расположен близко к границам формы, отображаются *линии привязки*. Линии привязки указывают расстояние свойства `Padding` формы и свойства `Margin` элемента управления. Поместите элемент управления в расположение, указанное линиями привязки.

   Дополнительные сведения см. в разделе [Пошаговое руководство: упорядочение элементов управления в формах Windows Forms с помощью линий привязки](/dotnet/framework/winforms/controls/walkthrough-arranging-controls-on-windows-forms-using-snaplines).

3. Перетащите элемент управления `Button` с **панели элементов** и поместите его в форму.

4. Перемещайте элемент управления `Button` по элементу управления DemoCalculator, чтобы определить, где отображаются линии привязки. С помощью этой функции можно точно и легко упорядочить элементы управления. По завершении удалите элемент управления `Button`.

5. Щелкните правой кнопкой мыши элемент управления DemoCalculator и выберите пункт **Свойства**.

6. Замените значение свойства `Dock` на `Fill`.

7. Выберите форму, а затем разверните узел свойства `Padding`. Замените значение **Все** на **20**.

   Размер элемента управления DemoCalculator уменьшится в соответствии с новым значением формы `Padding`.

8. Измените размер формы, перетаскивая различные маркеры изменения размера в разные положения. Обратите внимание на то, как размер элемента управления DemoCalculator пропорционально изменяется.

## <a name="next-steps"></a>Следующие шаги

В этой статье было показано, как создать пользовательский интерфейс для простого калькулятора. В дальнейшем можно расширить его функциональность, реализовав логику калькулятора, а затем [опубликовать приложение с помощью ClickOnce](../deployment/how-to-publish-a-clickonce-application-using-the-publish-wizard.md). Вы также можете ознакомиться с руководством по [созданию средства просмотра рисунков с помощью Windows Forms](../ide/tutorial-1-create-a-picture-viewer.md).

## <a name="see-also"></a>См. также

- [Элементы управления Windows Forms](/dotnet/framework/winforms/controls/)
- [Специальные возможности для элементов управления в Windows Forms](/dotnet/framework/winforms/controls/providing-accessibility-information-for-controls-on-a-windows-form)
- [Публикация с помощью ClickOnce](../deployment/how-to-publish-a-clickonce-application-using-the-publish-wizard.md)
