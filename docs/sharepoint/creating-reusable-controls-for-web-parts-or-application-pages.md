---
title: Создание многократно используемых элементов управления для веб-частей или страниц приложений | Документация Майкрософт
titleSuffix: ''
description: Создавайте в Visual Studio пользовательские элементы управления с возможностью повторного использования, которые можно размещать на страницах приложений и в веб-частях, используемых в SharePoint.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: overview
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- user controls [SharePoint development in Visual Studio], creating
- SharePoint development in Visual Studio, user controls
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: b61474f4290771fb139d511296580ec1ef0f8820
ms.sourcegitcommit: 80fc9a72e9a1aba2d417dbfee997fab013fc36ac
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2021
ms.locfileid: "106213918"
---
# <a name="create-reusable-controls-for-web-parts-or-application-pages"></a>Создание многократно используемых элементов управления для веб-частей или страниц приложений
  Visual Studio позволяет создавать пользовательские элементы управления с возможностью повторного использования, которые можно размещать на страницах приложений и в веб-частях, используемых в SharePoint. Эти элементы управления называются пользовательскими. Пользовательский элемент управления — это своего рода составной элемент управления, который во многом работает так же, как веб-страница ASP.NET: вы можете добавлять в него существующие элементы управления веб-сервера и разметку, а также определять для него свойства и методы. Затем вы можете внедрять их в веб-страницы ASP.NET, где они будут действовать как единое целое.

## <a name="create-a-user-control"></a>Создание пользовательского элемента управления
 Чтобы создать пользовательский элемент управления, добавьте объект **Пользовательский элемент управления** в **пустой проект SharePoint**. Дополнительные сведения см. в разделе [Практическое руководство. Создание пользовательского элемента управления для веб-части или страницы приложения SharePoint](../sharepoint/how-to-create-a-user-control-for-a-sharepoint-application-page-or-web-part.md).

 При добавлении элемента **Пользовательский элемент управления** Visual Studio создает в проекте папку, а затем добавляет в нее несколько файлов. Эти файлы описываются в следующей таблице.

|Файл|Описание|
|----------|-----------------|
|Файл пользовательского элемента управления|Определяет пользовательский элемент управления. Проектируйте пользовательский элемент управления, добавляя элементы управления и разметку в этот файл.|
|Файл кода|Содержит внутренний код пользовательского элемента управления. Добавляйте в этот файл код для обработки событий.|
|Файл кода конструктора|Содержит код, созданный конструктором (его не следует изменять прямо в файле).|

## <a name="design-the-user-control"></a>Проектирование пользовательского элемента управления
 Для проектирования пользовательского элемента управления используется конструктор Visual Web Developer в Visual Studio. Чтобы открыть этот конструктор, откройте в своем проекте файл пользовательского элемента управления и перейдите на вкладку **Конструктор**.

## <a name="consume-the-user-control"></a>Использование пользовательского элемента управления
 Пользовательские элементы управления не отображаются в SharePoint, пока вы не включите их на странице приложения или в веб-части.

 Чтобы включить пользовательский элемент управления на странице приложения, откройте веб-страницу, на которую хотите добавить этот пользовательский элемент управления ASP.NET. Перейдите в представление конструирования, выберите файл пользовательского элемента управления в обозревателе решений и перетащите его на эту страницу. Пользовательский элемент управления ASP.NET добавляется на страницу, и конструктор создает директиву @ Register, которая необходима, чтобы страница могла распознать этот пользовательский элемент управления. Теперь можно работать с общедоступными свойствами и методами этого элемента управления.

 Чтобы включить пользовательский элемент управления в веб-часть, добавьте его в коллекцию <xref:System.Web.UI.WebControls.WebParts.Part.Controls%2A> веб-части в файле кода веб-части. В следующем примере пользовательский элемент управления добавляется в коллекцию <xref:System.Web.UI.WebControls.WebParts.Part.Controls%2A> веб-части.

 :::code language="vb" source="../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1.vb" id="Snippet5":::
 :::code language="csharp" source="../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1.cs" id="Snippet5":::

## <a name="debug-a-user-control"></a>Отладка пользовательского элемента управления
 Для отладки пользовательского элемента управления убедитесь, что он включен на странице приложения или в веб-части вашего проекта SharePoint. После этого можно отлаживать код в пользовательском элементе управления так же, как код в любом проекте Visual Studio.

 При запуске отладчика Visual Studio открывается сайт SharePoint.

 Откройте в SharePoint страницу приложения с этим пользовательским элементом управления. Если пользовательский элемент управления включен в веб-часть, добавьте эту веб-часть на страницу веб-частей в SharePoint.

 Дополнительные сведения об отладке проектов SharePoint см. в разделе [Устранение неполадок решений SharePoint](../sharepoint/troubleshooting-sharepoint-solutions.md).

## <a name="related-topics"></a>См. также

|Заголовок|Описание|
|-----------|-----------------|
|[Практическое руководство. Создание пользовательского элемента управления для страницы приложения или веб-части SharePoint](../sharepoint/how-to-create-a-user-control-for-a-sharepoint-application-page-or-web-part.md)|Показывается, как создавать пользовательские элементы управления с возможностью многократного использования, которые можно размещать на страницах приложений и в веб-частях, работающих в SharePoint.|
