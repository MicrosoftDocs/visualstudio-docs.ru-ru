---
title: Отладка расширений для инструментов SharePoint в Visual Studio | Документация Майкрософт
description: Расширения отладки для инструментов SharePoint в Visual Studio. Отладка расширений инструментов SharePoint в экспериментальном экземпляре или в обычном экземпляре VS.
ms.custom: SEO-VS-2020
titleSuffix: ''
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, debugging extensions
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 2b098ac007825745e13481592760be9d2badeb55
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99948912"
---
# <a name="debug-extensions-for-the-sharepoint-tools-in-visual-studio"></a>Отладка расширений для инструментов SharePoint в Visual Studio
  Вы можете выполнять отладку расширений инструментов SharePoint в экспериментальном экземпляре или в обычном экземпляре Visual Studio. Если необходимо устранить неполадки расширения, можно также изменить значения реестра, чтобы отобразить дополнительные сведения об ошибке и настроить выполнение команд SharePoint в Visual Studio.

## <a name="debug-extensions-in-the-experimental-instance-of-visual-studio"></a>Отладка расширений в экспериментальном экземпляре Visual Studio
 Чтобы защитить среду разработки Visual Studio от случайного повреждения непроверяемыми расширениями, пакет SDK для Visual Studio предоставляет альтернативный экземпляр Visual Studio, называемый *экспериментальным экземпляром*, который можно использовать для установки и тестирования расширений. Вы разрабатываете новые расширения с помощью обычного экземпляра Visual Studio, но отладка и запуск их в экспериментальном экземпляре. Дополнительные сведения см. [в статье экспериментальный экземпляр](../extensibility/the-experimental-instance.md).

 Если для развертывания расширения используется проект VSIX, а проект VSIX является запускаемым проектом в решении, Visual Studio автоматически устанавливает и запускает расширение в экспериментальном экземпляре при отладке решения. Запускаемый проект — это проект, который запускается при отладке решения, содержащего несколько проектов. Дополнительные сведения об использовании проекта VSIX для развертывания расширения см. в разделе [развертывание расширений для инструментов SharePoint в Visual Studio](../sharepoint/deploying-extensions-for-the-sharepoint-tools-in-visual-studio.md).

 Примеры, демонстрирующие отладку различных типов расширений в экспериментальном экземпляре Visual Studio, см. в следующих пошаговых руководствах.

- [Пошаговое руководство. расширение типа элемента проекта SharePoint](../sharepoint/walkthrough-extending-a-sharepoint-project-item-type.md)

- [Пошаговое руководство. Создание элемента проекта настраиваемого действия с помощью шаблона элемента, часть 1](../sharepoint/walkthrough-creating-a-custom-action-project-item-with-an-item-template-part-1.md)

- [Пошаговое руководство. Создание настраиваемого шага развертывания для проектов SharePoint](../sharepoint/walkthrough-creating-a-custom-deployment-step-for-sharepoint-projects.md)

- [Пошаговое руководство. расширение обозреватель сервера для показа веб-частей](../sharepoint/walkthrough-extending-server-explorer-to-display-web-parts.md)

- [Пошаговое руководство. вызов клиентской объектной модели SharePoint в расширении обозреватель сервера](../sharepoint/walkthrough-calling-into-the-sharepoint-client-object-model-in-a-server-explorer-extension.md)

## <a name="debug-extensions-in-the-regular-instance-of-visual-studio"></a>Отладка расширений в обычном экземпляре Visual Studio
 Если вы хотите выполнить отладку проекта расширения в обычном экземпляре Visual Studio, сначала установите расширение в обычном экземпляре. Затем подключите отладчик к второму процессу Visual Studio. После завершения вы можете удалить расширение, чтобы оно больше не загрузилось на компьютер разработчика.

#### <a name="to-install-the-extension"></a>Установка расширения

1. Закройте все экземпляры Visual Studio.

2. В выходной папке Build для проекта расширения откройте *VSIX* -файл, дважды щелкнув его или открыв его контекстное меню и выбрав **Открыть**.

3. В диалоговом окне **установщик расширений Visual Studio** выберите выпуск Visual Studio, в который необходимо установить расширение, и нажмите кнопку **установить** .

     Visual Studio устанавливает файлы расширения в%UserProfile%\AppData\Local\Microsoft\VisualStudio\11.0\Extensions \\  \\ *имя расширения* имени автора \\ . Последние три папки в этом пути создаются из `Author` `Name` элементов, и `Version` в файле *Extension. vsixmanifest* для расширения.

4. После установки расширения Visual Studio нажмите кнопку **Закрыть** .

#### <a name="to-debug-the-extension"></a>Отладка расширения

1. Откройте Visual Studio с правами администратора и откройте проект расширения. Следующие шаги ссылаются на этот экземпляр Visual Studio в качестве *первого экземпляра*.

2. Запустите другой экземпляр Visual Studio с правами администратора. Следующие шаги ссылаются на этот экземпляр Visual Studio в качестве *второго экземпляра*.

3. Переключитесь на первый экземпляр Visual Studio.

4. В строке меню выберите **Отладка**, **присоединить к процессу**.

5. В списке **Доступные процессы** выберите *devenv.exe*. Эта запись относится ко второму экземпляру Visual Studio; Это экземпляр, в котором необходимо выполнить отладку расширения проекта.

6. Нажмите кнопку **присоединить** .

     Visual Studio запускает проект расширения в режиме отладки.

7. Переключитесь на второй экземпляр Visual Studio.

8. Создайте новый проект SharePoint, загружающий расширение. Например, если выполняется отладка расширения для элементов проекта определения списка, создайте проект **определения списка** .

9. Выполните все действия, необходимые для проверки кода расширения.

10. Завершив отладку расширения, закройте второй экземпляр Visual Studio.

#### <a name="to-remove-the-extension"></a>Удаление расширения

1. В Visual Studio в строке меню выберите **Сервис**, **расширения и обновления**.

     Появится диалоговое окно **Расширения и обновления**.

2. В списке расширений выберите имя расширения, а затем нажмите кнопку **Удалить** .

3. В появившемся диалоговом окне нажмите кнопку **Да** , чтобы подтвердить удаление расширения.

4. Нажмите кнопку **Перезагрузить сейчас** , чтобы завершить удаление.

## <a name="debug-sharepoint-commands"></a>Отладка команд SharePoint
 Если требуется выполнить отладку команды SharePoint, которая является частью расширения инструментов SharePoint, необходимо подключить отладчик к *vssphost4.exe* процессу. Это 64-разрядный ведущий процесс, выполняющий команды SharePoint. Дополнительные сведения о командах и *vssphost4.exe* SharePoint см. [в разделе Вызов объектных моделей SharePoint](../sharepoint/calling-into-the-sharepoint-object-models.md).

#### <a name="to-attach-the-debugger-to-the-vssphost4exe-process"></a>Подключение отладчика к vssphost4.exe процессу

1. Начните отладку расширения в экспериментальном экземпляре Visual Studio или в обычном экземпляре Visual Studio, выполнив приведенные выше инструкции.

2. В экземпляре Visual Studio, в котором выполняется отладчик, в строке меню выберите **Отладка**, **присоединить к процессу**.

3. В списке **Доступные процессы** выберите *vssphost.exe*.

    > [!NOTE]
    > Если vssphost.exe не отображается в списке, необходимо запустить процесс *vssphost4.exe* в экземпляре Visual Studio, в котором выполняется расширение. Как правило, это делается путем выполнения действия, которое заставляет Visual Studio подключиться к сайту SharePoint на компьютере разработчика. Например, Visual Studio запускается *vssphost4.exe* при развертывании узла подключения к сайту (узла, который отображает URL-адрес сайта) в узле **подключения SharePoint** в окне **Обозреватель сервера** или при добавлении определенных элементов проекта SharePoint, таких как элементы **экземпляра списка** или **приемника событий** , в проект SharePoint.

4. Нажмите кнопку **присоединить** .

5. В отлаживаемом экземпляре Visual Studio выполните действия, необходимые для выполнения команды.

## <a name="modify-registry-values-to-help-debug-sharepoint-tools-extensions"></a>Изменение значений реестра для справки по отладке расширений инструментов SharePoint
 При отладке расширения средств SharePoint в Visual Studio можно изменить значения в реестре, чтобы упростить устранение неполадок с расширением. Значения существуют в ключе **HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\11.0\SharePointTools** . Эти значения не существуют по умолчанию.

 Чтобы помочь в устранении неполадок с любым расширением инструментов SharePoint, можно создать и задать значение Енабледиагностикс. Это значение описывается в следующей таблице.

|Значение|Описание|
|-----------|-----------------|
|енабледиагностикс|REG_DWORD, указывающее, отображаются ли диагностические сообщения в окне **вывода** .<br /><br /> Чтобы отобразить диагностические сообщения, установите для этого параметра значение 1. Чтобы отключить отображение сообщений, присвойте этому параметру значение 0 или удалите это значение.<br /><br /> Для записи сообщений в окно **вывода** из расширения инструментов SharePoint используйте службу проектов SharePoint. Дополнительные сведения см. [в статье Использование службы проектов SharePoint](../sharepoint/using-the-sharepoint-project-service.md).|

 Если расширение содержит команду SharePoint, можно создать и задать дополнительные значения для устранения неполадок с командой. Данные значения описываются в следующей таблице.

|Значение|Описание|
|-----------|-----------------|
|аттачдебугжертохостпроцесс|REG_DWORD, указывающее, следует ли отображать диалоговое окно, позволяющее присоединить отладчик к *vssphost4.exe* сразу после запуска. Это полезно, если команда, которую требуется отладить, выполняется vssphost.exe сразу после запуска, и недостаточно времени для подключения отладчика вручную перед выполнением команды. Чтобы отобразить диалоговое окно, *vssphost4.exe* вызывает <xref:System.Diagnostics.Debugger.Break%2A> метод при запуске.<br /><br /> Чтобы включить такое поведение, задайте для этого параметра значение 1. Чтобы отключить это поведение, присвойте этому параметру значение 0 или удалите это значение.<br /><br /> Если установить это значение равным 1, может потребоваться увеличить значение Хостпроцессстартуптимеаут, чтобы предоставить достаточно времени для подключения отладчика, прежде чем Visual Studio *предvssphost4.exe* полагают, что он успешно запущен.|
|чаннелоператионтимеаут|REG_DWORD, указывающее время в секундах, в течение которого Visual Studio ожидает выполнения команды SharePoint. Если команда не выполняется вовремя, <xref:Microsoft.VisualStudio.SharePoint.SharePointConnectionException> создается исключение.<br /><br /> Значение по умолчанию — 120 секунд.|
|хостпроцессстартуптимеаут|REG_DWORD, указывающее время в секундах, в течение которого Visual Studio ожидает от *vssphost4.exe* сигнал о том, что он успешно запущен. Если *vssphost4.exe* не сообщает об успешном запуске во времени, <xref:Microsoft.VisualStudio.SharePoint.SharePointConnectionException> создается исключение.<br /><br /> Значение по умолчанию ― 60 секунд.|
|MaxReceivedMessageSize|REG_DWORD, указывающее максимально допустимый размер (в байтах) сообщений WCF, передаваемых между Visual Studio и *vssphost4.exe*.<br /><br /> Значение по умолчанию — 1 048 576 байт (1 МБ).|
|MaxStringContentLength|REG_DWORD, указывающее максимально допустимый размер (в байтах) строк, передаваемых между Visual Studio и *vssphost4.exe*.<br /><br /> Значение по умолчанию — 1 048 576 байт (1 МБ).|

## <a name="see-also"></a>См. также раздел

- [Расширение средств SharePoint в Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md)
- [Развертывание расширений для инструментов SharePoint в Visual Studio](../sharepoint/deploying-extensions-for-the-sharepoint-tools-in-visual-studio.md)
