---
title: Создание веб-части для SharePoint с помощью конструктора
description: В этом пошаговом руководстве вы создадите веб-часть визуально с помощью шаблона проекта визуальной веб-части SharePoint в Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- Web Parts [SharePoint development in Visual Studio], designer
- Web Parts [SharePoint development in Visual Studio], creating
- Web Parts [SharePoint development in Visual Studio], designing
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 55f69875b06428c9bbe179e73dd6ea9b4ef40b8e
ms.sourcegitcommit: 1f27f33852112702ee35fbc0c02fba37899e4cf5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2021
ms.locfileid: "112112446"
---
# <a name="walkthrough-create-a-web-part-for-sharepoint-by-using-a-designer"></a>Пошаговое руководство: создание веб-части для SharePoint с помощью конструктора

При создании веб-частей для сайта SharePoint пользователи могут напрямую изменять содержимое, внешний вид и поведение страниц этого сайта с помощью браузера. В этом пошаговом руководстве показано, как визуально создать веб-часть с помощью шаблона проекта **визуальной веб-части** SharePoint в Visual Studio.

Создаваемая веб-часть отображает месячное представление календаря и флажок для каждого списка календаря на сайте. Пользователи могут указать списки календарей, которые следует включить в представление месячного календаря, установив флажки.

В этом пошаговом руководстве описаны следующие задачи:

- Создание веб-части с помощью шаблона проекта **визуальной веб-части** .
- Проектирование веб-части с помощью конструктора Visual Web Developer в Visual Studio.
- Добавление кода для работы с событиями элементов управления в веб-части.
- Тестирование веб-части в SharePoint.

    > [!NOTE]
    > На компьютере могут отображаться разные имена или расположения для некоторых элементов пользовательского интерфейса для Visual Studio в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. См. статью [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).

## <a name="prerequisites"></a>Предварительные требования

Для выполнения этого пошагового руководства требуются следующие компоненты:

- Поддерживаемые выпуски Windows и SharePoint.

## <a name="create-a-web-part-project"></a>Создание проекта веб-части

Сначала создайте проект веб-части с помощью шаблона проекта **визуальной веб-части** .

1. Начните с [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] использования команды **Запуск от имени администратора** .

2. В строке меню выберите **Файл** > **Создать** > **Проект**.
::: moniker range="=vs-2017"

3. В диалоговом окне **Новый проект** в разделе **Visual C#** или **Visual Basic** разверните узел **Office/SharePoint** и выберите категорию **решения SharePoint** .

4. В списке шаблонов выберите шаблон **веб-части SharePoint 2013-Visual** и нажмите кнопку **ОК** .

     Откроется **Мастер настройки SharePoint** . С помощью этого мастера можно указать сайт, который будет использоваться для отладки проекта, и уровень доверия решения.
::: moniker-end
::: moniker range=">=vs-2019"
3. В диалоговом окне **Создание нового проекта** выберите *пустой проект SharePoint** для определенной версии SharePoint, которую вы установили. Например, если установлен SharePoint 2019, выберите шаблон **проекта sharepoint 2019-Empty** .
    [!INCLUDE[new-project-dialog-search](../sharepoint/includes/new-project-dialog-search-md.md)]

4. В поле **имя** введите **TestProject1**, а затем нажмите кнопку **создать** .

::: moniker-end
5. В разделе **что такое уровень доверия для этого решения SharePoint?** выберите параметр **Развернуть как решение фермы** .

6. Нажмите кнопку **Готово** , чтобы принять локальный сайт SharePoint по умолчанию.

## <a name="designing-the-web-part"></a>Проектирование веб-части

Создайте веб-часть, добавив элементы управления из **панели элементов** на поверхность конструктора Visual Web Developer.

1. В конструкторе Visual Web Developer перейдите на вкладку **конструктор** , чтобы переключиться на представление конструирования.

2. В строке меню выберите **вид**  >  **панель элементов**.

3. В **стандартном** узле **панели элементов** выберите элемент управления **CheckBoxList** , а затем выполните одно из следующих действий.

    - Откройте контекстное меню для элемента управления **CheckBoxList** , выберите **Копировать**, откройте контекстное меню для первой строки в конструкторе и выберите **Вставить**.

    - Перетащите элемент управления **CheckBoxList** из **области элементов** и соедините элемент управления с первой строкой в конструкторе.

4. Повторите предыдущий шаг, но переместите кнопку на следующую строку конструктора.

5. В конструкторе нажмите кнопку **Button1** .

6. В строке меню выберите **вид**  >  **окно свойств**.

     Откроется окно **Свойства**.

7. В свойстве **Text** кнопки введите **Update**.

## <a name="handling-the-events-of-controls-on-the-web-part"></a>Обработка событий элементов управления в веб-части

Добавьте код, позволяющий пользователю добавлять календари в представление главного календаря.

1. Выполните одно из следующих действий.

   - В конструкторе дважды щелкните кнопку **Обновить** .

   - В окне **Свойства** кнопки **Обновить** нажмите кнопку **события** . В свойстве **Click** введите **Button1_Click**, а затем нажмите клавишу ВВОД.

     В редакторе кода откроется файл кода пользовательского элемента управления, и `Button1_Click` появится обработчик событий. Позже вы добавите код в этот обработчик событий.

2. Добавьте следующие инструкции в начало файла кода пользовательского элемента управления.

     :::code language="vb" source="../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb" id="Snippet1":::
     :::code language="csharp" source="../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs" id="Snippet1":::

3. Добавьте следующую строку кода в `VisualWebPart1` класс. Этот код объявляет месячный элемент управления представления календаря.

     :::code language="vb" source="../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb" id="Snippet2":::
     :::code language="csharp" source="../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs" id="Snippet2":::

4. Замените `Page_Load` метод `VisualWebPart1` класса следующим кодом. Этот код выполняет следующие задачи:

   - Добавляет месячное представление календаря в пользовательский элемент управления.

   - Добавляет флажок для каждого списка календарей на сайте.

   - Задает шаблон для каждого типа элементов, отображаемых в представлении календаря.

     :::code language="vb" source="../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb" id="Snippet3":::
     :::code language="csharp" source="../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs" id="Snippet3":::

5. Замените `Button1_Click` метод `VisualWebPart1` класса следующим кодом. Этот код добавляет элементы из каждого выбранного календаря в представление главного календаря.

     :::code language="vb" source="../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb" id="Snippet4":::
     :::code language="csharp" source="../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs" id="Snippet4":::

## <a name="test-the-web-part"></a>Тестирование веб-части

При запуске проекта открывается сайт SharePoint. Веб-часть автоматически добавляется в галерею веб-частей в SharePoint. Для тестирования этого проекта необходимо выполнить следующие задачи:

- Добавьте событие в каждый из двух отдельных списков календарей.
- Добавьте веб-часть на страницу веб-части.
- Укажите списки для включения в представление месячного календаря.

### <a name="to-add-events-to-calendar-lists-on-the-site"></a>Добавление событий в списки календарей на сайте

1. В Visual Studio нажмите клавишу **F5** .

     Откроется сайт SharePoint, и [!INCLUDE[wss_14_long](../sharepoint/includes/wss-14-long-md.md)] на странице появится панель быстрого запуска.

2. На панели быстрого запуска в разделе **списки** выберите ссылку **Календарь** .

     Откроется страница **календаря** .

     Если на панели быстрого запуска отображается ссылка на календарь, выберите ссылку **содержимое сайта** . Если на странице содержимое сайта не отображается элемент **календаря** , создайте его.

3. На странице календарь выберите день, а затем щелкните ссылку **Добавить** в выбранный день, чтобы добавить событие.

4. В поле **название** введите **событие в календаре по умолчанию**, а затем нажмите кнопку **сохранить** .

5. Выберите ссылку на **содержимое сайта** , а затем щелкните плитку **Добавить приложение** .

6. На странице **Создание** выберите тип **календаря** , присвойте ему имя, а затем нажмите кнопку **создать** .

7. Добавьте событие в новый календарь, назовите **событие события в пользовательском календаре**, а затем нажмите кнопку **сохранить** .

### <a name="to-add-the-web-part-to-a-web-part-page"></a>Добавление веб-части на страницу «веб-часть»

1. На странице **содержимое сайта** откройте папку **страницы сайта** .

2. На ленте выберите вкладку **файлы** , откройте меню **создать документ** и выберите команду **страница веб-части** .

3. На странице **Новая страница веб-части** назовите страницу **самплевебпартпаже. aspx**, а затем нажмите кнопку **создать** .

     Откроется страница веб-части.

4. В верхней зоне страницы веб-части перейдите на вкладку **Вставка** и нажмите кнопку **веб-часть** .

5. Выберите **пользовательскую** папку, веб-часть **VisualWebPart1** , а затем нажмите кнопку **добавить** .

     Веб-часть появится на странице. В веб-части отображаются следующие элементы управления:

    - Месячное представление календаря.

    - Кнопка **обновления** .

    - Флажок **календаря** .

    - **Настраиваемый календарь** .

### <a name="to-specify-lists-to-include-in-the-monthly-calendar-view"></a>Указание списков для включения в представление месячного календаря

В веб-части укажите календари, которые необходимо включить в представление месячного календаря, а затем нажмите кнопку **Обновить** .

События из всех указанных календарей отображаются в месячном представлении календаря.

## <a name="see-also"></a>См. также раздел

[Создание веб-частей для SharePoint](../sharepoint/creating-web-parts-for-sharepoint.md) 
 [Как создать веб-часть SharePoint](../sharepoint/how-to-create-a-sharepoint-web-part.md) 
 [Пошаговое руководство. Создание веб-части для SharePoint](../sharepoint/walkthrough-creating-a-web-part-for-sharepoint.md)
