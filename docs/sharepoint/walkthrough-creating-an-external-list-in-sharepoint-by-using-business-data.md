---
title: Создание внешнего списка в SharePoint с помощью бизнес-данных
description: Создайте модель для службы BDC, которая возвращает сведения о контактах в бизнес-базе данных, а затем создает внешний список в SharePoint, используя эту модель.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- Business Data Connectivity service [SharePoint development in Visual Studio], business data in a Web Part
- BDC [SharePoint development in Visual Studio], external list
- Business Data Connectivity service [SharePoint development in Visual Studio], business data in a SharePoint list
- BDC [SharePoint development in Visual Studio], business data in a SharePoint list
- BDC [SharePoint development in Visual Studio], business data in a Web Part
- BDC [SharePoint development in Visual Studio], entity backed list
- Business Data Connectivity service [SharePoint development in Visual Studio], entity backed list
- Business Data Connectivity service [SharePoint development in Visual Studio], external list
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 0811b029bf7e4705bc0c3689eff73f38280c3b3d
ms.sourcegitcommit: 80fc9a72e9a1aba2d417dbfee997fab013fc36ac
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2021
ms.locfileid: "106217688"
---
# <a name="walkthrough-create-an-external-list-in-sharepoint-by-using-business-data"></a>Пошаговое руководство. Создание внешнего списка в SharePoint с помощью бизнес-данных

Служба подключения к бизнес-данным (BDC) позволяет SharePoint отображать бизнес-данные из приложений серверной части, веб-служб и баз данных.

В этом пошаговом руководстве показано, как создать модель для службы BDC, которая возвращает сведения о контактах в образце базы данных. Затем вы создадите внешний список в SharePoint с помощью этой модели.

В этом пошаговом руководстве описаны следующие задачи:

- Создание проекта.
- Добавление сущности в модель.
- Добавление метода Finder.
- Добавление конкретного метода поиска.
- Тестирование проекта.

## <a name="prerequisites"></a>Предварительные требования

Для выполнения этого пошагового руководства требуются следующие компоненты:

- Поддерживаемые выпуски Windows и SharePoint.

- Доступ к образцу базы данных AdventureWorks. Дополнительные сведения об установке базы данных AdventureWorks см. в разделе [SQL Server образцы баз данных](https://github.com/Microsoft/sql-server-samples/releases/tag/adventureworks).

## <a name="create-a-project-that-contains-a-bdc-model"></a>Создание проекта, содержащего модель BDC

1. В строке меню Visual Studio выберите **файл**  >  **создать**  >  **проект**.

     Откроется диалоговое окно **Новый проект** .

2. В **Visual C#** или **Visual Basic** разверните узел **SharePoint** , а затем выберите элемент **2010** .

3. В области **шаблоны** выберите **проект SharePoint 2010**, присвойте проекту имя **адвентуреворкстест**, а затем нажмите кнопку **ОК** .

     Откроется **Мастер настройки SharePoint** . В этом мастере можно указать сайт, который будет использоваться для отладки проекта, и задать уровень доверия для решения.

4. Выберите параметр **Развернуть как решение фермы** , чтобы задать уровень доверия.

5. Нажмите кнопку **Готово** , чтобы принять локальный сайт SharePoint по умолчанию.

6. В **Обозреватель решений** выберите узел проекта SharePoint.

7. В строке меню выберите **Проект** > **Добавить новый элемент**.

     Откроется диалоговое окно **Добавление нового элемента**.

8. В области **шаблоны** выберите **модель подключения к бизнес-данным (только для решения фермы)**, присвойте проекту имя **адвентуреворксконтактс**, а затем нажмите кнопку **Добавить** .

## <a name="add-data-access-classes-to-the-project"></a>Добавление классов доступа к данным в проект

1. В строке меню выберите **Сервис**  >  **подключиться к базе данных**.

     Откроется диалоговое окно **Добавление соединения**.

2. Добавьте соединение с образцом базы данных AdventureWorks SQL Server.

     Дополнительные сведения см. в разделе [Добавление и изменение подключения (Microsoft SQL Server)](/previous-versions/dxb6fxah(v=vs.140)).

3. В области **Обозреватель решений** выберите узел проекта.

4. В строке меню выберите **Проект** > **Добавить новый элемент**.

5. В области **Установленные шаблоны** выберите узел **данные** .

6. В области **шаблоны** выберите **LINQ to SQL классы**.

7. В поле **имя** укажите **AdventureWorks**, а затем нажмите кнопку **добавить** .

     В проект будет добавлен файл .dbml, и откроется реляционный конструктор объектов.

8. В строке меню выберите **Просмотреть**  >  **Обозреватель сервера**.

9. В **Обозреватель сервера** разверните узел, представляющий образец базы данных AdventureWorks, а затем узел **таблицы** .

10. Добавьте таблицу **контактов (Person)** в реляционный конструктор O/R.

     Создается класс сущностей и появляется в области конструктора. Класс сущности имеет свойства, сопоставленные со столбцами в таблице Contact (Person).

## <a name="remove-the-default-entity-from-the-bdc-model"></a>Удаление сущности по умолчанию из модели BDC

Проект **модели подключения к бизнес-данным** добавляет в модель сущность по умолчанию с именем Entity1. Удалите эту сущность. Позже вы добавите новую сущность. Начиная с пустой модели, сокращается количество шагов, необходимых для выполнения этого пошагового руководства.

1. В **Обозреватель решений** разверните узел **BdcModel1** , а затем откройте файл *BdcModel1. бдкм* .

2. В конструкторе BDC откроется файл модели подключения к бизнес-данным.

3. В конструкторе откройте контекстное меню для **сущности Entity1** и выберите команду **Удалить**.

4. В **Обозреватель решений** откройте контекстное меню для *сущности Entity1. vb* (в Visual Basic) или *сущности Entity1. CS* (в C#), а затем выберите **Удалить**.

5. Откройте контекстное меню для *Entity1Service. vb* (в Visual Basic) или *Entity1Service. CS* (в C#), а затем выберите **Удалить**.

## <a name="add-an-entity-to-the-model"></a>Добавление сущности в модель

Добавьте сущность в модель. Вы можете добавлять сущности из **панели элементов** Visual Studio в конструктор BDC.

1. В строке меню выберите **вид**  >  **панель элементов**.

2. На вкладке **BusinessDataConnectivity** в **области элементов** добавьте **сущность** в конструктор BDC.

     Новая сущность появится в конструкторе. Visual Studio добавляет файл с именем *ентитисервице. vb* (в Visual Basic) или *ентитисервице. CS* (в C#) в проект.

3. В строке меню выберите **вид**  >    >  **окно** свойств.

4. В окне **Свойства** задайте для свойства **имя** значение **Contact**.

5. В конструкторе откройте контекстное меню сущности, выберите **Добавить**, а затем выберите **идентификатор**.

     В сущности появится новый идентификатор.

6. В окне **Свойства** измените имя идентификатора на **ContactID**.

7. В списке **имя типа** выберите **System. Int32**.

## <a name="add-a-specific-finder-method"></a>Добавление конкретного метода поиска

Чтобы включить отображение определенного контакта в службе BDC, необходимо добавить конкретный метод поиска. Служба BDC вызывает конкретный метод поиска, когда пользователь выбирает элемент в списке, а затем выбирает кнопку **Просмотр элемента** на ленте.

Добавьте конкретный метод поиска в сущность Contact с помощью окна **сведения о методе BDC** . Чтобы вернуть определенную сущность, добавьте в метод код.

1. В конструкторе BDC выберите сущность **контакт** .

2. В строке меню выберите **Просмотреть**  >  **другие**  >  **сведения о методе BDC** Windows.

     Откроется окно сведения о методе BDC.

3. В списке **Добавить метод** выберите **создать конкретный метод поиска**.

     Visual Studio добавляет в модель следующие элементы. Эти элементы отображаются в окне **сведения о методе BDC** .

    - Метод с именем ReadItem.

    - Входной параметр для метода.

    - Возвращаемый параметр для метода.

    - Дескриптор типа для каждого параметра.

    - Экземпляр метода для метода.

4. В окне **сведения о методе BDC** откройте список, который отображается для дескриптора типа **контакта** , и выберите **изменить**.

     Откроется **Обозреватель BDC** , в котором будет представлено иерархическое представление модели.

5. В окне **Свойства** откройте список рядом со свойством **TypeName** , перейдите на вкладку **текущий проект** и выберите свойство **Contact** .

6. В **обозревателе BDC** откройте контекстное меню **контакта** и выберите **Добавить дескриптор типа**.

     В **обозревателе BDC** появится новый дескриптор типа с именем **TypeDescriptor1** .

7. В окне **Свойства** задайте для свойства **имя** значение **ContactID**.

8. Откройте список рядом со свойством **TypeName** , а затем выберите **Int32**.

9. Откройте список рядом со свойством **идентификатор** , а затем выберите **ContactID**.

10. Повторите шаг 6, чтобы создать дескриптор типа для каждого из следующих полей.

    |Имя|Имя типа|
    |----------|---------------|
    |FirstName|System.String|
    |LastName|System.String|
    |Телефон|System.String|
    |EmailAddress|System.String|
    |EmailPromotion|System.Int32|
    |NameStyle|System.Boolean|
    |PasswordHash|System.String|
    |PasswordSalt|System.String|

11. В конструкторе BDC в сущности **Contact** откройте метод **ReadItem** .

     Файл с кодом службы Contact откроется в редакторе кода.

12. В `ContactService` классе замените `ReadItem` метод следующим кодом. Этот код выполняет следующие задачи:

    - Извлекает запись из таблицы Contact базы данных AdventureWorks.

    - Возвращает сущность Contact для службы BDC.

    > [!NOTE]
    > Замените значение `ServerName` поля именем сервера.

     :::code language="csharp" source="../sharepoint/codesnippet/CSharp/SP_BDC/bdcmodel1/contactservice.cs" id="Snippet3":::
     :::code language="vb" source="../sharepoint/codesnippet/VisualBasic/sp_bdc/bdcmodel1/contactservice.vb" id="Snippet3":::

## <a name="add-a-finder-method"></a>Добавление метода поиска

Чтобы служба BDC отображала контакты в списке, необходимо добавить метод поиска. Добавьте метод Finder в сущность Contact с помощью окна **сведения о методе BDC** . Чтобы вернуть коллекцию сущностей в службу BDC, добавьте в метод код.

1. В конструкторе BDC выберите сущность **Contact** .

2. В окне **сведения о методе BDC** сверните узел **ReadItem** .

3. В списке **Добавить метод** в методе **ReadList** выберите **создать метод поиска**.

     Visual Studio добавляет метод, возвращаемый параметр и дескриптор типа.

4. В конструкторе BDC в сущности **Contact** откройте метод **ReadList** .

     В редакторе кода откроется файл кода службы контактов.

5. В `ContactService` классе замените `ReadList` метод следующим кодом. Этот код выполняет следующие задачи:

   - Извлекает данные из таблицы Contacts базы данных AdventureWorks.

   - Возвращает список сущностей Contact для службы BDC.

     > [!NOTE]
     > Замените значение `ServerName` поля именем сервера.

     :::code language="csharp" source="../sharepoint/codesnippet/CSharp/SP_BDC/bdcmodel1/contactservice.cs" id="Snippet2":::
     :::code language="vb" source="../sharepoint/codesnippet/VisualBasic/sp_bdc/bdcmodel1/contactservice.vb" id="Snippet2":::

## <a name="test-the-project"></a>Тестирование проекта

При запуске проекта открывается сайт SharePoint, и Visual Studio добавляет модель в службу подключения к бизнес-данным. Создайте внешний список в SharePoint, который ссылается на сущность Contact. Данные для контактов в базе данных AdventureWorks появятся в списке.

> [!NOTE]
> Прежде чем выполнять отладку решения, может потребоваться изменить параметры безопасности в SharePoint. Дополнительные сведения см. в разделе [Проектирование модели подключения к бизнес-данным](../sharepoint/designing-a-business-data-connectivity-model.md).

1. Нажмите клавишу **F5**.

     Откроется сайт SharePoint.

2. В меню **действия сайта** выберите команду **Дополнительные параметры** .

3. На странице **Создание** выберите шаблон **внешний список** , а затем нажмите кнопку **создать** .

4. Присвойте настраиваемому списку имя **Contacts**.

5. Нажмите кнопку Обзор рядом с полем **внешний тип содержимого** .

6. В диалоговом окне **Выбор внешнего типа содержимого** выберите элемент **адвентуреворксконтактс. BdcModel1. Contact** , а затем нажмите кнопку **создать** .

     SharePoint создает внешний список, содержащий контакты из базы данных AdventureWorks.

7. Чтобы протестировать конкретный метод поиска, выберите контакт в списке.

8. На ленте перейдите на вкладку **элементы** и выберите команду **Просмотреть элемент** .

     В форме отобразятся подробности выбранного контакта.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о проектировании моделей для службы BDC в SharePoint см. в следующих статьях:

- [Как добавить метод Creator](../sharepoint/how-to-add-a-creator-method.md).
- [Как добавить метод обновления](../sharepoint/how-to-add-an-updater-method.md).
- [Как добавить метод удаления](../sharepoint/how-to-add-a-deleter-method.md).

## <a name="see-also"></a>См. также раздел

[Проектирование модели](../sharepoint/designing-a-business-data-connectivity-model.md) 
 подключения к бизнес-данным [Создание модели](../sharepoint/creating-a-business-data-connectivity-model.md) 
 подключения к бизнес-данным Обзор средств проектирования [моделей BDC](../sharepoint/bdc-model-design-tools-overview.md) 
 [Интеграция бизнес-данных в SharePoint](../sharepoint/integrating-business-data-into-sharepoint.md)