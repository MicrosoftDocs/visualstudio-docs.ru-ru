---
title: Пошаговое руководство. расширение типа элемента проекта SharePoint | Документация Майкрософт
description: В этом пошаговом руководстве создается расширение для типа элемента проекта SharePoint, например элемент проекта модели подключения к бизнес-данным (BDC).
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- project items [SharePoint development in Visual Studio], extending
- SharePoint project items, extending
- SharePoint development in Visual Studio, extending project items
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 74d57ae4beca074fbf7711ea3d732d903d8faa4b
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99952685"
---
# <a name="walkthrough-extend-a-sharepoint-project-item-type"></a>Пошаговое руководство. расширение типа элемента проекта SharePoint
  Элемент проекта **модели подключения к бизнес-данным** можно использовать для создания модели для службы подключения к бизнес-данным (BDC) в SharePoint. По умолчанию при создании модели с помощью этого элемента проекта данные в модели не отображаются для пользователей. Кроме того, необходимо создать внешний список в SharePoint, чтобы позволить пользователям просматривать данные.

 В этом пошаговом руководстве вы создадите расширение для элемента проекта **модели подключения к бизнес-данным** . Разработчики могут использовать расширение для создания внешнего списка в своем проекте, который отображает данные в модели BDC. В этом пошаговом руководстве описаны следующие задачи.

- Создание расширения Visual Studio, которое выполняет две основные задачи:

  - Он создает внешний список, отображающий данные в модели BDC. Расширение использует объектную модель для системы проектов SharePoint для создания файла *Elements.xml* , определяющего список. Он также добавляет файл в проект, чтобы он был развернут вместе с моделью BDC.

  - Он добавляет пункт контекстного меню в элементы проекта **модели подключения к бизнес-данным** в **Обозреватель решений**. Разработчики могут щелкнуть этот пункт меню, чтобы создать внешний список для модели BDC.

- Создание пакета расширения Visual Studio (VSIX) для развертывания сборки расширения.

- Тестирование расширения.

## <a name="prerequisites"></a>Предварительные требования
 Для выполнения этого пошагового руководства на компьютере разработчика потребуются следующие компоненты:

- Поддерживаемые выпуски Microsoft Windows, SharePoint и Visual Studio.

- [!include[vssdk_current_long](../sharepoint/includes/vssdk-current-long-md.md)]. В этом пошаговом руководстве используется шаблон **проекта VSIX** в пакете SDK для создания пакета VSIX для развертывания элемента проекта. Дополнительные сведения см. [в разделе Расширение инструментов SharePoint в Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md).

  Знания следующих концепций полезны, но не требуются для выполнения этого пошагового руководства.

- Служба BDC в [!INCLUDE[moss_14_long](../sharepoint/includes/moss-14-long-md.md)] . Дополнительные сведения см. в статье [архитектура BDC](/previous-versions/office/developer/sharepoint-2010/ee558876(v=office.14)).

- Схема XML для моделей BDC. Дополнительные сведения см. в статье [инфраструктура модели BDC](/previous-versions/office/developer/sharepoint-2010/ee556378(v=office.14)).

## <a name="create-the-projects"></a>Создание проектов
 Для выполнения этого пошагового руководства необходимо создать два проекта:

- Проект VSIX для создания пакета VSIX для развертывания расширения элемента проекта.

- Проект библиотеки классов, реализующий расширение элемента проекта.

  Начните пошаговое руководство, создав проекты.

#### <a name="to-create-the-vsix-project"></a>Создание проекта VSIX

1. Запустите среду [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].

2. В строке меню выберите **Файл** > **Создать** > **Проект**.

3. В диалоговом окне **Новый проект** разверните узлы **Visual C#** или **Visual Basic** , а затем выберите узел **расширяемость** .

    > [!NOTE]
    > Узел **расширяемости** доступен только при установке пакета SDK для Visual Studio. Дополнительные сведения см. в разделе Предварительные требования ранее в этом разделе.

4. В списке в верхней части диалогового окна **Новый проект** выберите **платформа .NET Framework 4,5**.

     Для расширений инструментов SharePoint требуются функции в этой версии платформа .NET Framework.

5. Выберите шаблон **проекта VSIX** .

6. В поле **имя** введите **женератикстерналдаталистс**, а затем нажмите кнопку **ОК** .

     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Добавляет проект **женератикстерналдаталистс** в **Обозреватель решений**.

7. Если файл Source. extension. vsixmanifest не открывается автоматически, откройте его контекстное меню в проекте Женератикстерналдаталистс и выберите **Открыть** .

8. Убедитесь, что файл Source. extension. vsixmanifest имеет непустую запись (введите contoso) в поле Author (автор), сохраните файл и закройте его.

#### <a name="to-create-the-extension-project"></a>Создание проекта расширения

1. В **Обозреватель решений** откройте контекстное меню узла решения **Женератикстерналдаталистс** , выберите **Добавить**, а затем выберите **Новый проект**.

2. В диалоговом окне **Добавление нового проекта** разверните узлы **Visual C#** или **Visual Basic** , а затем выберите узел **Windows** .

3. В списке в верхней части диалогового окна выберите **платформа .NET Framework 4,5**.

4. В списке шаблонов проектов выберите **Библиотека классов**.

5. В поле **имя** введите **бдкпрожектитемекстенсион**, а затем нажмите кнопку **ОК** .

     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Добавляет проект **бдкпрожектитемекстенсион** в решение и открывает файл кода Class1 по умолчанию.

6. Удалите файл кода Class1 из проекта.

## <a name="configure-the-extension-project"></a>Настройка проекта расширения
 Перед написанием кода для создания расширения элемента проекта добавьте файлы кода и ссылки на сборки в проект расширения.

#### <a name="to-configure-the-project"></a>Настройка проекта

1. В проекте Бдкпрожектитемекстенсион добавьте два файла кода со следующими именами:

    - прожектитемекстенсион

    - женератикстерналдаталистс

2. Выберите проект бдкпрожектитемекстенсион, а затем в строке меню выберите **проект**  >  **Добавить ссылку**.

3. В узле **сборки** выберите узел **платформа** и установите флажок для каждой из следующих сборок:

    - System.ComponentModel.Composition

    - WindowsBase

4. В узле **сборки** выберите узел **расширения** , а затем установите флажок для следующей сборки:

    - Microsoft. VisualStudio. SharePoint

5. Нажмите кнопку **ОК** .

## <a name="define-the-project-item-extension"></a>Определение расширения элемента проекта
 Создайте класс, определяющий расширение для элемента проекта **модели подключения к бизнес-данным** . Чтобы определить расширение, класс реализует <xref:Microsoft.VisualStudio.SharePoint.ISharePointProjectItemTypeExtension> интерфейс. Реализуйте этот интерфейс всякий раз, когда требуется расширить существующий тип элемента проекта.

#### <a name="to-define-the-project-item-extension"></a>Определение расширения элемента проекта

1. Вставьте следующий код в файл кода Прожектитемекстенсион.

    > [!NOTE]
    > После добавления этого кода в проекте будут обнаружены ошибки компиляции. Эти ошибки исчезнут при добавлении кода в последующих шагах.

     [!code-csharp[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#1](../sharepoint/codesnippet/CSharp/generateexternaldatalists/bdcprojectitemextension/projectitemextension.cs#1)]
     [!code-vb[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#1](../sharepoint/codesnippet/VisualBasic/generateexternaldatalists/bdcprojectitemextension/projectitemextension.vb#1)]

## <a name="create-the-external-data-lists"></a>Создание списков внешних данных
 Добавьте частичное определение `GenerateExternalDataListsExtension` класса, который создает внешний список данных для каждой сущности в модели BDC. Чтобы создать список внешних данных, этот код сначала считывает данные сущности в модели BDC, анализируя XML-данные в файле модели BDC. Затем он создает экземпляр списка, основанный на модели BDC, и добавляет этот экземпляр списка в проект.

#### <a name="to-create-the-external-data-lists"></a>Создание списков внешних данных

1. Вставьте следующий код в файл кода Женератикстерналдаталистс.

     [!code-vb[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#2](../sharepoint/codesnippet/VisualBasic/generateexternaldatalists/bdcprojectitemextension/generateexternaldatalists.vb#2)]
     [!code-csharp[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#2](../sharepoint/codesnippet/CSharp/generateexternaldatalists/bdcprojectitemextension/generateexternaldatalists.cs#2)]

## <a name="checkpoint"></a>Контрольная точка
 На этом этапе в этом пошаговом руководстве весь код для расширения элемента проекта теперь находится в проекте. Выполните сборку решения, чтобы убедиться, что проект компилируется без ошибок.

#### <a name="to-build-the-solution"></a>Построение решения

1. В строке меню последовательно выберите **Сборка** > **Собрать решение**.

## <a name="create-a-vsix-package-to-deploy-the-project-item-extension"></a>Создание пакета VSIX для развертывания расширения элемента проекта
 Чтобы развернуть расширение, используйте проект VSIX в решении для создания пакета VSIX. Сначала настройте пакет VSIX, изменив файл Source. extension. vsixmanifest, который включен в проект VSIX. Затем создайте пакет VSIX, создав решение.

#### <a name="to-configure-and-create-the-vsix-package"></a>Настройка и создание пакета VSIX

1. В **Обозреватель решений** откройте контекстное меню для файла Source. extension. vsixmanifest в проекте женератикстерналдаталистс, а затем выберите **Открыть**.

     Visual Studio откроет файл в редакторе манифестов. Файл Source. extension. vsixmanifest является основанием для файла Extension. vsixmanifest, который является обязательным для всех пакетов VSIX. Дополнительные сведения об этом файле см. в разделе [Справочник по схеме расширения VSIX 1,0](/previous-versions/dd393700(v=vs.110)).

2. В поле **Название продукта** введите " **генератор внешнего списка данных**".

3. В поле **Author (автор** ) введите **contoso**.

4. В поле **Описание** введите **расширение для элементов проекта модели подключения к бизнес-данным, которое можно использовать для создания внешних списков данных**.

5. На вкладке **ресурсы** редактора нажмите кнопку **создать** .

     Откроется диалоговое окно **Добавление нового ресурса** .

6. В списке **тип** выберите **Microsoft. VisualStudio. MefComponent**.

    > [!NOTE]
    > Это значение соответствует `MefComponent` элементу в файле Extension. vsixmanifest. Этот элемент задает имя сборки расширения в пакете VSIX. Дополнительные сведения см. в разделе [элемент MEFComponent (Схема VSX)](/previous-versions/visualstudio/visual-studio-2010/dd393736\(v\=vs.100\)).

7. В списке **источник** выберите **проект в текущем решении**.

8. В списке **проект** выберите **бдкпрожектитемекстенсион**, а затем нажмите кнопку **ОК** .

9. В строке меню последовательно выберите **Сборка** > **Собрать решение**.

10. Убедитесь, что проект компилируется и сборка выполняется без ошибок.

11. Убедитесь, что папка выходных данных сборки для проекта Женератикстерналдаталистс теперь содержит файл Женератикстерналдаталистс. VSIX.

     По умолчанию выходной папкой сборки является.. \bin\Debug в папке, содержащей файл проекта.

## <a name="test-the-project-item-extension"></a>Тестирование расширения элемента проекта
 Теперь все готово для тестирования расширения элемента проекта. Сначала начните отладку проекта расширения в экспериментальном экземпляре Visual Studio. Затем используйте расширение в экспериментальном экземпляре Visual Studio, чтобы создать внешний список для модели BDC. Наконец, откройте внешний список на сайте SharePoint, чтобы убедиться, что он работает правильно.

#### <a name="to-start-debugging-the-extension"></a>Запуск отладки расширения

1. При необходимости перезапустите Visual Studio с учетными данными администратора, а затем откройте решение Женератикстерналдаталистс.

2. В проекте Бдкпрожектитемекстенсион откройте файл кода Прожектитемекстенсион, а затем добавьте точку останова в строку кода в `Initialize` методе.

3. Откройте файл кода Женератикстерналдаталистс, а затем добавьте точку останова в первую строку кода в `GenerateExternalDataLists_Execute` методе.

4. Запустите отладку, нажав клавишу **F5** , или в строке меню выберите **Отладка**  >  **начать отладку**.

     Visual Studio устанавливает расширение в%UserProfile%\AppData\Local\Microsoft\VisualStudio\10.0Exp\Extensions\Contoso\External Data List Generator\1.0 и запускает экспериментальный экземпляр Visual Studio. Вы проверите элемент проекта в этом экземпляре Visual Studio.

#### <a name="to-test-the-extension"></a>Тестирование расширения

1. В экспериментальном экземпляре Visual Studio в строке меню выберите **файл**  >  **создать**  >  **проект**.

2. В диалоговом окне **Новый проект** разверните узел **шаблоны** , разверните узел **Visual C#** , разверните узел **SharePoint** и выберите **2010**.

3. В списке в верхней части диалогового окна установите флажок **платформа .NET Framework 3,5** . Для проектов [!INCLUDE[moss_14_long](../sharepoint/includes/moss-14-long-md.md)] требуется эта версия платформа .NET Framework.

4. В списке шаблонов проектов выберите **проект SharePoint 2010**.

5. В поле **имя** введите **шарепоинтпрожекттестбдк**, а затем нажмите кнопку **ОК** .

6. В мастере настройки SharePoint введите URL-адрес сайта, который вы хотите использовать для отладки, выберите **Развернуть как решение фермы**, а затем нажмите кнопку **Готово** .

7. Откройте контекстное меню проекта Шарепоинтпрожекттестбдк, выберите **Добавить**, а затем выберите **новый элемент**.

8. В диалоговом окне **Добавление NewItem-шарепоинтпрожекттестбдк** разверните узел установленный язык, разверните узел **SharePoint** .

9. Выберите узел **2010** и выберите шаблон **модель подключения к бизнес-данным (только для решения фермы)** .

10. В поле **имя** введите **тестбдкмодел**, а затем нажмите кнопку **добавить** .

11. Убедитесь, что код в другом экземпляре Visual Studio остановлен в точке останова, заданной в `Initialize` методе файла кода прожектитемекстенсион.

12. В остановленном экземпляре Visual Studio нажмите клавишу **F5** или в строке меню выберите **Отладка**  >  **продолжить** , чтобы продолжить отладку проекта.

13. В экспериментальном экземпляре Visual Studio нажмите клавишу **F5** или в строке меню выберите **Отладка**  >  **начать отладку** , чтобы выполнить сборку, развертывание и запуск проекта **тестбдкмодел** .

     Откроется веб-браузер со страницей сайта SharePoint по умолчанию, указанной для отладки.

14. Убедитесь, что в разделе " **списки** " в области быстрого запуска еще нет списка, основанного на модели BDC по умолчанию в проекте. Сначала необходимо создать список внешних данных либо с помощью пользовательского интерфейса SharePoint, либо с помощью расширения элемента проекта.

15. Закройте веб-браузер.

16. В экземпляре Visual Studio, в котором открыт проект Тестбдкмодел, откройте контекстное меню узла **тестбдкмодел** в **Обозреватель решений**, а затем выберите **создать список внешних данных**.

17. Убедитесь, что код в другом экземпляре Visual Studio остановлен в точке останова, заданной в `GenerateExternalDataLists_Execute` методе. Нажмите клавишу **F5** или в строке меню выберите **Отладка**  >  **продолжить** , чтобы продолжить отладку проекта.

18. Экспериментальный экземпляр Visual Studio добавляет экземпляр списка с именем **Entity1DataList** в проект тестбдкмодел, а экземпляр также создает функцию с именем **Feature2** для экземпляра списка.

19. Нажмите клавишу **F5** или в строке меню выберите **Отладка**  >  **начать отладку** , чтобы выполнить сборку, развертывание и запуск проекта тестбдкмодел.

     Откроется веб-браузер со страницей сайта SharePoint по умолчанию, используемой для отладки.

20. В разделе **списки** области Быстрый запуск выберите список **Entity1DataList** .

21. Убедитесь, что список содержит столбцы с именами Идентификатор1 и Message, а также один элемент со значением Идентификатор1, равным 0, и значением сообщения Hello World.

     Шаблон проекта **модели подключения к бизнес-данным** создает модель BDC по умолчанию, которая предоставляет все эти данные.

22. Закройте веб-браузер.

## <a name="clean-up-the-development-computer"></a>Очистка компьютера разработчика
 После завершения тестирования расширения элемента проекта удалите внешний список и модель BDC с сайта SharePoint и удалите расширение элемента проекта из Visual Studio.

#### <a name="to-remove-the-external-data-list-from-the-sharepoint-site"></a>Удаление списка внешних данных с сайта SharePoint

1. В области Быстрый запуск сайта SharePoint выберите список **Entity1DataList** .

2. На ленте на сайте SharePoint перейдите на вкладку **список** .

3. На вкладке **список** в группе **Параметры** выберите **Параметры списка**.

4. В разделе **разрешения и управление** выберите **удалить этот список** и нажмите кнопку **ОК** , чтобы подтвердить, что вы хотите отправить список в корзину.

5. Закройте веб-браузер.

#### <a name="to-remove-the-bdc-model-from-the-sharepoint-site"></a>Удаление модели BDC с сайта SharePoint

1. В экспериментальном экземпляре Visual Studio в строке меню выберите **Сборка**  >  **отозвать**.

     Visual Studio удаляет модель BDC с сайта SharePoint.

#### <a name="to-remove-the-project-item-extension-from-visual-studio"></a>Удаление расширения элемента проекта из Visual Studio

1. В экспериментальном экземпляре Visual Studio в строке меню выберите **инструменты**  >  **расширения и обновления**.

     Появится диалоговое окно **Расширения и обновления**.

2. В списке расширений выберите **внешний генератор списка данных**, а затем нажмите кнопку **Удалить** .

3. В появившемся диалоговом окне выберите **Да** , чтобы подтвердить удаление расширения.

4. Выберите **Перезагрузить сейчас** , чтобы завершить удаление.

5. Закройте оба экземпляра Visual Studio (экспериментальный экземпляр и экземпляр, в котором открыто решение Женератикстерналдаталистс).

## <a name="see-also"></a>См. также раздел
- [Расширение системы проектов SharePoint](../sharepoint/extending-the-sharepoint-project-system.md)
- [Создание модели подключения к бизнес-данным](../sharepoint/creating-a-business-data-connectivity-model.md)
- [Проектирование модели подключения к бизнес-данным](../sharepoint/designing-a-business-data-connectivity-model.md)