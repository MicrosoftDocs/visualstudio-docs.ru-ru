---
title: Условия MSBuild | Документы Майкрософт
description: Сведения о поддержке в MSBuild определенного набора условий, которые можно применять везде, где разрешен атрибут Condition.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: reference
dev_langs:
- VB
- CSharp
- C++
- jsharp
helpviewer_keywords:
- MSBuild, conditions
- conditions [MSBuild]
- Exists, MSBuild condition function
- HasTrailingSlash, MSBuild condition function
ms.assetid: 9d7aa308-b667-48ed-b4c9-a61e49eb0a85
author: ghogen
ms.author: ghogen
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: d72b69b2c80c4e20b5a4dadae18764a138210295
ms.sourcegitcommit: 8b75524dc544e34d09ef428c3ebbc9b09f14982d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2021
ms.locfileid: "113222712"
---
# <a name="msbuild-conditions"></a>Условия MSBuild

MSBuild поддерживает определенный набор условий, которые можно применять везде, где разрешен атрибут `Condition`. В следующей таблице описаны эти условия.

|Условие|Описание|
|---------------|-----------------|
|'`stringA`' == '`stringB`'|Принимает значение `true`, если `stringA` равна `stringB`.<br /><br /> Пример:<br /><br /> `Condition="'$(Configuration)'=='DEBUG'"`<br /><br /> Одинарные кавычки можно не применять для простой последовательности букв и цифр или логических значений. Но они необходимы для пустых значений. В этой проверке регистр не учитывается.|
|'`stringA`' != '`stringB`'|Принимает значение `true`, если `stringA` не равна `stringB`.<br /><br /> Пример:<br /><br /> `Condition="'$(Configuration)'!='DEBUG'"`<br /><br /> Одинарные кавычки можно не применять для простой последовательности букв и цифр или логических значений. Но они необходимы для пустых значений. В этой проверке регистр не учитывается.|
|\<, >, \<=, >=|Проверяет числовые значения операндов. Возвращает `true`, если отношение справедливо. Операнды должны быть десятичными или шестнадцатеричными числами или версиями из четырех частей, разделенных точками. Шестнадцатеричные числа должны начинаться с "0x". **Примечание.**  В XML символы `<` и `>` следует записывать в виде escape-последовательностей. Символ `<` представляется в виде `&lt;`. Символ `>` представляется в виде `&gt;`.|
|Exists('`stringA`')|Принимает значение `true`, если файл или папка с именем `stringA` существует.<br /><br /> Пример:<br /><br /> `Condition="!Exists('$(Folder)')"`<br /><br /> Одинарные кавычки можно не применять для простой последовательности букв и цифр или логических значений. Но они необходимы для пустых значений.|
|HasTrailingSlash('`stringA`')|Принимает значение `true`, если указанная строка содержит завершающий символ обратной косой черты (\\) или символ прямой косой черты (/).<br /><br /> Пример:<br /><br /> `Condition="!HasTrailingSlash('$(OutputPath)')"`<br /><br /> Одинарные кавычки можно не применять для простой последовательности букв и цифр или логических значений. Но они необходимы для пустых значений.|
|!|Принимает значение `true`, если операнд имеет значение `false`.|
|`And`|Принимает значение `true`, если оба операнда имеют значение `true`.|
|`Or`|Принимает значение `true`, если по крайней мере один операнд имеет значение `true`.|
|()|Механизм группирования. Результат принимает значение `true`, если выражения, содержащиеся внутри, имеют значение `true`.|
|$if$ (%expression%), $else$, $endif$|Проверяет, равняется ли значение указанного `%expression%` строковому значению переданного параметра пользовательского шаблона. Если результат проверки условия `$if$` принимает значение `true`, его операторы выполняются, в противном случае проверяется условие `$else$`. Если результат проверки условия `$else$` принимает значение `true`, его операторы выполняются, в противном случае условие `$endif$` завершает проверку выражений.<br /><br /> Примеры использования см. в разделе [Логика параметра-шаблона проекта или элемента Visual Studio](https://stackoverflow.com/questions/6709057/visual-studio-project-item-template-parameter-logic).|

Вы можете использовать методы строк в условиях, как показано в следующем примере, где функция [TrimEnd()](/dotnet/api/system.string.trimend) используется для сравнения только релевантной части строки, чтобы можно было различать целевые платформы .NET Framework и .NET Core.

```xml
<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <TargetFrameworks>net45;net48;netstandard2.1;netcoreapp2.1;netcoreapp3.1</TargetFrameworks>
    </PropertyGroup>

    <PropertyGroup Condition="'$(TargetFramework.TrimEnd(`0123456789`))' == 'net'">
        <!-- Properties for .NET Framework -->
    </PropertyGroup>

</Project>
```

В файлах проекта MSBuild отсутствует истинный логический тип. Логические данные представлены в свойствах, которые могут быть пустыми или иметь любое значение. Поэтому `'$(Prop)' == 'true'` означает "если Prop имеет значение `true`", но `'$(Prop)' != 'false'` означает "если Prop имеет значение `true`, не задано или имеет другое значение".

Булева логика оценивается только в контексте условий, поэтому настройки свойств, такие как `<Prop2>'$(Prop1)' == 'true'</Prop>`, представлены в виде строки (после расширения переменной), а не оцениваются в качестве логических значений.  

В MSBuild реализовано несколько правил обработки, которые упрощают работу со свойствами строки, используемыми в качестве логических значений. Логические литералы принимаются, поэтому `Condition="true"` и `Condition="false"` работают надлежащим образом. MSBuild также включает специальные правила для поддержки оператора логического отрицания. Поэтому если `$(Prop)` имеет значение true, `!$(Prop)` расширяется до `!true`, при этом выполняется сравнение с `false`, как и ожидается.

## <a name="comparing-versions"></a>Сравнение версий

Реляционные операторы `<`,`>`, `<=` и `>=` поддерживают версии, проанализированные с помощью <xref:System.Version?displayProperty=fullName>, что позволяют сравнивать версии, состоящие из четырех числовых частей. Например, `'1.2.3.4' < '1.10.0.0'` — это `true`.

> [!CAUTION]
> Сравнения `System.Version` могут выдавать неожиданные результаты, если одна версия или обе не указывают все четыре части. Например, версия 1.1 старше версии 1.1.0.

MSBuild предоставляет [функции свойств для сравнения версий](property-functions.md#msbuild-version-comparison-functions) с различными наборами правил, совместимыми с семантическими версиями (semver).

## <a name="see-also"></a>См. также

- [Справочные сведения о MSBuild](../msbuild/msbuild-reference.md)
- [Условные конструкции](../msbuild/msbuild-conditional-constructs.md)
- [Пошаговое руководство: Создание файла проекта MSBuild с нуля](../msbuild/walkthrough-creating-an-msbuild-project-file-from-scratch.md)
