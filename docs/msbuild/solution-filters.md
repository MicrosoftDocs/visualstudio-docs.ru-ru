---
title: Фильтры решений в MSBuild
description: В этой статье описаны фильтры решений и показано, как создать файл фильтра решений с помощью MSBuild.
ms.date: 07/28/2020
ms.topic: reference
helpviewer_keywords:
- MSBuild, solution filters
- solution filters [MSBuild]
author: ghogen
ms.author: ghogen
manager: jmartens
monikerRange: '>= vs-2019'
ms.openlocfilehash: 4a5c764ad9ea4190df5e533926671dbd88c53b8b
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99937840"
---
# <a name="solution-filters-in-msbuild"></a>Фильтры решений в MSBuild

Файлы фильтров решений — это JSON-файлы с расширением *.slnf*, в которых указано, для каких проектов из всех существующих в решении следует выполнять сборку или загрузку. Начиная с версии 16.7, MSBuild можно вызвать в файле фильтра решений, чтобы выполнить сборку решения с включенной фильтрацией. 

> [!NOTE]
> Файл фильтра решений позволяет уменьшить набор проектов, для которых будет выполняться сборка или загрузка, и упрощает формат. Файл решения по-прежнему является обязательным.

## <a name="build-a-solution-filter-from-the-command-line"></a>Создание фильтра решений из командной строки

Для создания файла фильтра решений из командной строки используется тот же синтаксис, что и для создания файла решения. Вместо решения укажите файл фильтра решений для сборки с включенной фильтрацией, как показано ниже:

```console
msbuild [options] solutionFilterFile.slnf
```

Кроме того, вы можете добавить параметры и свойства, как обычно. См. статью [Справочник по командной строке MSBuild](msbuild-command-line-reference.md). Эта команда позволяет выполнить сборку отфильтрованных проектов и всех проектов, от которых они зависят. Если фильтр решений создается из командной строки, MSBuild автоматически использует зависимости. MSBuild выполняет сборку проекта, если он указан в фильтре или на него ссылается собираемый проект.

## <a name="solution-filter-files"></a>Файлы фильтров решений

Для работы с файлами фильтров решений можно использовать Visual Studio. При открытии фильтра решений в Visual Studio отображаются выгруженные и загруженные проекты, а также предоставляется возможность загрузить дополнительные проекты, чтобы выбрать их для сборки. Для сборки вы можете загрузить все проекты, от которых зависят исходные проекты, но это не обязательно. См. статью [Фильтрация решений в Visual Studio](../ide/filtered-solutions.md).

Фильтр решения не должен находиться в той же папке, что и решение. Путь к файлу решения задается относительно расположения файла фильтра решений. Но пути к каждому проекту задаются относительно самого файла решения и должны соответствовать путям к проектам, указанным в этом файле. В следующем примере показано использование относительных путей:

```json
{
  "solution": {
    "path": "..\\..\\Documents\\GitHub\\msbuild\\MSBuild.sln",
    "projects": [
      "src\\Build.OM.UnitTests\\Microsoft.Build.Engine.OM.UnitTests.csproj"
    ]
  }
}
```

Символы обратной косой черты в путях должны быть двойными, так как они экранируются.

## <a name="example"></a>Пример

Вот пример отфильтрованного решения в Visual Studio:

![Снимок экрана с отфильтрованным решением в Visual Studio](media/solution-with-filter.png)

В этом решении ClassLibrary1 используется проектами ProjectA и ProjectB, поэтому объект ClassLibrary1 указан в виде ссылки на проект.

Ниже приведен файл фильтра решений, создаваемый Visual Studio.

```json
{
  "solution": {
    "path": "MyApplication.sln",
    "projects": [
      "MyApplication\\MyApplication.csproj",
      "ProjectA\\ProjectA.csproj"
    ]
  }
}
```

В этом примере (с помощью команды `MSBuild [options] MyFilter.slnf`) MSBuild выполняет сборку с включенной фильтрацией для MyApplication и ProjectA, так как они явно указаны в файле фильтра решений. В рамках сборки ProjectA в MSBuild создается библиотека ClassLibrary1, так как ProjectA зависит от нее.  Для ProjectB сборка не выполняется. (В этой статье предполагается, что выполняется чистая сборка. Если сборка для проекта уже выполнялась, применяются обычные правила для пропуска обновленных проектов.)

## <a name="see-also"></a>См. также

- [Фильтрация решений в Visual Studio](../ide/filtered-solutions.md)
- [Справочник по командной строке MSBuild](msbuild-command-line-reference.md)
