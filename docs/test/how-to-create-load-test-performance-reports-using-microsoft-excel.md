---
title: Создание отчета по производительности нагрузочных тестов с помощью Excel
description: Сведения о том, как на основе двух и более результатах тестов создавать отчеты о нагрузочных тестах в формате Excel. Вы можете создавать отчеты со сравнением запусков и отчеты о тенденциях.
ms.custom: SEO-VS-2020
ms.date: 10/19/2016
ms.topic: how-to
helpviewer_keywords:
- load tests, creating Excel reports
- load tests, reporting
ms.assetid: b87fb196-9973-4512-a924-088788def4ea
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.openlocfilehash: 1196f0893c73873d4be6d17c7e41ee56490590d9
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99937567"
---
# <a name="how-to-create-load-test-performance-reports-using-microsoft-excel"></a>Практическое руководство. Создание отчетов по производительности нагрузочных тестов с помощью Microsoft Excel

На основе двух и более результатах тестов можно создавать отчеты о нагрузочных тестах в формате Excel.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

Доступны два типа отчетов о нагрузочных тестах:

- **Сравнение запусков**. При этом создается набор отчетов, сравнивающих данные результатов двух нагрузочных тестов с использованием таблиц и линейчатых диаграмм.

- **Тренд**. По результатам двух и более нагрузочных тестов можно создавать анализ тренда. Результаты отображаются в виде линейчатого графика, но данные доступны в виде сводных таблиц.

> [!TIP]
> Можно также вручную создавать отчеты Microsoft Word путем копирования и вставки данных из представлений сводки, диаграмм и таблиц. См. статью [Практическое руководство. Создание отчета о производительности нагрузочных тестов вручную с помощью Microsoft Word](../test/how-to-manually-create-a-load-test-performance-report-using-microsoft-word.md).

Любой из отчетов можно использовать для совместного использования данных о производительности с заинтересованными лицами и делать выводы об общем повышении производительности и работоспособности системы.

Определения отчетов хранятся в базе данных нагрузочных тестов. При сохранении отчета определение для него сохраняется в базе данных и может быть использовано повторно.

Книгу Excel можно также сделать общедоступной для всех заинтересованных лиц, чтобы у них не возникала необходимость в подключении к базе данных для ее просмотра.

> [!NOTE]
> Можно предоставить общий доступ к книге Excel; однако изменение ее таблиц доступно только на компьютерах пользователей, где установлен выпуск Visual Studio. У других пользователей на ленте **Office** не будет отображаться параметр **Загрузить отчет теста**, но они смогут открыть книгу.

На следующем рисунке показан пример отчета, демонстрирующего корреляцию между снижением скорости транзакций (UpdateCart) и падением значений счетчика (% процессора). Эти данные указывают на возможную проблему в коде приложения, а не в работе баз данных и сети, и данный случай рекомендуется изучить с помощью профилировщика ASP.NET.

![Потенциальная проблема в коде приложения](../test/media/lt_excel.png)

Отчеты в формате Excel могут создаваться либо в **анализаторе тестовой нагрузки** с помощью кнопки **Создание отчета Excel** на панели инструментов, либо из программы Excel с помощью пункта **Загрузить отчет теста** на вкладке **Загрузить тест** ленты **Office**.

> [!NOTE]
> Если в нагрузочный тест добавлены комментарии, они будут отображаться в отчете Excel.

## <a name="to-generate-load-test-comparison-reports-using-excel"></a>Создание сравнительного отчета о нагрузочных тестах в Excel

1. Прежде чем создать отчет, необходимо выполнить нагрузочный тест.

2. Отчеты нагрузочных тестов в формате Excel можно создавать двумя способами.

   - После выполнения нагрузочного теста на странице **Результаты нагрузочного теста** нажмите на панели инструментов кнопку **Создание отчета Excel**.

      > [!NOTE]
      > Если кнопка **Создать отчет Excel** недоступна на панели инструментов **средства просмотра результатов веб-тестов производительности**, для ее включения может потребоваться один раз открыть программу Microsoft Excel. При установке Visual Studio Enterprise на компьютер копируется надстройка нагрузочных тестов Visual Studio Enterprise для Microsoft Excel; однако для завершения процесса установки надстройки необходимо запустить программу Microsoft Excel.

      Откроется Microsoft Excel с мастером **Сформировать отчет теста нагрузки**.

   **OR**

   1. Откройте Microsoft Excel, перейдите на вкладку **Нагрузочный тест** на ленте **Office** и выберите пункт **Загрузить отчет теста**.

       Откроется окно мастера **Сформировать отчет теста нагрузки**.

   2. На странице **Выберите базу данных, содержащую нагрузочные тесты** в поле **Имя сервера** введите имя сервера, на котором находятся результаты нагрузочного теста.

   3. В раскрывающемся списке **Имя базы данных** выберите базу данных, содержащую результаты нагрузочного теста.

3. Убедитесь, что на странице **Как требуется создать отчет** установлен флажок **Создать отчет**, и нажмите кнопку **Далее**.

4. Убедитесь, что на странице **Тип создаваемого отчета** установлен флажок **Выполнить сравнение**, и нажмите кнопку **Далее**.

5. На странице **Ввод сведений отчета о нагрузочном тесте** укажите имя отчета в поле **Имя отчета**.

6. Выберите нагрузочный тест, для которого требуется создать отчет, и нажмите кнопку **Далее**.

7. На странице **Выберите запуски для отчета** в разделе **Выберите один или несколько запусков, которые будут добавлены к отчету** выберите два результата нагрузочного теста, которые нужно сравнить в отчете, и нажмите кнопку **Далее**.

   > [!NOTE]
   > Сравнительный отчет можно создавать только из двух результатов нагрузочных тестов. Если выбрать один результат нагрузочного теста или более двух результатов нагрузочных тестов, система отобразит соответствующее предупреждение.

8. На странице **Выберите счетчики для отчета** в разделе **Выберите один или несколько счетчиков, которые будут добавлены к отчету** доступен раскрывающийся список счетчиков для настройки отчета. Выберите счетчики, значения которых для двух выбранных тестовых запусков нужно сравнить в отчете, и нажмите кнопку **Готово**.

9. Создается книга Excel, в которую включаются следующие таблицы:

   - **Содержание** — имя отчета о нагрузочном тесте и содержание со ссылками на различные таблицы отчета.

   - **Запуски** — подробные сведения о двух сопоставляемых в отчете запусках.

   - **Сравнение тестов** — подробные сведения о линейчатой диаграмме, отображающей снижение или рост производительности между двумя тестами.

   - **Сравнение страницы** — линейчатая диаграмма и значения в процентах для сравнения двух запусков, представленных подробно на разных страницах отчета.

   - **Сравнение компьютеров** — сравнительные характеристики компьютеров, использованных в запусках.

   - **Сравнение ошибок** — сопоставление типов и количества ошибок, обнаруженных в запусках.

     > [!TIP]
     > Для расширения функциональности отчетов в нагрузочных тестах и веб-тестах производительности доступны дополнительные свойства. Запрос страницы имеет два свойства, представленных в отчете: "Цель" и "Имя отчета". Время ответа страницы сопоставляется с целевым значением, а имя отчета используется вместо URL-адреса. В разделе управления наборами счетчиков параметров запуска нагрузочного теста свойство "Теги компьютера" представлено как имя компьютера. Это удобно для описания роли конкретного компьютера в отчете.

## <a name="to-generate-load-test-trend-reports-using-excel"></a>Создание отчета о тренде нагрузочных тестов в Excel

1. Прежде чем создать отчет, необходимо выполнить нагрузочный тест.

2. Отчеты нагрузочных тестов в формате Excel можно создавать двумя способами.

   - После выполнения нагрузочного теста на странице **Результаты нагрузочного теста** нажмите на панели инструментов кнопку **Создание отчета Excel**.

      > [!NOTE]
      > Если кнопка **Создать отчет Excel** недоступна на панели инструментов **средства просмотра результатов веб-тестов производительности**, для ее включения может потребоваться один раз открыть программу Microsoft Excel. При установке Visual Studio Enterprise на компьютер копируется надстройка нагрузочных тестов Visual Studio Enterprise для Microsoft Excel; однако для завершения процесса установки надстройки необходимо запустить программу Microsoft Excel.

      Откроется Microsoft Excel с мастером **Сформировать отчет теста нагрузки**.

   **OR**

   1. Откройте Microsoft Excel, перейдите на вкладку **Нагрузочный тест** на ленте **Office** и выберите пункт **Загрузить отчет теста**.

       Откроется окно мастера **Сформировать отчет теста нагрузки**.

   2. На странице **Выберите базу данных, содержащую нагрузочные тесты** в поле **Имя сервера** введите имя сервера, на котором находятся результаты нагрузочного теста.

   3. В раскрывающемся списке **Имя базы данных** выберите базу данных, содержащую результаты нагрузочного теста.

3. Убедитесь, что на странице **Как требуется создать отчет** установлен флажок **Создать отчет**, и нажмите кнопку **Далее**.

4. На странице **Тип создаваемого отчета** убедитесь, что установлен флажок **Тренд**, и нажмите кнопку **Далее**.

5. На странице **Ввод сведений отчета о нагрузочном тесте** укажите имя отчета в поле **Имя отчета**.

6. Выберите нагрузочный тест, для которого требуется создать отчет, и нажмите кнопку **Далее**.

7. На странице **Выберите запуски для отчета** в разделе **Выберите один или несколько запусков, которые будут добавлены к отчету** выберите результат нагрузочного теста, который нужно сравнить в отчете, и нажмите кнопку **Далее**.

8. На странице **Выберите счетчики для отчета** в разделе **Выберите один или несколько счетчиков, которые будут добавлены к отчету** доступен раскрывающийся список счетчиков для настройки отчета. Выберите счетчики, значения которых нужно сопоставить в отчете о тренде, и нажмите кнопку **Готово**.

9. Создается отчет, который содержит оглавление со ссылками на различные листы книги Excel, созданные в отчете. Ссылки создаются в соответствии с выбранным набором счетчиков для отчета о тренде. Например, если в шаге 7 оставить выбранные по умолчанию счетчики, то в отчете будут созданы отдельные таблицы для всех счетчиков, перечисленных в шаге 7. Данные каждого счетчика представляются в виде графиков трендов.

   > [!TIP]
   > Для расширения функциональности отчетов в нагрузочных тестах и веб-тестах производительности доступны дополнительные свойства. Запрос страницы имеет два свойства, представленных в отчете: "Цель" и "Имя отчета". Время ответа страницы сопоставляется с целевым значением, а имя отчета используется вместо URL-адреса. В разделе управления наборами счетчиков параметров запуска нагрузочного теста свойство "Теги компьютера" представлено как имя компьютера. Это удобно для описания роли конкретного компьютера в отчете.

## <a name="net-security"></a>Безопасность в .NET

Результаты нагрузочных тестов потенциально содержат конфиденциальную информацию, которую можно использовать для осуществления атак против компьютера или сети. Отчеты и результаты нагрузочных тестов содержат имена компьютеров и строки подключения. Об этом следует помнить при общем использовании отчетов о нагрузочных тестах.

## <a name="see-also"></a>См. также раздел

- [Создание отчетов о результатах нагрузочных тестов для сравнения тестов или анализа трендов](../test/compare-load-test-results.md)
