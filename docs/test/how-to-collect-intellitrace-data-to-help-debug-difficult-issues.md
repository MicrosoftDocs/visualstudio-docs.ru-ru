---
title: Данные IntelliTrace
description: Сведения о том, как настроить адаптер диагностических данных на использование IntelliTrace для сбора определенных диагностических данных трассировки в Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 10/13/2016
ms.topic: how-to
helpviewer_keywords:
- IntelliTrace, configuring test settings
- Diagnostic Data Adapter, InteliTrace
- debugging [Visual Studio ALM], difficult issues using IntelliTrace
- Test Runner, InteliTrace
ms.assetid: 02b6716f-569e-4961-938a-e790a0c74b5c
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.openlocfilehash: 6ecc16725913e159bb2dfeb45277c4555efa50a5
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99966790"
---
# <a name="how-to-collect-intellitrace-data-to-help-debug-difficult-issues"></a>Практическое руководство. Сбор данных IntelliTrace для отладки сложных проблем

Вы можете настроить адаптер диагностических данных на использование IntelliTrace для сбора определенных диагностических данных трассировки в Visual Studio. Тесты могут использовать этот адаптер и могут записывать значимые диагностические события приложения, которые разработчик может использовать для трассировки кода и поиска причины ошибки. Адаптер диагностических данных для IntelliTrace можно использовать в ручных или автоматических тестах.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

> [!NOTE]
> Средство IntelliTrace поддерживает только приложения, написанные с использованием управляемого кода. Если вы тестируете веб-приложение, которое использует браузер в качестве клиента, не включайте IntelliTrace для клиента в параметрах тестирования, так как управляемый код для трассировки отсутствует. В этом случае рекомендуем настроить среду и собирать данные IntelliTrace в удаленном режиме на веб-сервере.

Данные IntelliTrace хранятся в файле с расширением *.iTrace*. Если при выполнении теста шаг теста завершается ошибкой, можно создать сообщение об ошибке. Файл IntelliTrace, содержащий диагностические данные, автоматически присоединяется к этому сообщению.

> [!NOTE]
> Адаптер диагностических данных для IntelliTrace не создает файл IntelliTrace, если тестирование успешно пройдено. Он сохраняет файл только при условии неудачного тестового случая или при отправке ошибки.

Данные, собираемые в файл IntelliTrace, повышают производительность отладки за счет снижения затрат времени на воспроизведение и диагностику ошибок в коде. Кроме того, количество проблем с воспроизведением ошибок уменьшается за счет возможности передать файл IntelliTrace другому специалисту, который может воспроизвести локальный сеанс на своем компьютере.

> [!NOTE]
> Если в параметрах тестирования включена поддержка IntelliTrace, сбор данных покрытия кода работать не будет.

> [!WARNING]
> Адаптер диагностических данных для IntelliTrace работает с помощью управляемого процесса, который должен выполняться после загрузки тестов для тестового запуска. Если процесс, который нужно отслеживать, уже начался, файлы IntelliTrace записываться не будут, так как процесс уже выполняется. Для решения этой проблемы убедитесь перед загрузкой тестов, что процесс остановлен. Затем запустите процесс после загрузки тестов или после запуска первого теста.

::: moniker range="vs-2017"
В следующей процедуре описывается порядок настройки данных IntelliTrace, которые необходимо записывать. Эти шаги применимы к редактору конфигурации в Microsoft Test Manager и к диалоговому окну "Параметры тестирования" в Visual Studio.
::: moniker-end
::: moniker range=">=vs-2019"
В следующей процедуре описывается порядок настройки данных IntelliTrace, которые необходимо записывать. Эти действия относятся к диалоговому окну "Параметры тестирования" в Visual Studio.
::: moniker-end

> [!NOTE]
> Учетная запись пользователя для агента тестирования, используемого для сбора данных IntelliTrace, должна входить в группу администраторов. Дополнительные сведения см. в статье [Установка и настройка агентов тестирования](../test/lab-management/install-configure-test-agents.md).

## <a name="configure-the-data-to-collect-with-the-intellitrace-diagnostic-data-adapter"></a>Настройка данных, которые будут собираться с помощью адаптера диагностических данных IntelliTrace

::: moniker range="vs-2017"
Перед выполнением шагов этой процедуры нужно открыть параметры тестирования в Microsoft Test Manager или Visual Studio и перейти на страницу **Данные и диагностика**.
::: moniker-end
::: moniker range=">=vs-2019"
Перед выполнением шагов этой процедуры необходимо открыть параметры тестирования в Visual Studio и перейти на страницу **Данные и диагностика**.
::: moniker-end

### <a name="to-configure-the-data-to-collect-with-the-intellitrace-diagnostic-data-adapter"></a>Настройка данных, которые будут собираться с помощью адаптера диагностических данных IntelliTrace

1. Выберите роль, используемую для сбора данных IntelliTrace.

2. Выберите **IntelliTrace**.

3. Если IntelliTrace добавляется для роли веб-клиента или для веб-приложения ASP.NET, выберите **Прокси клиента ASP.NET для IntelliTrace и влияния на тесты**.

     Прокси-сервер позволяет собирать данные об HTTP-обращениях клиента к веб-серверу для адаптеров диагностических данных IntelliTrace и влияния на тесты.

    > [!WARNING]
    > Если вы решили использовать пользовательскую учетную запись в пуле приложений на сервере IIS, на котором будет происходить сбор данных IntelliTrace, необходимо создать для этой учетной записи профиль локального пользователя на компьютере с IIS. Чтобы создать локальный профиль для пользовательской учетной записи, можно один раз локально войти на компьютер с IIS или выполнить следующую команду, указав учетные данные пользовательской учетной записи:
    >
    > **runas /пользователь:домен\имя /profile cmd.exe**

4. Выберите команду **Настроить** для **IntelliTrace**, чтобы изменить параметры IntelliTrace по умолчанию.

     Откроется диалоговое окно настройки сбора данных.

    > [!WARNING]
    > Если включен сбор данных IntelliTrace, сбор данных покрытия кода работать не будет.

5. Перейдите на вкладку **Общие**. Выберите **только события IntelliTrace**, чтобы записывать значимые события диагностики с минимальным влиянием на производительность во время тестирования.

     -или-

     Выберите **события и сведения о вызовах IntelliTrace**, чтобы записывать события диагностики и трассировку на уровне методов, в которой отображаются сведения о вызовах. Этот уровень трассировки может влиять на производительность при выполнении тестов.

6. Чтобы собирать данные из приложения ASP.NET, которое выполняется на базе служб IIS, выберите параметр **Сбор данных из приложений ASP.NET, запущенных в службах IIS**. Установите и настройте агент тестирования в роли веб-сервера. См. раздел [Установка и настройка агентов тестирования](../test/lab-management/install-configure-test-agents.md).

7. Выберите вкладку **Модули**. Выберите **Сбор данных из всех модулей за исключением следующего** и с помощью кнопки **Добавить** добавьте в список модули или выберите **Удалить**, чтобы удалить модуль. Этот параметр позволяет включить все модули, выполняемые в системе, кроме указанных модулей.

     -или-

     Выберите **Сбор данных только из следующих модулей** и с помощью кнопки **Добавить** добавьте в список модули или с помощью кнопки **Удалить** — удалите. Этот параметр позволяет точно задать интересующие модули.

    > [!NOTE]
    > Если возможно, выберите конкретные процессы, которые требуется отслеживать. Рекомендуется сделать это для достижения оптимальной производительности.

8. Выберите вкладку **Процессы**. Выберите **Сбор данных из всех процессов, кроме следующих** и используйте кнопку **Добавить** или **Удалить**, чтобы добавить процессы в список или удалить их. Этот параметр позволяет включить все процессы, выполняемые в системе, кроме указанных процессов.

     -или-

     Выберите **Сбор данных только из указанных процессов** и используйте кнопку **Добавить** или **Удалить**, чтобы добавить процессы в список или удалить их. Этот параметр позволяет точно задать интересующие процессы.

9. Откройте вкладку **События IntelliTrace** (необязательно). Установите или снимите флажок каждой категории событий IntelliTrace, которую необходимо соответственно включить или исключить во время сбора событий диагностики.

10. (Необязательно) Раскройте каждую категорию событий IntelliTrace и установите или снимите флажок каждого события, которое необходимо соответственно включить или исключить из событий IntelliTrace.

11. Откройте вкладку **Дополнительно** (необязательно). Затем выберите стрелку рядом с пунктом **Максимальный объем дискового пространства для каждой записи** и установите максимальный размер, который может использоваться функцией IntelliTrace.

    > [!NOTE]
    > Если увеличить размер записи, при сохранении этой записи вместе с результатами теста может возникнуть проблема времени ожидания.

12. Если вы используете Microsoft Test Manager (не рекомендуется в Visual Studio 2017), выберите **Сохранить**. Если используется Visual Studio, нажмите кнопку **ОК**. Параметры IntelliTrace настроены и сохранены в параметрах тестирования.

    ::: moniker range="vs-2017"
    > [!NOTE]
    > Чтобы сбросить конфигурацию этого адаптера диагностических данных, выберите команду **Восстановить конфигурацию по умолчанию** в Visual Studio или **Восстановить значения по умолчанию** в Microsoft Test Manager.
    ::: moniker-end
    ::: moniker range=">=vs-2019"
    > [!NOTE]
    > Чтобы сбросить конфигурацию этого адаптера диагностических данных, выберите в Visual Studio команду **Восстановить конфигурацию по умолчанию**.
    ::: moniker-end

## <a name="see-also"></a>См. также

- [Сбор диагностических данных во время тестирования (Azure Test Plans)](/azure/devops/test/collect-diagnostic-data?view=vsts&preserve-view=true)
- [Сбор диагностических данных в ручных тестах (Azure Test Plans)](/azure/devops/test/mtm/collect-more-diagnostic-data-in-manual-tests?view=vsts&preserve-view=true)
- [Сбор диагностических данных с помощью параметров тестирования](../test/collect-diagnostic-information-using-test-settings.md)
- [Сбор данных IntelliTrace](../test/how-to-collect-intellitrace-data-to-help-debug-difficult-issues.md)
