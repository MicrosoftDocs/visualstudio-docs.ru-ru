---
title: Обновление диаграммы на листе с помощью переключателей
description: Изучите основы использования переключателей на листе Microsoft Excel, чтобы дать пользователю возможность быстро переключаться между параметрами.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- worksheets, updating using managed controls
- controls [Office development in Visual Studio], updating worksheets
- worksheets, using radio buttons
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 3d61579181f00d97a74cc48e022bb5d93a05c0f0
ms.sourcegitcommit: 4b40aac584991cc2eb2186c3e4f4a7fcd522f607
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2021
ms.locfileid: "107828180"
---
# <a name="walkthrough-updating-a-chart-in-a-worksheet-using-radio-buttons"></a>Пошаговое руководство. Обновление диаграммы на листе с помощью переключателей
  В этом пошаговом руководстве показаны основные принципы использования переключателей на листе Excel Microsoft Office, чтобы дать пользователю возможность быстро переключаться между параметрами. В этом случае параметры изменяют стиль диаграммы.

 [!INCLUDE[appliesto_xlalldoc](../vsto/includes/appliesto-xlalldoc-md.md)]

 Чтобы увидеть результат как завершенный пример, см. Пример элементов управления Excel в разделе [примеры разработки Office и пошаговые руководства](../vsto/office-development-samples-and-walkthroughs.md).

 В этом пошаговом руководстве описаны следующие задачи:

- Добавление группы переключателей на лист.

- изменение стиля диаграммы при выбранном параметре.

> [!NOTE]
> Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. Дополнительные сведения см. в разделе [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).

## <a name="prerequisites"></a>Предварительные требования
 Для выполнения этого пошагового руководства требуются следующие компоненты:

- [!INCLUDE[vsto_vsprereq](../vsto/includes/vsto-vsprereq-md.md)]

- [!INCLUDE[Excel_15_short](../vsto/includes/excel-15-short-md.md)] или [!INCLUDE[Excel_14_short](../vsto/includes/excel-14-short-md.md)].

## <a name="add-a-chart-to-a-worksheet"></a>Добавление диаграммы на лист
 Можно создать проект книги Excel, который настраивает существующую книгу. В этом пошаговом руководстве вы добавите диаграмму в книгу, а затем используете ее в новом решении Excel. Источником данных в этом пошаговом руководстве является лист с именем **Data для диаграммы**.

### <a name="to-add-the-data"></a>Добавление данных

1. Откройте Microsoft Excel.

2. Щелкните правой кнопкой мыши вкладку **Sheet3** и выберите в контекстном меню команду **Переименовать** .

3. Переименуйте лист в **данные для диаграммы**.

4. Добавьте следующие данные в **данные для диаграммы** , в которой ячейка A4 находится в левом верхнем углу, и E8 нижний правый угол.

   |Регион/квартал|КВ1|КВ2|КВ3|КВ4|
   |-|--------|--------|--------|--------|
   |West|500|550|550|600|
   |Восток|600|625|675|700|
   |Север|450|470|490|510|
   |Юг|800|750|775|790|

   Затем добавьте диаграмму на первый лист, чтобы отобразить данные.

### <a name="to-add-a-chart-in-excel"></a>Добавление диаграммы в Excel

1. На вкладке **Вставка** в группе **диаграммы** щелкните **столбец**, а затем выберите пункт **все типы диаграмм**.

2. В диалоговом окне **Вставка диаграммы** нажмите кнопку **ОК**.

3. На вкладке **конструктор** в группе **данные** нажмите кнопку **выбрать данные**.

4. В диалоговом окне **Выбор источника данных** щелкните поле **диапазон чартдата** и снимите все выбранные по умолчанию.

5. На листе « **данные для диаграммы** » выберите блок ячеек, содержащих числа, включая A4 в верхнем левом углу, E8 в правом нижнем углу.

6. В диалоговом окне **Выбор источника данных** нажмите кнопку **ОК**.

7. Изменить расположение диаграммы, чтобы правый верхний угол совпадал с ячейкой **E2**.

8. Сохраните файл на диске C и назовите его **ExcelChart.xlsx**.

9. Выйдите из Excel.

## <a name="create-a-new-project"></a>Создание нового проекта
 На этом шаге вы создадите проект книги Excel на основе книги **ексцелчарт** .

### <a name="to-create-a-new-project"></a>Создание нового проекта

1. Создайте проект книги Excel с именем **Моя диаграмма Excel**. В мастере выберите **Копировать существующий документ**.

     Дополнительные сведения см. в разделе [как создавать проекты Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).

2. Нажмите кнопку **Обзор** и перейдите к книге, созданной ранее в этом пошаговом руководстве.

3. Нажмите кнопку **ОК**.

     Visual Studio откроет новую книгу Excel в конструкторе и добавит проект " **Моя диаграмма Excel** " в **Обозреватель решений**.

## <a name="set-properties-of-the-chart"></a>Задание свойств диаграммы
 При создании нового проекта книги Excel, использующего существующую книгу, элементы управления ведущего приложения автоматически создаются для всех именованных диапазонов, объектов списка и диаграмм в книге. Имя <xref:Microsoft.Office.Tools.Excel.Chart> элемента управления можно изменить с помощью окна **свойства** .

### <a name="to-change-the-name-of-the-chart-control"></a>Изменение имени элемента управления диаграммы

1. Выберите <xref:Microsoft.Office.Tools.Excel.Chart> элемент управления в конструкторе и измените следующие свойства в окне **свойства** .

    |Свойство|Значение|
    |--------------|-----------|
    |**Имя**|**Диаграмма в виде диаграммы**|
    |**хаслеженд**|**false**|

## <a name="add-controls"></a>Добавление элементов управления
 Этот лист использует переключатели, чтобы дать пользователям возможность быстро изменить стиль диаграммы. Однако переключатели должны быть эксклюзивными — когда одна кнопка выбрана, другие кнопки в группе не могут быть выбраны одновременно. Это поведение не происходит по умолчанию при добавлении нескольких переключателей на лист.

 Одним из способов добавления такого поведения является группирование переключателей в пользовательском элементе управления, написание кода на основе пользовательского элемента управления, а затем Добавление пользовательского элемента управления на лист.

### <a name="to-add-a-user-control"></a>Добавление пользовательского элемента управления

1. Выберите проект " **Моя диаграмма Excel** " в **Обозреватель решений**.

2. В меню **Проект** выберите **Добавить новый элемент**.

3. В диалоговом окне **Добавление нового элемента** щелкните **Пользовательский элемент управления**, назовите элемент управления **чартоптионс** и нажмите кнопку **Добавить**.

### <a name="to-add-radio-buttons-to-the-user-control"></a>Добавление переключателей в пользовательский элемент управления

1. Если пользовательский элемент управления не отображается в конструкторе, дважды щелкните **чартоптионс** в **Обозреватель решений**.

2. На вкладке **Общие элементы управления** **панели элементов** перетащите элемент управления **переключатель** в пользовательский элемент управления и измените следующие свойства.

   | Свойство | Значение |
   |----------|------------------|
   | **Имя** | **columnChart** |
   | **Text** | **Гистограмма** |

3. Добавьте второй переключатель в пользовательский элемент управления и измените следующие свойства.

   | Свойство | Значение |
   |----------|---------------|
   | **Имя** | **barChart** |
   | **Text** | **Линейчатая диаграмма** |

4. Добавьте третий переключатель в пользовательский элемент управления и измените следующие свойства.

   | Свойство | Значение |
   |----------|----------------|
   | **Имя** | **lineChart** |
   | **Text** | **График** |

5. Добавьте четвертый переключатель в пользовательский элемент управления и измените следующие свойства.

   |Свойство|Значение|
   |--------------|-----------|
   |**Имя**|**areaBlockChart**|
   |**Text**|**Диаграмма с областями**|

   Затем напишите код для обновления диаграммы при нажатии переключателя.

## <a name="change-the-chart-style-when-a-radio-button-is-selected"></a>Изменить стиль диаграммы при выборе переключателя
 Теперь можно добавить код для изменения стиля диаграммы. Для этого создайте открытое событие в пользовательском элементе управления, добавьте свойство, чтобы задать тип выбора, и создайте обработчик событий для `CheckedChanged` события каждого переключателя.

### <a name="to-create-an-event-and-property-on-a-user-control"></a>Создание события и свойства по пользовательскому элементу управления

1. В **Обозреватель решений** щелкните правой кнопкой мыши пользовательский элемент управления и выберите пункт **Просмотреть код**.

2. Добавьте код в `ChartOptions` класс, чтобы создать `SelectionChanged` событие и `Selection` свойство.

     :::code language="vb" source="../vsto/codesnippet/VisualBasic/my excel chart/ChartOptions.vb" id="Snippet13":::
     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_VstcoreProgrammingControlsExcelCS/ChartOptions.cs" id="Snippet13":::

### <a name="to-handle-the-checkedchanged-event-of-the-radio-buttons"></a>Работа с событием CheckedChanged переключателей

1. Установите тип диаграммы в обработчике событий `CheckedChanged` переключателя `areaBlockChart`, а затем породите событие.

     :::code language="vb" source="../vsto/codesnippet/VisualBasic/my excel chart/ChartOptions.vb" id="Snippet14":::
     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_VstcoreProgrammingControlsExcelCS/ChartOptions.cs" id="Snippet14":::

2. Установите тип диаграммы в обработчик событий `CheckedChanged` переключателя `barChart`.

     :::code language="vb" source="../vsto/codesnippet/VisualBasic/my excel chart/ChartOptions.vb" id="Snippet15":::
     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_VstcoreProgrammingControlsExcelCS/ChartOptions.cs" id="Snippet15":::

3. Установите тип диаграммы в обработчик событий `CheckedChanged` переключателя `columnChart`.

     :::code language="vb" source="../vsto/codesnippet/VisualBasic/my excel chart/ChartOptions.vb" id="Snippet16":::
     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_VstcoreProgrammingControlsExcelCS/ChartOptions.cs" id="Snippet16":::

4. Установите тип диаграммы в обработчик событий `CheckedChanged` переключателя `lineChart`.

     :::code language="vb" source="../vsto/codesnippet/VisualBasic/my excel chart/ChartOptions.vb" id="Snippet17":::
     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_VstcoreProgrammingControlsExcelCS/ChartOptions.cs" id="Snippet17":::

5. В языке программирования C# для переключателей должны быть добавлены обработчики событий. Код можно добавить в конструктор `ChartOptions` под вызовом `InitializeComponent`. Дополнительные сведения о создании обработчиков событий см. в разделе [как создавать обработчики событий в проектах Office](../vsto/how-to-create-event-handlers-in-office-projects.md).

     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_VstcoreProgrammingControlsExcelCS/ChartOptions.cs" id="Snippet18":::

## <a name="add-the-user-control-to-the-worksheet"></a>Добавление пользовательского элемента управления на лист
 При построении решения новый пользовательский элемент управления автоматически добавляется на **панель элементов**. Затем можно перетащить элемент управления с **панели элементов** на лист.

### <a name="to-add-the-user-control-your-worksheet"></a>Добавление пользовательского элемента управления на лист

1. В меню **Сборка** выберите **Собрать решение**.

     Пользовательский элемент управления **чартоптионс** добавляется на **панель элементов**.

2. В **Обозреватель решений** щелкните правой кнопкой мыши **Лист1. vb** или **Sheet1. CS**, а затем выберите пункт **Конструктор представлений**.

3. Перетащите элемент управления **чартоптионс** с **панели элементов** на лист.

     Новый элемент управления с именем `my_Excel_Chart_ChartOptions1` добавляется в проект.

4. Измените имя элемента управления на **ChartOptions1**.

## <a name="change-the-chart-type"></a>Изменение типа диаграммы
 Чтобы изменить тип диаграммы, создайте обработчик событий, который задает стиль в соответствии с параметром, выбранным в пользовательском элементе управления.

### <a name="to-change-the-type-of-chart-that-is-displayed-in-the-worksheet"></a>Изменение типа диаграммы, отображаемой на листе

1. Добавьте следующий обработчик событий в класс `Sheet1`.

     :::code language="vb" source="../vsto/codesnippet/VisualBasic/my excel chart/Sheet1.vb" id="Snippet19":::
     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_VstcoreProgrammingControlsExcelCS/Sheet1.cs" id="Snippet19":::

2. В C# необходимо добавить обработчик событий для пользовательского элемента управления в <xref:Microsoft.Office.Tools.Excel.Worksheet.Startup> событие, как показано ниже. Дополнительные сведения о создании обработчиков событий см. в разделе [как создавать обработчики событий в проектах Office](../vsto/how-to-create-event-handlers-in-office-projects.md).

     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_VstcoreProgrammingControlsExcelCS/Sheet1.cs" id="Snippet20":::

## <a name="test-the-application"></a>Тестирование приложения
 Теперь можно протестировать книгу, чтобы убедиться, что диаграмма правильно оформлена при выборе переключателя.

### <a name="to-test-your-workbook"></a>Проверка книги

1. Нажмите клавишу **F5** , чтобы запустить проект.

2. Выберите различные переключатели.

3. Подтвердите, что изменения стиля диаграммы соответствуют выбору.

## <a name="next-steps"></a>Дальнейшие действия
 В этом пошаговом руководстве показаны основные принципы использования переключателей и стилей диаграмм на листах. Ниже приводятся некоторые из возможных последующих задач.

- Развертывание проекта. Дополнительные сведения см. в разделе [развертывание решения Office](../vsto/deploying-an-office-solution.md).

- Использование кнопки для заполнения текстового поля. Дополнительные сведения см. [в разделе Пошаговое руководство. Отображение текста в текстовом поле листа с помощью кнопки](../vsto/walkthrough-displaying-text-in-a-text-box-in-a-worksheet-using-a-button.md).

- Изменение форматирования листа с помощью флажков. Дополнительные сведения см. в разделе [Пошаговое руководство. изменение форматирования листа с помощью элементов управления CheckBox](../vsto/walkthrough-changing-worksheet-formatting-using-checkbox-controls.md).

## <a name="see-also"></a>См. также статью
- [Пошаговые руководства с использованием Excel](../vsto/walkthroughs-using-excel.md)
