---
title: Как создавать проекты Office в Visual Studio
description: Узнайте, как можно использовать Visual Studio для создания надстроек VSTO и настроек на уровне документа для Microsoft Office приложений.
titleSuffix: ''
ms.custom: seodec18, SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
f1_keywords:
- VST.SelectDocWizard.Page1
- VST.SelectDocWizard.Http
- VST.SelectDocWizard.Extension
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- add-ins [Office development in Visual Studio], creating projects
- Office applications [Office development in Visual Studio], creating
- Office projects [Office development in Visual Studio]
- projects [Office development in Visual Studio], creating
- document-level customizations [Office development in Visual Studio], creating
- application-level add-ins [Office development in Visual Studio], creating projects
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 1d0bd242f3a57031442cb0b39e62a28c01ad1a6b
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99962396"
---
# <a name="how-to-create-office-projects-in-visual-studio"></a>Как создавать проекты Office в Visual Studio
  С помощью можно [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] создавать надстройки VSTO и настройки на уровне документа для Microsoft Office приложений. Дополнительные сведения об этих типах проектов см. в статье [Общие сведения о разработке решений Office &#40;VSTO&#41;](../vsto/office-solutions-development-overview-vsto.md).

 [!INCLUDE[appliesto_all](../vsto/includes/appliesto-all-md.md)]

 [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]

### <a name="to-create-a-vsto-add-in-project"></a>Создание проекта надстройки VSTO

1. В меню **Файл** последовательно выберите пункты **Создать** > **Проект**. Если в интегрированной среде разработки (IDE) настроено использование [!INCLUDE[vbprvb](../sharepoint/includes/vbprvb-md.md)] параметров разработки, в меню **файл** выберите пункт **создать**  >  **проект**.

    Откроется диалоговое окно **Создание проекта** .

   > [!NOTE]
   > По умолчанию проекты Office ориентированы на [!INCLUDE[net_v45](../vsto/includes/net-v45-md.md)]. Дополнительные сведения см. в статье [платформа .NET Framework клиентский профиль](/dotnet/framework/deployment/client-profile).

2. В области Шаблоны в узле для нужного языка разверните узел **Office/SharePoint**.

3. Выберите узел **надстройки Office** .

4. В списке шаблонов проектов выберите шаблон проекта надстройки VSTO. Список доступных шаблонов проектов надстроек VSTO см. в статье [Общие сведения о шаблонах проектов Office](../vsto/office-project-templates-overview.md).

   > [!NOTE]
   > Если при выборе узла **надстройки Office** не отображаются шаблоны проектов, убедитесь, что в поле со списком в верхней части диалогового окна выбран параметр **платформа .NET Framework 4** или более поздней версии. Шаблоны проектов Office отображаются для обеих версий платформы .NET Framework.

5. В поле **имя** введите имя проекта. По умолчанию имя проекта используется и в качестве имени решения.

6. В поле **Расположение** введите путь, по которому нужно создать проект. Вы можете использовать абсолютные пути и пути в формате UNC. Не используйте пути на базе HTTP, FTP и других протоколов.

    Расположения имеют следующие форматы:

   * [*диск*\]\:

   * \\\\*Серверная* \\ *Общий доступ*

     Не используйте в имени расположения следующие символы:

   * Звездочка (*)

   * Вертикальная черта (|)

   * Двоеточие (:) (кроме позиции за буквой диска)

   * Двойные кавычки (") (пути, содержащие пробелы не требуют кавычек)

   * Знак "меньше" (\<)

   * Знак «больше» >)

   * Вопросительный знак (?)

   * Знак процента (%)

7. Нажмите кнопку **ОК** .

   ::: moniker range="vs-2017"

   > [!NOTE]
   > Проекты надстроек всегда сохраняются при создании. Они не могут создаваться как временные проекты. Дополнительные сведения о временных проектах см. в разделе [временные проекты](../ide/creating-solutions-and-projects.md#create-a-temporary-project).

   ::: moniker-end

### <a name="to-create-a-document-level-customization-project"></a>Создание проекта настройки на уровне документа

1. В меню **Файл** последовательно выберите пункты **Создать** > **Проект**. Если в интегрированной среде разработки настроено использование параметров Visual Basic разработки, в меню **файл** выберите пункт **создать**  >  **проект**.

    Откроется диалоговое окно **Создание проекта** .

2. В области Шаблоны в узле для нужного языка разверните узел **Office/SharePoint**.

3. Выберите узел **Надстройки Office** .

4. В списке шаблонов проектов выберите шаблон проекта уровня документа. Список доступных шаблонов проектов уровня документа см. в статье [Общие сведения о шаблонах проектов Office](../vsto/office-project-templates-overview.md).

   > [!NOTE]
   > Если шаблоны проектов не отображаются при выборе узла **надстройки Office** , убедитесь, что выбран параметр **платформа .NET Framework 4** или более поздней версии.

5. В поле **имя** введите имя проекта. По умолчанию это имя используется также и для документа. Если интерфейс IDE настроен на использование параметров разработки Visual C# или общих параметров разработки, укажите также расположение и имя решения.

   > [!NOTE]
   > В пути к папке проекта и имени проекта нельзя использовать суррогатные символы. Кроме того, если планируется развертывать решение для автономного использования, символы в имени проекта должны удовлетворять требованиям спецификации протокола HTTP.

6. Нажмите кнопку **ОК** .

    Откроется **Мастер проектов набора средств Visual Studio для Office** .

7. Выберите **создать новый документ** , если необходимо создать новый документ для решения, или выберите **Копировать существующий документ** , если требуется настроить существующий документ.

    При создании нового документа укажите имя в поле **имя** и выберите формат документа с помощью поля **Формат** . Дополнительные сведения о доступных форматах см. в разделе [Архитектура настроек на уровне документа](../vsto/architecture-of-document-level-customizations.md).

    Если используется существующий документ, укажите расположение документа в **полном пути к существующему документу** . Можно использовать абсолютные и UNC-пути. Не используйте пути к документу, основанные на HTTP, FTP и других протоколах.

    Расположения имеют следующие форматы:

   - [*диск*\]\:

   - \\\\*Серверная* \\ *Общий доступ*

     Не используйте в имени расположения следующие символы:

   - Звездочка (*)

   - Вертикальная черта (|)

   - Двоеточие (:) (кроме позиции за буквой диска)

   - Двойные кавычки (") (пути, содержащие пробелы не требуют кавычек)

   - Знак "меньше" (\<)

   - Знак «больше» >)

   - Вопросительный знак (?)

   - Знак процента (%)

   > [!NOTE]
   > При использовании существующего документа в проекте [!INCLUDE[Word_15_short](../vsto/includes/word-15-short-md.md)] выбирайте только такие документы, которые созданы в [!INCLUDE[Word_15_short](../vsto/includes/word-15-short-md.md)] или преобразованы в его формат. Аналогично, при использовании существующего документа в проекте Word 2010 выбирайте только такие документы, которые созданы в Word 2010 или преобразованы в его формат. При использовании документа, созданного в более ранней версии Word, некоторые функции будут отключены. При попытке написать код, использующий эти функции, в проекте могут возникнуть ошибки. Чтобы преобразовать документ, откройте его в [!INCLUDE[Word_15_short](../vsto/includes/word-15-short-md.md)] или Word 2010, на вкладке " **файл** " на ленте выберите **сведения**  >  **преобразовать**.

8. Нажмите кнопку **Готово**.

9. Добавьте папку проекта и вложенные в нее папки в список надежных расположений в центре управления безопасностью в Word в следующих случаях:

   - Вы создаете документ Word, основанный на файле *DOCM* , и документ содержит проект VBA или размещает Windows Forms элементов управления. Добавление папки проекта в список надежных расположений будет способствовать тому, что документ будет работает ожидаемым образом во время разработки.

   - Создается проект шаблона Word, основанный на *dotx* -файле. Необходимо добавить папку проекта в список надежных расположений, чтобы можно было выполнять и отлаживать проект.

     Дополнительные сведения о добавлении документа в список надежных расположений см. на веб-сайте Microsoft Office Online [Создание, удаление или изменение надежного расположения файлов](https://support.office.com/article/Create-remove-or-change-a-trusted-location-for-your-files-f5151879-25ea-4998-80a5-4208b3540a62).

## <a name="see-also"></a>См. также раздел
- [Общие сведения о шаблонах проектов Office](../vsto/office-project-templates-overview.md)
- [Совместная разработка решений Office](../vsto/collaborative-development-of-office-solutions.md)
- [Разработка и создание решений Office](../vsto/designing-and-creating-office-solutions.md)
- [Приступая к программированию надстроек VSTO](../vsto/getting-started-programming-vsto-add-ins.md)
