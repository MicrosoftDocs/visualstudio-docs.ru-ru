---
title: Кэшированные данные в настройках уровня документа
description: Сведения о том, как Visual Studio разделяет данные из представления в настройках уровня документа, позволяя внедрять данные в качестве кэша данных.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- data islands [Office development in Visual Studio]
- view [Office development in Visual Studio]
- caching data [Office development in Visual Studio], about caching data
- data caching [Office development in Visual Studio], about data caching
- data [Office development in Visual Studio], cache
- data [Office development in Visual Studio], document-level solutions
- document-level customizations [Office development in Visual Studio], data model
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: f1c383b5367b2966b9fd082b2d47570264b4d191
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99955779"
---
# <a name="cached-data-in-document-level-customizations"></a>Кэшированные данные в настройках уровня документа
  Основной целью настроек на уровне документа является отделение данных от представления в документах Office. Данные — это информация, которая хранится в документе, включая числа и текст. Представление ссылается на пользовательский интерфейс и объектную модель Microsoft Office Word и Microsoft Office Excel.

 Visual Studio разделяет данные из представления в настройках уровня документа, позволяя внедрять данные как *остров данных*, также называемый *кэшем данных*. Вы можете считывать или изменять данные напрямую, не запуская Word или Excel. Это полезно, если необходимо изменить данные в документах на сервере, на котором не установлен Microsoft Office. Word и Excel предназначены для использования в клиентских средах. они не предназначены для выполнения на сервере.

 [!INCLUDE[appliesto_alldoc](../vsto/includes/appliesto-alldoc-md.md)]

 Дополнительные сведения о настройках уровня документа см. в статье [Общие сведения о разработке решений Office &#40;VSTO&#41;](../vsto/office-solutions-development-overview-vsto.md) и [Архитектура настроек на уровне документа](../vsto/architecture-of-document-level-customizations.md).

## <a name="understand-the-cached-data-programming-model"></a>Общие сведения о модели программирования кэшированных данных
 Остров данных может содержать любой объект в решении, соответствующий определенным требованиям. К этим объектам относятся <xref:System.Data.DataSet> объекты, <xref:System.Data.DataTable> объекты и любые другие объекты, которые могут быть сериализованы <xref:System.Xml.Serialization.XmlSerializer> классом. Дополнительные сведения см. в разделе [кэширование данных](../vsto/caching-data.md).

 Чтобы предоставить представление для кэшированных данных, можно привязать элементы управления Windows Forms и *ведущие элементы* управления к документу к объектам в острове данных. Привязка данных между островом данных и элементами управления с привязкой к данным позволяет синхронизировать эти два элемента. Можно также добавить код проверки к данным, которые не зависят от элементов управления. Дополнительные сведения см. [в разделе Привязка данных к элементам управления в решениях Office](../vsto/binding-data-to-controls-in-office-solutions.md).

 Элементы управления ведущего приложения — это расширенные версии собственных объектов в объектных моделях Excel и Word. В отличие от собственных объектов, элементы управления ведущего приложения можно напрямую привязывать к управляемым объектам данных. Дополнительные сведения см. в разделе [Общие сведения о ведущих элементах и элементах управления ведущего приложения](../vsto/host-items-and-host-controls-overview.md) и [Windows Forms элементов управления в документах Office](../vsto/windows-forms-controls-on-office-documents-overview.md).

## <a name="access-cached-data-on-the-server"></a>Доступ к кэшированным данным на сервере
 Для доступа к кэшированным данным в документе можно использовать <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> класс. Этот класс является частью компонента [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] , и его можно использовать на сервере без запуска Excel или Word. Когда пользователь открывает документ после изменения кэшированных данных, все элементы управления, привязанные к данным, автоматически синхронизируются с изменениями, а пользователь представляет обновленные данные. Дополнительные сведения см. [в разделе доступ к данным в документах на сервере](../vsto/accessing-data-in-documents-on-the-server.md).

 Excel и Word не требуются для записи данных на сервере, только для их просмотра на клиенте. На сервере не обязательно устанавливать Excel и Word. Это обеспечивает улучшенную масштабируемость и возможность выполнения быстрой пакетной обработки документов, содержащих острова данных.

## <a name="data-caching-for-offline-use"></a>Кэширование данных для автономного использования
 Хранение данных в области данных позволяет выполнять автономные сценарии. Когда пользователь впервые открывает документ или запрашивает документ с сервера, остров данных заполняется самыми последними данными. Остров данных кэшируется в документе и затем становится доступным в автономном режиме. Пользователь (и код) может манипулировать данными, даже если активное подключение недоступно. При повторном подключении пользователя изменения данных можно распространить обратно на серверный источник данных.

## <a name="cached-data-and-custom-xml-parts-compared"></a>Сравнение кэшированных данных и пользовательских XML-частей
 Пользовательские XML-части были введены в систему 2007 Microsoft Office в качестве способа хранения произвольных фрагментов XML в документе. Хотя пользовательские XML-части полезны во многих сценариях, таких как кэш данных, существуют некоторые различия между островом данных и пользовательскими XML-частями. Дополнительные сведения о пользовательских XML-частях см. в разделе [Обзор пользовательских XML-](../vsto/custom-xml-parts-overview.md)частей.

 В следующей таблице перечислены некоторые различия и сходства.

|Вопрос или характеристика|Кэш данных|Пользовательские XML-части|
|-|----------------|----------------------|
|Какие приложения Office могут их использовать?|Настройки уровня документа для следующих приложений:<br /><br /> — Excel<br />-Слово|Решения на уровне документа и приложения для следующих приложений:<br /><br /> — Excel<br />— PowerPoint<br />-Слово|
|Какие типы данных можно хранить?|Любой открытый объект в сборке настройки, соответствующий определенным требованиям. Дополнительные сведения см. в разделе [кэширование данных](../vsto/caching-data.md).|Любые XML-данные.|
|Можно ли получить доступ к данным без запуска Microsoft Office приложений?|Да, используя класс, <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> предоставляемый [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] .|Да, с помощью классов в <xref:System.IO.Packaging> пространстве имен или с помощью пакета SDK формата Open XML.|

## <a name="see-also"></a>См. также раздел
- [Данные в решениях Office](../vsto/data-in-office-solutions.md)
- [Архитектура решений Office в Visual Studio](../vsto/architecture-of-office-solutions-in-visual-studio.md)
