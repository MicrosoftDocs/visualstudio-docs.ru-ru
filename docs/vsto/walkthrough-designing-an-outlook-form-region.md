---
title: Пошаговое руководство. Проектирование области формы Outlook
description: Узнайте, как можно спроектировать настраиваемую область формы Microsoft Outlook, которая отображается в виде новой страницы в окне инспектора элемента Contact.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- form regions [Office development in Visual Studio], creating
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 80c574799029f3fe8c4769d852886a625ffd93aa
ms.sourcegitcommit: 4b40aac584991cc2eb2186c3e4f4a7fcd522f607
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2021
ms.locfileid: "107824287"
---
# <a name="walkthrough-design-an-outlook-form-region"></a>Пошаговое руководство. Проектирование области формы Outlook
  Пользовательские области формы расширяют стандартные или настраиваемые формы Microsoft Office Outlook. В этом пошаговом руководстве показано, как проектировать пользовательскую область формы, которая отображается в виде новой страницы в окне инспектора элемента контактов. В этой области формы отображается карта каждого адреса, указанного для контакта, путем отправки информации об адресе на веб-сайт локального поиска Windows Live. Сведения о регионах форм см. в разделе [Создание областей формы Outlook](../vsto/creating-outlook-form-regions.md).

 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]

 В этом пошаговом руководстве описаны следующие задачи:

- Создание нового проекта надстройки Outlook VSTO

- Добавление области формы в проект надстройки VSTO

- Разработка макета области формы

- Настройка поведения области формы

- Тестирование области формы Outlook

> [!NOTE]
> Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. Дополнительные сведения см. в разделе [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).

## <a name="prerequisites"></a>Предварительные требования
 Для выполнения этого пошагового руководства требуются следующие компоненты:

- [!INCLUDE[vsto_vsprereq](../vsto/includes/vsto-vsprereq-md.md)]

- [!INCLUDE[Outlook_14_short](../vsto/includes/outlook-14-short-md.md)] или более поздней версии.

  ![ссылка на видео](../vsto/media/playvideo.gif "ссылка на видео") Для получения видео-версии этого раздела см. [видео руководство. Создание области формы Outlook](/previous-versions/visualstudio/visual-studio-2008/cc837160(v=vs.90)).

## <a name="create-a-new-outlook-vsto-add-in-project"></a>Создание нового проекта надстройки VSTO для Outlook
 Сначала создайте базовый проект надстройки VSTO.

### <a name="to-create-a-new-outlook-vsto-add-in-project"></a>Порядок создания нового проекта надстройки Outlook VSTO

1. В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Создайте проект надстройки VSTO для Outlook с именем **мапитаддин**.

2. В диалоговом окне **Создание проекта** выберите **Создать каталог для решения**.

3. Сохраните проект в любом каталоге.

     Дополнительные сведения см. в разделе [как создавать проекты Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).

## <a name="add-a-form-region-to-the-outlook-vsto-add-in-project"></a>Добавление области формы в проект надстройки VSTO для Outlook
 Решение надстройки Outlook VSTO может содержать один или несколько элементов области формы Outlook. Добавьте элемент области формы в проект с помощью мастера **создания области формы Outlook** .

### <a name="to-add-a-form-region-to-the-outlook-vsto-add-in-project"></a>Порядок добавления области формы в проект надстройки Outlook VSTO

1. В **Обозреватель решений** выберите проект **мапитаддин** .

2. В меню **Проект** выберите **Добавить новый элемент**.

3. В диалоговом окне **Добавление нового элемента** выберите **область формы Outlook**, присвойте файлу имя **MAPI** и нажмите кнопку **Добавить**.

     Запустится мастер **Неваутлук области формы** .

4. На странице **выберите способ создания области формы** щелкните создать **новую область формы**, а затем нажмите кнопку **Далее**.

5. На странице **выберите тип области формы, которую нужно создать** , щелкните **разделить**, а затем нажмите кнопку **Далее**.

     *Отдельная* область формы добавляет новую страницу в форму Outlook. Дополнительные сведения о типах областей формы см. в разделе [Создание областей формы Outlook](../vsto/creating-outlook-form-regions.md).

6. На странице введите **текст описания и выберите параметры отображения** , введите **Map** в поле **имя** .

     Это имя отображается на ленте окна инспектора при открытии элемента контактов.

7. Выберите **инспекторы в режиме создания** и **инспекторы в режиме чтения**, а затем нажмите кнопку **Далее**.

8. На странице " **укажите классы сообщений, которые будут отображаться в этой области формы** " снимите флажок **почтовые сообщения**, выберите **контакт** и нажмите кнопку **Готово**.

     В проект добавляется файл *MAPI. CS* или *MAPI. vb* .

## <a name="design-the-layout-of-the-form-region"></a>Разработка макета области формы
 Визуальная разработка областей форм с помощью *конструктора областей формы*. Управляемые элементы управления можно перетаскивать на поверхность конструктора областей формы. Используйте конструктор и окно **Свойства** для настройки макета и внешнего вида элемента управления.

### <a name="to-design-the-layout-of-the-form-region"></a>Порядок разработки макета области формы

1. В **Обозреватель решений** разверните проект **мапитаддин** , а затем дважды щелкните элемент *MAPI. CS* или *MAPI. vb* , чтобы открыть конструктор области формы.

2. Щелкните правой кнопкой мыши конструктор и выберите пункт **Свойства**.

3. В окне **Свойства** задайте для параметра **Размер** значение **664, 469**.

     Это гарантирует, что область формы будет достаточно большой, чтобы отображать карту.

4. В меню **Вид** выберите пункт **Область элементов**.

5. На вкладке **Общие элементы управления** **панели элементов** добавьте в область формы **браузер** .

     **Браузер** отобразит карту каждого адреса, указанного для контакта.

## <a name="customize-the-behavior-of-the-form-region"></a>Настройка поведения области формы
 Для настройки поведения области формы во время выполнения добавьте код в обработчики событий области формы. Для этой области формы код проверяет свойства элемента Outlook и определяет, следует ли отображать область формы Map It. Если область формы отображается, код переходит на веб-сайт локального поиска Windows Live и загружает карту для каждого адреса, включенного в элемент контактов Outlook.

### <a name="to-customize-the-behavior-of-the-form-region"></a>Порядок настройки поведения области формы

1. В **Обозреватель решений** щелкните правой кнопкой мыши элемент *MAPI. CS* или *MAPI. vb* и выберите команду **Просмотреть код**.

    В редакторе кода откроется *MAPI. CS* или *MAPI. vb* .

2. Разверните область кода **фабрики области формы** .

    Предоставляется класс фабрики областей формы с именем `MapItFactory`.

3. Добавьте следующий код в обработчик событий `MapItFactory_FormRegionInitializing`. Этот обработчик событий будет вызываться, когда пользователь открывает элемент контактов. Следующий код определяет, содержит ли элемент контактов адрес. Если элемент Contact не содержит адрес, этот код устанавливает <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> <xref:Microsoft.Office.Tools.Outlook.FormRegionInitializingEventArgs> для свойства класса **значение true** , а область формы не отображается. В противном случае надстройка VSTO выдает событие <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing> и отображает область формы.

    :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_Outlook_FR_Separate_O12/MapIt.cs" id="Snippet1":::
    :::code language="vb" source="../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Separate_O12/MapIt.vb" id="Snippet1":::

4. Добавьте следующий код в обработчик событий <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing>. Этот код выполняет следующие задачи:

   - Сцепляет каждый адрес в элементе контактов и создает строку URL-адреса.

   - Вызывает метод <xref:System.Windows.Forms.WebBrowser.Navigate%2A> объекта <xref:System.Windows.Forms.WebBrowser> и передает строку URL-адреса в качестве параметра.

     Веб-сайт локального поиска отображается в области формы Map It и представляет каждый адрес в тестовой области.

     :::code language="csharp" source="../vsto/codesnippet/CSharp/Trin_Outlook_FR_Separate_O12/MapIt.cs" id="Snippet2":::
     :::code language="vb" source="../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Separate_O12/MapIt.vb" id="Snippet2":::

## <a name="test-the-outlook-form-region"></a>Тестирование области формы Outlook
 При запуске проекта в Visual Studio открывается Outlook. Для просмотра области формы Map It откройте элемент контактов. Область формы Map It отображается в виде страницы в форме каждого элемента контактов, содержащего адрес.

### <a name="to-test-the-map-it-form-region"></a>Порядок тестирования области формы Map It

1. Нажмите клавишу **F5** , чтобы запустить проект.

     Открывается Outlook.

2. В Outlook на вкладке **Главная** щелкните **новые элементы**, а затем щелкните **контакт**.

3. В форме "контакт" введите **Анна Бибе** в качестве имени контакта, а затем укажите следующие три адреса.

    |Тип адреса|Адрес|
    |------------------|-------------|
    |**Рабочий телефон**|**4567. Главный, Нью-Йорк**|
    |**Корневая папка**|**1234 Северная Санкт-Йорк, Москва**|
    |**Другое**|**3456. Главный Сиэтл, штат Вашингтон**|

4. Сохраните и закройте элемент контактов.

5. Снова откройте элемент контактного лица **Анна Бибе** .

    В Outlook это можно сделать в группе **найти** , либо открыв адресную книгу для контактов, либо введя Анна Бибе в поле **Поиск людей**.

6. В группе **отобразить** на ленте элемента щелкните **подключить** , чтобы открыть область формы Map IT.

     Появляется область формы Map It, где отображается веб-сайт локального поиска. **Деловые**, **домашние** и **другие** адреса отображаются на вспомогательной панели. Выберите в тестовой области адрес, который необходимо сопоставить.

## <a name="next-steps"></a>Дальнейшие действия
 Дополнительные сведения о настройке пользовательского интерфейса приложения Outlook см. в следующих разделах.

- Дополнительные сведения о настройке ленты элемента Outlook см. в разделе [Настройка ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md).

## <a name="see-also"></a>См. также статью
- [Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)
- [Создание областей формы Outlook](../vsto/creating-outlook-form-regions.md)
- [Рекомендации по созданию областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)
- [Пошаговое руководство. импорт области формы, разработанной в Outlook](../vsto/walkthrough-importing-a-form-region-that-is-designed-in-outlook.md)
- [Как добавить область формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)
- [Связывание области формы с классом сообщений Outlook](../vsto/associating-a-form-region-with-an-outlook-message-class.md)
- [Пользовательские действия в областях формы Outlook](../vsto/custom-actions-in-outlook-form-regions.md)
- [Как запретить Outlook отображать область формы](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md)
