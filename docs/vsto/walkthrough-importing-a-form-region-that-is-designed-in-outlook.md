---
title: Пошаговое руководство. импорт области формы, разработанной в Outlook
description: Сведения о проектировании области формы в Microsoft Outlook и последующем импорте области формы в проект надстройки Outlook VSTO с помощью мастера создания области формы.
ms.custom: SEO-VS-2020
titleSuffix: ''
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- importing form regions
- form regions [Office development in Visual Studio], importing
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 4b60060f8db2bf2bb1abf42803a8c80333ee5fc0
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99969156"
---
# <a name="walkthrough-import-a-form-region-that-is-designed-in-outlook"></a>Пошаговое руководство. импорт области формы, разработанной в Outlook
  В этом пошаговом руководстве демонстрируется создание области формы в Microsoft Office Outlook, а также ее импорт в проект надстройки Outlook VSTO с помощью мастера **Создать область формы** . Создание области формы в Outlook позволяет добавить собственные элементы управления Outlook в область формы, связанную с данными Outlook. После импорта области формы можно обрабатывать события каждого элемента управления.

 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]

 В этом пошаговом руководстве описаны следующие задачи:

- создание области формы с помощью конструктора областей формы Outlook;

- импорт области формы в проект надстройки Outlook VSTO;

- обработка событий элементов управления в области формы.

  [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]

## <a name="prerequisites"></a>Предварительные требования
 Для выполнения этого пошагового руководства требуются следующие компоненты:

- [!INCLUDE[vsto_vsprereq](../vsto/includes/vsto-vsprereq-md.md)]

- [!INCLUDE[Outlook_15_short](../vsto/includes/outlook-15-short-md.md)] или [!INCLUDE[Outlook_14_short](../vsto/includes/outlook-14-short-md.md)].

> [!NOTE]
> Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. Дополнительные сведения см. в разделе [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).

## <a name="design-a-form-region-by-using-the-form-region-designer-in-outlook"></a>Создание области формы с помощью конструктора областей формы в Outlook
 На этом этапе создается область формы в Outlook. Затем необходимо сохранить область формы в доступном месте, чтобы ее можно было импортировать в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].

 Эта область формы полностью заменяет обычную форму задач. Она дает возможность отслеживать ход выполнения всех задач, которые должны быть завершены перед выполнением главной задачи (обязательные задачи). В области формы приводится список обязательных задач, а также состояние завершения каждой задачи в списке. Пользователи могут добавлять задачи в список и удалять их. Также можно обновлять состояние завершения каждой задачи.

### <a name="to-design-a-form-region-by-using-the-form-region-designer-in-outlook"></a>Создание области формы с помощью конструктора областей формы Outlook

1. Запустите приложение Microsoft Office Outlook.

2. В Outlook на вкладке **Разработчик** нажмите кнопку **Создать форму**. Дополнительные сведения см. в разделе [инструкции. Отображение вкладки разработчика на ленте](../vsto/how-to-show-the-developer-tab-on-the-ribbon.md).

3. В окне **Создать форму** выберите **Задача**, затем нажмите кнопку **Открыть**.

4. В Outlook на вкладке **Разработчик** в группе **Разработка** нажмите кнопку **Создать область формы**.

     Откроется новая область формы. Если не появится окно **Выбор полей** , нажмите **Выбор полей** в группе **Средства** .

5. Перетащите поля **Тема** и **% завершено** из окна **Выбор полей** в область формы.

6. В группе **Средства** нажмите **Набор элементов управления** , чтобы открыть **Панель элементов**.

7. Перетащите метку с **панели элементов** в область формы. Разместите метку под полями **Тема** и **% завершено** .

8. Щелкните метку правой кнопкой мыши и выберите пункт **Дополнительные свойства**.

9. В окне **Свойства** для свойства **Заголовок** задайте значение **Эта задача зависит от следующих задач**, установите для свойства **Ширина** значение **200** и нажмите кнопку **Применить**.

10. Перетащите элемент управления ListBox с **панели элементов** в область формы. Разместите список под меткой **Эта задача зависит от следующих задач** .

11. Выберите только что добавленный список.

12. В окне **Свойства** установите для свойства **Ширина** значение **300** и нажмите кнопку **Применить**.

13. Перетащите метку с **панели элементов** в область формы. Разместите метку под списком.

14. Выберите только что добавленную метку.

15. В окне **Свойства** задайте для свойства **Заголовок** значение **Выберите задачу, которую нужно добавить в список зависимых задач**, установите для свойства **Ширина** значение **200** и нажмите кнопку **Применить**.

16. Перетащите элемент управления ComboBox с **панели элементов** в область формы. Разместите поле со списком под меткой **Выберите задачу, которую нужно добавить в список зависимых задач** .

17. Выберите только что добавленное поле со списком.

18. В окне **Свойства** установите для свойства **Ширина** значение **300** и нажмите кнопку **Применить**.

19. Перетащите элемент управления CommandButton с **панели элементов** в область формы. Разместите кнопку рядом с полем со списком.

20. Выберите только что добавленную кнопку.

21. В окне **Свойства** установите для свойства **Имя** значение **AddDependentTask**, для свойства **Заголовок** — значение **Добавить зависимую задачу**, а для свойства **Ширина** — значение **100**, после чего нажмите кнопку **Применить**.

22. В окне **Выбор полей** нажмите **Создать**.

23. В диалоговом окне **Новое поле** в поле **Имя** введите **hiddenField** и нажмите кнопку **ОК**.

24. Перетащите поле **hiddenField** из окна **Выбор полей** в область формы.

25. В окне **Свойства** установите для свойства **Видимый** значение **0 — False** и нажмите кнопку **Применить**.

26. В Outlook на вкладке **Разработчик** в группе **Разработка** нажмите кнопку **Сохранить** , а затем нажмите кнопку **Сохранить область формы как**.

     Назовите область формы **TaskFormRegion** и сохраните в каталог локального компьютера.

     Outlook сохраняет область формы в виде файла хранилища форм Outlook (*. OFS*). Область формы сохраняется с именем *TaskFormRegion. OFS*.

27. Закройте Outlook.

## <a name="create-a-new-outlook-add-in-project"></a>Создание нового проекта надстройки Outlook
 В этом шаге будет создан проект надстройки VSTO для Outlook. Далее в пошаговом руководстве описывается процедура импорта области формы в проект.

### <a name="to-create-a-new-outlook-vsto-add-in-project"></a>Порядок создания нового проекта надстройки Outlook VSTO

1. В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]создайте проект надстройки VSTO для Outlook с именем **TaskAddIn**.

2. В диалоговом окне **Создание проекта** выберите **Создать каталог для решения**.

3. Сохраните проект в каталоге проекта по умолчанию.

     Дополнительные сведения см. в разделе [как создавать проекты Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).

## <a name="import-the-form-region"></a>Импорт области формы
 Мастер **Новая область формы Outlook** позволяет импортировать область формы, созданную в Outlook, в проект надстройки VSTO для Outlook.

### <a name="to-import-the-form-region-into-the-outlook-vsto-add-in-project"></a>Импорт области формы в проект надстройки VSTO для Outlook

1. В **обозревателе решений** щелкните правой кнопкой мыши проект **TaskAddIn** , наведите указатель на пункт **Добавить**, а затем выберите пункт **Новый элемент**.

2. В области **Шаблоны** выберите шаблон **Область формы Outlook**, назовите файл **TaskFormRegion** и нажмите кнопку **Добавить**.

     Запустится мастер **Неваутлук области формы** .

3. На странице **Выберите способ создания области формы** нажмите **Импортировать файл хранилища форм Outlook (.ofs)**, а затем кнопку **Обзор**.

4. В диалоговом окне **Расположение существующих файлов области формы Outlook** найдите размещение файла *TaskFormRegion.ofs*, выберите файл **TaskFormRegion.ofs**, нажмите кнопку **Открыть**, а затем кнопку **Далее**.

5. На странице **Выберите тип области формы, которую следует создать** выберите **Заменить все** и нажмите кнопку **Далее**.

     Область формы *Заменить все* заменяет всю форму Outlook. Дополнительные сведения о типах областей формы см. в разделе [Создание областей формы Outlook](../vsto/creating-outlook-form-regions.md).

6. На странице **Введите текст описания и выберите параметры отображения** нажмите кнопку **Далее**.

7. На странице **Укажите классы сообщений, в которых будет отображаться эта область формы** в поле **В каких классах пользовательских сообщений будет отображаться эта область формы?** введите **IPM.Task.TaskFormRegion**, а затем нажмите кнопку **Готово**.

     В проект добавляется файл *TaskFormRegion.CS* или *TaskFormRegion. vb* .

## <a name="handle-the-events-of-controls-on-the-form-region"></a>Обработку событий элементов управления в области формы
 После импорта области формы в проект можно добавить код, который обрабатывает событие `Microsoft.Office.Interop.Outlook.OlkCommandButton.Click` кнопки, добавленной в область формы в Outlook.

 Кроме того, можно добавить в событие <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing> код, который обновляет элементы управления в области формы при ее появлении.

### <a name="to-handle-the-events-of-controls-on-the-form-region"></a>Обработка событий элементов управления в области формы

1. В **Обозреватель решений** щелкните правой кнопкой мыши *TaskFormRegion.CS* или *TaskFormRegion. vb* и выберите пункт **Просмотреть код**.

    *TaskFormRegion.CS* или *TaskFormRegion. vb* откроется в редакторе кода.

2. Добавьте в класс `TaskFormRegion` приведенный далее код. Этот код заполняет поле со списком в области формы строкой темы каждой задачи из папки задач Outlook.

    [!code-csharp[Trin_Outlook_FR_Import#1](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Import/TaskFormRegion.cs#1)]
    [!code-vb[Trin_Outlook_FR_Import#1](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Import_O12/TaskFormRegion.vb#1)]

3. Добавьте в класс `TaskFormRegion` приведенный далее код. Этот код выполняет следующие задачи:

   - находит объект `Microsoft.Office.Interop.Outlook.TaskItem` в папке "Задачи" путем вызова вспомогательного метода `FindTaskBySubjectName` и передачи темы необходимой задачи; вспомогательный метод `FindTaskBySubjectName` будет добавлен позже;

   - добавляет значения `Microsoft.Office.Interop.Outlook.TaskItem.Subject` и `Microsoft.Office.Interop.Outlook.TaskItem.PercentComplete` в список зависимых задач.

   - добавляет тему задачи в скрытое поле области формы. Значения в скрытом поле сохраняются как часть элемента Outlook.

     [!code-csharp[Trin_Outlook_FR_Import#2](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Import/TaskFormRegion.cs#2)]
     [!code-vb[Trin_Outlook_FR_Import#2](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Import_O12/TaskFormRegion.vb#2)]

4. Добавьте в класс `TaskFormRegion` приведенный далее код. В этом коде представлен вспомогательный метод `FindTaskBySubjectName` , описанный в предыдущем шаге.

    [!code-csharp[Trin_Outlook_FR_Import#3](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Import/TaskFormRegion.cs#3)]
    [!code-vb[Trin_Outlook_FR_Import#3](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Import_O12/TaskFormRegion.vb#3)]

5. Добавьте в класс `TaskFormRegion` приведенный далее код. Этот код выполняет следующие задачи:

   - обновляет список в области формы, используя текущее состояние завершения каждой зависимой задачи;

   - выполняет синтаксический анализ скрытого текстового поля, чтобы получить тему каждой зависимой задачи; Затем он находит каждый `Microsoft.Office.Interop.Outlook.TaskItem` в папке *tasks* , вызывая `FindTaskBySubjectName` вспомогательный метод и передавая тему каждой задачи.

   - добавляет значения `Microsoft.Office.Interop.Outlook.TaskItem.Subject` и `Microsoft.Office.Interop.Outlook.TaskItem.PercentComplete` в список зависимых задач.

     [!code-csharp[Trin_Outlook_FR_Import#4](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Import/TaskFormRegion.cs#4)]
     [!code-vb[Trin_Outlook_FR_Import#4](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Import_O12/TaskFormRegion.vb#4)]

6. Замените обработчик событий `TaskFormRegion_FormRegionShowing` следующим кодом. Этот код выполняет следующие задачи:

   - заполняет поле со списком области формы темами задач при появлении области формы;

   - вызывает вспомогательный метод `RefreshTaskListBox` при появлении области формы. В этом случае отображаются зависимые задачи, добавленные в список во время предыдущего открытия элемента.

     [!code-csharp[Trin_Outlook_FR_Import#5](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Import/TaskFormRegion.cs#5)]
     [!code-vb[Trin_Outlook_FR_Import#5](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Import_O12/TaskFormRegion.vb#5)]

## <a name="test-the-outlook-form-region"></a>Тестирование области формы Outlook
 Чтобы протестировать область формы, добавьте в нее задачи из списка обязательных задач. Обновите состояние завершения обязательной задачи, а затем просмотрите обновленное состояние завершения задачи в списке обязательных задач.

### <a name="to-test-the-form-region"></a>Тестирование области формы

1. Нажмите клавишу **F5** , чтобы запустить проект.

     Запускается Outlook.

2. В Outlook на вкладке **Главная** нажмите кнопку **Новые элементы** и щелкните **Задача**.

3. В поле **Тема** формы задач введите **Зависимая задача** .

4. На вкладке ленты **задача** в группе **действия** щелкните **сохранить & закрыть**.

5. В Outlook на вкладке **Главная** нажмите кнопку **Новые элементы**, щелкните **Другие элементы** и нажмите кнопку **Выбрать форму**.

6. В диалоговом окне **Выбор формы** выберите форму **TaskFormRegion** и нажмите кнопку **Открыть**.

     Появится область формы **TaskFormRegion** . Эта форма полностью заменяет всю форму задач. Поле со списком **Выберите задачу, которую нужно добавить в список зависимых задач** заполняется другими задачами из папки "Задачи".

7. В поле **Тема** формы задач введите **Основная задача**.

8. В поле со списком **Выберите задачу, которую нужно добавить в список зависимых задач** выберите пункт **Зависимая задача**, а затем нажмите кнопку **Добавить зависимую задачу**.

     В списке **Эта задача зависит от следующих задач** появится пункт **0% завершено — Зависимая задача** . Это означает, что обработка события `Microsoft.Office.Interop.Outlook.OlkCommandButton.Click` кнопки успешно выполнена.

9. Сохраните и закройте элемент **Основная задача** .

10. Повторно откройте элемент "Зависимая задача" в Outlook.

11. В форме "Зависимая задача" измените значение поля **% завершено** на **50 %**.

12. На вкладке **задача** ленты Зависимая задача в группе **действия** щелкните **сохранить & закрыть**.

13. Повторно откройте элемент **Основная задача** в Outlook.

     В списке **Эта задача зависит от следующих задач** появится пункт **50 % завершено — Зависимая задача** .

## <a name="next-steps"></a>Дальнейшие действия
 Дополнительные сведения о настройке пользовательского интерфейса приложения Outlook см. в следующих разделах.

- Дополнительные сведения о проектировании внешнего вида области формы путем перетаскивания управляемых элементов управления на визуальный конструктор см. в разделе [Пошаговое руководство. Проектирование области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md).

- Дополнительные сведения о настройке ленты элемента Outlook см. в разделе [Настройка ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md).

- Дополнительные сведения о добавлении настраиваемой области задач в Outlook см. в разделе [настраиваемые области задач](../vsto/custom-task-panes.md).

## <a name="see-also"></a>См. также раздел
- [Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)
- [Создание областей формы Outlook](../vsto/creating-outlook-form-regions.md)
- [Рекомендации по созданию областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)
- [Пошаговое руководство. Проектирование области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md)
- [Как добавить область формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)
- [Связывание области формы с классом сообщений Outlook](../vsto/associating-a-form-region-with-an-outlook-message-class.md)
- [Пользовательские действия в областях формы Outlook](../vsto/custom-actions-in-outlook-form-regions.md)
- [Как запретить Outlook отображать область формы](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md)
