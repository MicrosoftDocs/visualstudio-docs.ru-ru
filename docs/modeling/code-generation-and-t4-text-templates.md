---
title: Создание кода и текстовые шаблоны T4
description: Узнайте, как с помощью текстового шаблона T4, который представляет собой сочетание блоков текста и логики управления, создать текстовый файл.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: overview
f1_keywords:
- VS.ToolsOptionsPages.TextTemplating.TextTemplating
helpviewer_keywords:
- generating text
- .tt files
- code generation
- text templates
- generating code
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 76714be09c38f6426626e94ee7734873c823f704
ms.sourcegitcommit: e3a364c014ccdada0860cc4930d428808e20d667
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2021
ms.locfileid: "112389778"
---
# <a name="code-generation-and-t4-text-templates"></a>Создание кода и текстовые шаблоны T4

В Visual Studio *текстовый шаблон T4* представляет собой сочетание блоков текста и логики управления, которое может создать текстовый файл. Логика управления записывается в виде фрагментов программного кода в [!INCLUDE[csprcs](../data-tools/includes/csprcs_md.md)] или [!INCLUDE[vbprvb](../code-quality/includes/vbprvb_md.md)]. В Visual Studio 2015 с обновлением 2 и более поздних версиях можно использовать функции C# версии 6.0 в директивах шаблонов T4. Созданный файл может быть текстом любого типа, например веб-страницей, файлом ресурса или исходным кодом программы на любом языке.

Существует два типа текстовых шаблонов T4: времени выполнения и времени разработки.

## <a name="run-time-t4-text-templates"></a>Текстовые шаблоны T4 времени выполнения

Шаблоны времени выполнения, также называемые предварительно обработанными, выполняются в приложении для создания текстовых строк, обычно в рамках выходных данных. Например, можно создать шаблон для определения HTML-страницы:

```
<html><body>
 The date and time now is: <#= DateTime.Now #>
</body></html>
```

обратите внимание, что шаблон напоминает созданные выходные данные. Сходство шаблона с результирующими выходными данными помогает избежать ошибок, если необходимо изменить шаблон.

Кроме того, шаблон содержит фрагменты программного кода. Эти фрагменты можно использовать для повторения разделов текста, создания условных разделов и отображения данных из приложения.

Чтобы создать выходные данные, приложение вызывает функцию, которая создается с помощью шаблона. Пример:

```csharp
string webResponseText = new MyTemplate().TransformText();
```

Приложение может выполняться на компьютере, на котором не установлена среда Visual Studio.

Чтобы создать шаблон времени выполнения, добавьте в проект файл **предварительно обработанного текстового шаблона** . Также можно добавить текстовый файл и установить для его свойства **Пользовательское средство** значение **TextTemplatingFilePreprocessor**.

Дополнительные сведения см. в статье [Создание текста во время выполнения с помощью текстовых шаблонов T4](../modeling/run-time-text-generation-with-t4-text-templates.md). Дополнительные сведения о синтаксисе шаблонов см. в статье [Написание текстового шаблона T4](../modeling/writing-a-t4-text-template.md).

## <a name="design-time-t4-text-templates"></a>Текстовые шаблоны T4 времени разработки

Шаблоны времени разработки определяют часть исходного кода и другие ресурсы приложения. Обычно используется несколько шаблонов, которые считывают данные из одного входного файла или базы данных и создают несколько файлов *CS*, *VB* или других исходных файлов. Каждый шаблон создает один файл. Они выполняются в Visual Studio или MSBuild.

Например, входными данными может быть XML-файл данных конфигурации. При редактировании XML-файла во время разработки текстовые шаблоны повторно создают соответствующую часть кода приложения. Один из шаблонов может выглядеть примерно так:

```
<#@ output extension=".cs" #>
<#@ assembly name="System.Xml" #>
<#
 System.Xml.XmlDocument configurationData = ...; // Read a data file here.
#>
namespace Fabrikam.<#= configurationData.SelectSingleNode("jobName").Value #>
{
  ... // More code here.
}
```

В зависимости от значений в XML-файле, созданный файл *CS* может выглядеть примерно так:

```
namespace Fabrikam.FirstJob
{
  ... // More code here.
}
```

Другим примером входных данных может быть диаграмма рабочих процессов в бизнес-деятельности. Когда пользователи меняют свой рабочий процесс или когда начинается работа с новыми пользователями, у которых есть другой рабочий процесс, легко пересоздать код в соответствии с новой моделью.

Шаблоны времени разработки позволяют проще и надежнее изменять конфигурацию при изменении требований. Обычно входные данные определяются в зависимости от бизнес-требований, как показано в примере рабочего процесса. Так проще обсуждать изменения с пользователями. Шаблоны времени разработки, таким образом, являются полезным инструментом гибкого процесса разработки.

Чтобы создать шаблон времени разработки, добавьте в проект файл **текстового шаблона** . Также можно добавить текстовый файл и установить для его свойства **Пользовательское средство** значение **TextTemplatingFileGenerator**.

Дополнительные сведения см. в статье [Создание кода во время разработки с помощью текстовых шаблонов T4](../modeling/design-time-code-generation-by-using-t4-text-templates.md). Дополнительные сведения о синтаксисе шаблонов см. в статье [Написание текстового шаблона T4](../modeling/writing-a-t4-text-template.md).

> [!NOTE]
> Термин *модель* иногда используется для описания данных, считываемых одним или несколькими шаблонами. Модель может быть представлена в любой форме, в виде файла или базы данных. Она не должна быть моделью UML или моделью для доменного языка. Слово "модель" просто указывает, что данные можно определить с точки зрения бизнес-концепции, а не в виде кода.

Функция преобразования текстового шаблона называется *T4*.

## <a name="see-also"></a>См. также раздел

- [Формирование кода на базе предметно-ориентированного языка](../modeling/generating-code-from-a-domain-specific-language.md)
