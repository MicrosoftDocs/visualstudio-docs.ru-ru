---
title: Отладка текстового шаблона T4
description: Чтобы выполнить отладку текстового шаблона времени разработки, сохраните файл текстового шаблона, а затем выберите пункт Отладка шаблона T4 в контекстном меню файла в обозреватель решений.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, troubleshooting
- text templates, debugging
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 6c9e4454071002e3bce8478bc825ecfddc17620f
ms.sourcegitcommit: e3a364c014ccdada0860cc4930d428808e20d667
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2021
ms.locfileid: "112385777"
---
# <a name="debugging-a-t4-text-template"></a>Отладка текстового шаблона T4
Точки останова можно задать в текстовых шаблонах. Чтобы выполнить отладку текстового шаблона времени разработки, сохраните файл текстового шаблона, а затем выберите пункт **Отладка шаблона T4** в контекстном меню файла в Обозреватель решений. Чтобы выполнить отладку текстового шаблона времени выполнения, просто отлаживать приложение, к которому он относится.

 Для отладки текстового шаблона необходимо понимать шаги процесса преобразования шаблона. На каждом шаге могут возникать ошибки различных типов. Ниже приведены действия.

|Шаг|Шаблон времени разработки: когда это происходит|Шаблон времени выполнения: когда это происходит|
|-|-|-|
|Код создается на основе текстового шаблона.<br /><br /> Ошибки в директивах, несовпадающие или неупорядоченные `<#...#>` теги.|При сохранении шаблона или вызове преобразования текста.|При сохранении шаблона или вызове преобразования текста.|
|Скомпилирован созданный код.<br /><br /> Ошибки компиляции в коде шаблона.|Сразу после предыдущего шага.|Вместе с кодом приложения.|
|Выполняется код.<br /><br /> Ошибки во время выполнения в коде шаблона.|Сразу после предыдущего шага.|Когда приложение запускается и вызывает код шаблона.|

 В большинстве случаев номера строк в коде шаблона задаются в отчете об ошибках. Когда отчет об ошибке ссылается на временное имя файла, обычно причиной является непарная скобка в коде текстового шаблона.

 Можно задать точки останова в текстовых шаблонах и выполнять отладку обычным способом.

## <a name="common-errors-and-fixes"></a>Распространенные ошибки и исправления
 В следующей таблице перечислены наиболее распространенные ошибки и их исправления.

|Сообщение об ошибке|Описание|Решение|
|-|-|-|
|Не удалось загрузить базовый класс " {0} ", от которого наследуется класс преобразования.|Происходит, если не удается найти базовый класс, указанный в `inherits` параметре в директиве template. Сообщение содержит номер строки директивы шаблона.|Убедитесь, что указанный класс существует и что сборка, в которой он существует, указана в директиве Assembly.|
|Не удалось разрешить включаемый текст для файла:{0}|Возникает, если не удается найти включаемый шаблон. Сообщение содержит имя запрошенного включаемого файла.|Убедитесь, что путь к файлу указан относительно исходного пути к шаблону или что файл находится в расположении, зарегистрированном на узле, или что имеется полный путь к файлу.|
|При инициализации объекта преобразования были сформированы ошибки. Преобразование не будет выполняться.|Происходит при сбое "Initialize ()" класса преобразования или возвращении значения false.|Код в функции Initialize () поступает из базового класса преобразования, указанного в \<#@template#> директиве, и из обработчиков директив. Ошибка, вызвавшая сбой инициализации, вероятно, находится в списке ошибок. Выясните причину сбоя. Вы можете просмотреть фактически созданный код для Initialize (), выполнив процедуры для отладки шаблона.|
|Сборке " {0} " для процессора директив " {1} " не был предоставлен набор разрешений FullTrust. Только доверенные сборки могут предоставлять обработчики директив. Этот процессор директив не будет загружен.|Происходит, когда система не предоставляет разрешения FullTrust сборке, содержащей процессор директив. Сообщение содержит имя сборки и имя процессора директив.|Убедитесь, что на локальном компьютере используются только доверенные сборки.|
|Путь " {0} " должен быть либо локальным для этого компьютера, либо частью доверенной зоны.|Возникает, когда директива директивы или сборки ссылается на файл, который не находится на локальном компьютере или в доверенной зоне сети.|Убедитесь, что каталог, в котором находятся директивы директивы или сборки, находится в доверенной зоне. Сетевой каталог в доверенной зоне можно добавить через Internet Explorer.|
|Несколько синтаксических ошибок, таких как "недопустимый токен" Catch "или" пространство имен не может напрямую содержать члены "|Слишком много закрывающих фигурных скобок в коде шаблона. Компилятор приводит к путанице с кодом стандартного поколения.|Проверьте число закрывающих фигурных скобок и квадратных скобок внутри разделителей кода.|
|Циклы или условные выражения не компилируются или не выполняются должным образом. Например: `<#if (i>10)#> Number is: <#= i #>`.<br /><br /> Этот код всегда выводит значение i. Условным является только "Number =:".|В C# всегда используйте фигурные скобки для окружающих блоков текста, внедренных в управляющие операторы.|Добавить фигурные скобки: `<#if (i>10) { #>    Number is: <#= i #><# } #>` .|
|"Слишком сложный выражение" при обработке шаблона времени разработки или компиляции шаблона среды выполнения (предварительно обработанного).<br /><br /> Visual Studio перестает работать при попытке проверки кода, созданного шаблоном среды выполнения.|Слишком длинный текстовый блок. T4 преобразует текстовые блоки в выражение объединения строк с одним строковым литералом для каждой строки шаблона. Слишком длинные текстовые блоки могут переделать ограничения на размер компилятора.|Разбейте блок Long Text блоком выражения, например:<br /><br /> `<#= "" #>`|

## <a name="warning-descriptions-and-fixes"></a>Описания и исправления предупреждений
 В следующей таблице перечислены наиболее распространенные предупреждения вместе с исправлениями, если они доступны.

|Предупреждающее сообщение|Описание|Решение|
|-|-|-|
|При загрузке включаемого файла " {0} " возвращена пустая строка или значение null.|Происходит, если включенный файл текстового шаблона пуст. Сообщение содержит имя файла включаемого файла.|Удалите директиву include или убедитесь, что файл имеет некоторое содержимое.|
|Компиляция преобразования:|Добавляет эту строку в начало всех ошибок или предупреждений, исходящих от компилятора при компиляции преобразования. Эта строка означает, что компилятор выдал ошибку или предупреждение.|Если у вас возникла проблема с поиском библиотеки DLL, может потребоваться указать полный или полное строгое имя, если библиотека DLL находится в глобальном кэше сборок.|
|Параметр " {0} " уже существует в директиве. Дублирующийся параметр будет проигнорирован.|Происходит, когда параметр указан в директиве несколько раз. Сообщение содержит имя параметра и номер строки директивы.|Удалите параметр повторяющейся спецификации.|
|При загрузке включаемого файла "" произошла ошибка {0} . Директива include будет пропущена.|Происходит, когда не удается найти файл, указанный в `include` директиве. Сообщение содержит имя файла и номер строки директивы.|Убедитесь, что включаемый файл существует либо в том же каталоге, что и исходный файл шаблона текста, либо в одном из каталогов включения, зарегистрированных на узле.|
|Для класса преобразования указан недопустимый базовый класс. Базовый класс должен быть производным от Microsoft. VisualStudio. TextTemplating. TextTransformation.|Происходит, когда `inherits` параметр в директиве template указывает класс, который не наследует от `TextTransformation` . Сообщение содержит номер строки директивы шаблона.|Укажите класс, производный от `TextTransformation` .|
|В директиве "Template" указан недопустимый язык и региональные параметры. Язык и региональные параметры должны иметь формат "XX-XX". Будут использоваться инвариантные язык и региональные параметры.|Происходит при неправильном указании параметра culture в директиве шаблона. Сообщение содержит номер строки директивы шаблона.|Измените параметр culture на допустимый язык и региональные параметры в формате "XX-XX".|
|{0}В директиве template указано недопустимое значение отладки "". Значение отладки должно быть либо "true", либо "false". Будет использоваться значение по умолчанию "false".|Происходит при `debug` неправильном указании параметра в директиве шаблона. Сообщение содержит номер строки директивы шаблона.|Задайте для параметра отладки значение "true" или "false".|
|{0}В директиве template указано недопустимое значение hostspecific "". Значение HostSpecific должно быть либо "true", либо "false". Будет использоваться значение по умолчанию "false".|Происходит, когда параметр конкретного узла в `template` директиве указан неправильно. Сообщение содержит номер строки директивы шаблона.|Задайте для параметра конкретного узла значение "true" или "false".|
|{0}В директиве template указан недопустимый язык "". Язык должен быть либо "C#", либо "VB". Будет использоваться значение по умолчанию "C#".|Происходит, когда в директиве указан неподдерживаемый язык `template` . Разрешены только "C#" или "VB" (без учета регистра). Сообщение содержит номер строки директивы шаблона.|Задайте `language` для параметра в директиве шаблона значение "C#" или "VB".|
|В шаблоне найдено несколько выходных директив. Все, кроме первого, будет игнорироваться.|Происходит при `output` указании нескольких директив в файле шаблона. Сообщение содержит номер строки для повторяющейся директивы Output.|Удалите дубликаты `output` директив.|
|В шаблоне найдено несколько директив шаблона. Все, кроме первого, будет игнорироваться. Несколько параметров директивы template должны быть указаны в одной директиве шаблона.|Происходит при указании нескольких `template` директив в файле текстового шаблона (включая включенные файлы). Сообщение содержит номер строки для директивы повторяющегося шаблона.|Объединить различные `template` директивы в одну `template` директиву.|
|Не указан процессор для директивы с именем " {0} ". Директива будет пропущена.|Происходит при указании `custom` директивы, но не предоставляет `processor` атрибут. Сообщение содержит имя директивы и номер строки.|Укажите `processor` атрибут с именем `directive` процессора для директивы.|
|Не удалось найти процессор с именем " {0} " для директивы с именем " {1} ". Директива будет пропущена.|Возникает, когда системе не удается найти `directive` процессор, указанный в `custom` директиве. Сообщение содержит имя директивы, имя процессора и номер строки директивы.|Присвойте `processor` атрибуту в директиве имя процессора директив.|
|Не найден обязательный параметр " {0} " для директивы " {1} ". Директива будет пропущена.|Происходит, когда система не предоставляет обязательный параметр директивы. Сообщение содержит имя отсутствующего параметра, имя директивы и номер строки.|Укажите отсутствующий параметр.|
|Процессор с именем " {0} " не поддерживает директиву с именем " {1} ". Директива будет пропущена.|Происходит, когда процессор директив не поддерживает директиву. Сообщение содержит имя и номер строки директивы, вызвавшей ошибку, а также имя обработчика директив.|Исправьте имя директивы.|
|Директива include для файла " {0} " приводит к бесконечному циклу.|Отображается, если указаны циклические директивы include (например, файл A включает файл B, включающий файл A).|Не указывайте циклические директивы include.|
|Выполнение преобразования:|Добавляет эту строку в начало всех ошибок или предупреждений, формируемых при выполнении преобразования.|Не применяется|
|В блоке обнаружен непредвиденный начальный или конечный тег. Убедитесь, что вы не настроили начальный или конечный тег и у вас нет вложенных блоков в шаблоне.|Отображается при возникновении непредвиденного \<# or #> . Это значит, что при наличии \<# after another open tag that has not been closed, or you have a #> незакрытого открывающего тега. Сообщение содержит номер строки несовпадающего тега.|Удалите непарный открывающий или закрывающий тег или используйте escape-символ.|
|Директива была указана в неправильном формате. Директива будет пропущена. Укажите директиву в формате. `<#@ name [parametername="parametervalue"]*  #>`|Отображается средством синтаксического анализа, если директива не указана в правильном формате. Сообщение содержит номер строки неправильной директивы.|Убедитесь, что все директивы находятся в форме `<#@ name [parametername="parametervalue"]*  #>` . Дополнительные сведения см. в разделе [директивы текстового шаблона T4](../modeling/t4-text-template-directives.md).|
|Не удалось загрузить сборку " {0} " для зарегистрированного обработчика директив " {1} "<br /><br /> {2}|Происходит, когда узел не может загрузить процессор директив. Сообщение идентифицирует сборку, предоставленную для процессора директив, и имя процессора директив.|Убедитесь, что процессор директив зарегистрирован правильно и сборка существует.|
|Не удалось найти тип " {0} " в сборке " {1} " для зарегистрированного обработчика директив " {2} "<br /><br /> {3}|Происходит, когда тип процессора директив не может быть загружен из его сборки. Сообщение содержит имя типа, сборки и обработчика директив.|Vshost находит сведения о процессоре директив (имя, сборку и тип) в реестре. Убедитесь, что процессор директив зарегистрирован правильно, и что этот тип существует в сборке.|
|Возникла проблема при загрузке сборки " {0} "|Происходит при возникновении проблемы при загрузке сборки. Сообщение содержит имя сборки.|Можно указать сборки для загрузки в \<@#assembly#> директивах и процессорах директив. Сообщение об ошибке, следующее за этой строкой, должно предоставить дополнительные данные о том, почему не удалось загрузить сборку.|
|Возникла проблема при создании и инициализации процессора для директивы с именем " {1} ". Тип процессора — {0} . Директива будет пропущена.|Возникает, когда системе не удалось создать или инициализировать обработчик директив. Сообщение содержит имя и номер строки директивы, а также тип процессора.|Убедитесь, что используется правильный обработчик директив и что обработчик директив имеет открытый конструктор по умолчанию. В противном случае используйте параметры отладки, чтобы выяснить причину сбоя метода Initialize () процессора директив. Дополнительные сведения см. в разделе [Устранение неполадок в текстовых шаблонах](../modeling/debugging-a-t4-text-template.md).|
|Возникло исключение при обработке директивы с именем " {0} ".|Происходит, когда обработчик директив создает исключение при обработке директивы.|Убедитесь, что параметры обработчика директив верны.|
|Узел вызвал исключение при попытке разрешить ссылку на сборку " {0} ".|Происходит, когда узел создает исключение при попытке разрешить ссылку на сборку. Сообщение содержит строку ссылки на сборку.|Ссылки на сборки берутся из \<@#assembly#> директив и обработчиков директив. Убедитесь, что в параметре сборки указан правильный параметр "Name".|
|Попытка указать неподдерживаемое {1} значение " {0} " для директивы {2}|Возникает при использовании Рекуиреспровидесдирективепроцессор (все созданные обработчики директив являются производными от него), при указании неподдерживаемого аргумента Requires или предоставит.|Убедитесь, что имена в парах Name = "value", указанные в параметре Requires и, предоставляют правильные параметры.|
