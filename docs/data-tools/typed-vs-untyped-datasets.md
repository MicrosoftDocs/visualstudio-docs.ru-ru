---
title: Типизированные и нетипизированные наборы данных
description: Изучите разницу между типизированными и нетипизированными наборами данных. Сравните доступ к данным в типизированных и нетипизированных наборах данных.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
ms.assetid: c83ba0bb-5425-4d47-8891-6b4dbf937701
author: ghogen
ms.author: ghogen
manager: jmartens
ms.workload:
- data-storage
ms.openlocfilehash: daf4f722eb51a08e7a6ddb287e5b54956ecdfe73
ms.sourcegitcommit: 80fc9a72e9a1aba2d417dbfee997fab013fc36ac
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2021
ms.locfileid: "106216024"
---
# <a name="typed-vs-untyped-datasets"></a>Типизированные и нетипизированные наборы данных
Типизированный набор данных — это набор данных, который сначала является производным от базового <xref:System.Data.DataSet> класса, а затем использует сведения из **Конструктор наборов данных**, которые хранятся в XSD-файле, для создания нового строго типизированного класса DataSet. Сведения из схемы (таблицы, столбцы и т. д.) создаются и компилируются в этот новый класс DataSet в виде набора объектов и свойств первого класса. Поскольку типизированный набор данных наследуется от базового <xref:System.Data.DataSet> класса, типизированный класс предполагает все функциональные возможности <xref:System.Data.DataSet> класса и может использоваться с методами, принимающими экземпляр <xref:System.Data.DataSet> класса в качестве параметра.

Нетипизированный набор данных, напротив, не имеет соответствующей встроенной схемы. Как и в типизированном наборе данных, нетипизированный набор данных содержит таблицы, столбцы и т. д., но они доступны только в виде коллекций. (Однако после создания вручную таблиц и других элементов данных в нетипизированном наборе данных можно экспортировать структуру набора данных в виде схемы с помощью метода набора данных <xref:System.Data.DataSet.WriteXmlSchema%2A> .)

## <a name="contrast-data-access-in-typed-and-untyped-datasets"></a>Сравните доступ к данным в типизированных и нетипизированных наборах данных
Класс для типизированного набора данных имеет объектную модель, в которой ее свойства принимают фактические имена таблиц и столбцов. Например, при работе с типизированным набором данных можно ссылаться на столбец с помощью следующего кода:

:::code language="csharp" source="../snippets/csharp/VS_Snippets_VBCSharp/VbRaddataDatasets/CS/Form1.cs" id="Snippet4":::
:::code language="vb" source="../snippets/visualbasic/VS_Snippets_VBCSharp/VbRaddataDatasets/VB/Form1.vb" id="Snippet4":::

В отличие от этого, при работе с нетипизированным набором данных эквивалентный код будет следующим:

:::code language="csharp" source="../snippets/csharp/VS_Snippets_VBCSharp/VbRaddataDatasets/CS/Form1.cs" id="Snippet5":::
:::code language="vb" source="../snippets/visualbasic/VS_Snippets_VBCSharp/VbRaddataDatasets/VB/Form1.vb" id="Snippet5":::

Типизированный доступ не только упрощает чтение, но и полностью поддерживается технологией IntelliSense в **редакторе кода** Visual Studio. Помимо упрощения работы с, синтаксис типизированного набора данных обеспечивает проверку типов во время компиляции, что значительно сокращает вероятность ошибок при присвоении значений элементам набора данных. Если изменить имя столбца в <xref:System.Data.DataSet> классе, а затем скомпилировать приложение, появится сообщение об ошибке сборки. Дважды щелкнув ошибку сборки в **список задач**, можно перейти непосредственно к строке или строкам кода, ссылающимся на старое имя столбца. Доступ к таблицам и столбцам в типизированном наборе данных также выполняется немного быстрее во время выполнения, так как доступ определяется во время компиляции, а не через коллекции во время выполнения.

Несмотря на то, что типизированные наборы данных имеют много преимуществ, нетипизированный DataSet полезен в различных обстоятельствах. Самый очевидный сценарий — отсутствие схемы, доступной для набора данных. Это может произойти, например, если приложение взаимодействует с компонентом, который возвращает набор данных, но вы заранее не знакомы с его структурой. Аналогично, иногда при работе с данными, не имеющими статической, прогнозируемой структуры. В этом случае нецелесообразно использовать типизированный набор данных, так как придется повторно создавать типизированный класс DataSet с каждым изменением в структуре данных.

Чаще всего существует много случаев, когда можно создать набор данных динамически, не имея доступной схемы. В этом случае набор данных является просто удобной структурой, в которой можно хранить сведения, если данные могут быть представлены реляционным способом. В то же время можно воспользоваться возможностями набора данных, такими как возможность сериализации данных для передачи в другой процесс или записи XML-файла.

## <a name="see-also"></a>См. также раздел

- [Инструменты набора данных](../data-tools/dataset-tools-in-visual-studio.md)
