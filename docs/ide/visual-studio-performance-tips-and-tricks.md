---
title: Советы по повышению производительности
description: Узнайте, как оптимизировать некоторые функции Visual Studio, которые не используются, для повышения производительности.
ms.custom: SEO-VS-2020
ms.date: 03/02/2021
ms.topic: conceptual
author: TerryGLee
ms.author: tglee
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 5e2187426fbd2e8892d41672c1cf682ed0b93592
ms.sourcegitcommit: 5654b7a57a9af111a6f29239212d76086bc745c9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101683768"
---
# <a name="visual-studio-performance-tips-and-tricks"></a>Советы и рекомендации по улучшению работы Visual Studio

Рекомендации по повышению производительности Visual Studio предназначены для редких ситуаций, когда может возникать нехватка памяти. В таких случаях можно оптимизировать определенные компоненты Visual Studio, которые могут не использоваться. Приведенные ниже советы не следует рассматривать как общие рекомендации.

> [!NOTE]
> Если при работе с продуктом у вас возникают затруднения из-за проблем с памятью, свяжитесь с нами через [средство обратной связи](../ide/how-to-report-a-problem-with-visual-studio.md).

## <a name="use-a-64-bit-os"></a>Использование 64-разрядной ОС

При переходе с 32-разрядной на 64-разрядную версию Windows вы увеличиваете объем виртуальной памяти, доступной Visual Studio, с 2 до 4 ГБ. Это позволяет Visual Studio обрабатывать значительно большие рабочие нагрузки даже несмотря на то, что это 32-разрядный процесс.

Дополнительные сведения см. в разделах [Ограничения памяти](/windows/desktop/Memory/memory-limits-for-windows-releases) и [Использование /LARGEADDRESSAWARE в 64-разрядной версии Windows](https://blogs.msdn.microsoft.com/oldnewthing/20050601-24/?p=35483/).

## <a name="disable-automatic-file-restore"></a>Отключение автоматического восстановления файлов

Visual Studio автоматически повторно открывает документы, открытые во время предыдущего сеанса. Это может увеличить время загрузки решения до 30 % или более в зависимости от типа проекта и открываемых документов. Конструкторы, например Windows Forms и XAML, и некоторые файлы JavaScript и typescript могут открываться медленно.

Visual Studio отображает уведомление на желтой панели, если автоматическое восстановление документа значительно замедляет загрузку решения. Вы можете отключить автоматическое повторное открытие файлов, выполнив следующие действия.

1. Выберите пункты меню **Сервис** > **Параметры**, чтобы открыть диалоговое окно **Параметры**.

1. На странице **Проекты и решения** > **Общие** отмените выбор пункта **Повторно открыть документы при загрузке решения**.

Если отключить автоматическое восстановление файлов, быстро перейти к нужным файлам можно с помощью одной из команд [Перейти к](../ide/go-to.md):

- Чтобы использовать общие функции **Перейти к**, выберите **Изменить** > **Перейти к** > **Перейти ко всем** или нажмите  **CTRL**+**T**.

- Перейдите к последней правке в решении, выбрав **Изменить** > **Перейти к** > **Перейти к последнему изменению** или нажав **CTRL**+**SHIFT**+**BACKSPACE**.

- Используйте **Перейти к последнему файлу**, чтобы просмотреть список недавно просмотренных файлов в решении. Выберите **Изменить** > **Перейти к** > **Перейти к последнему файлу** или нажмите **CTRL**+**1**, **CTRL**+**R**.

## <a name="configure-debugging-options"></a>Настройка параметров отладки

Если вы часто сталкиваетесь с нехваткой памяти во время сеансов отладки, можно оптимизировать производительность, внеся одно или несколько изменений в конфигурацию.

- **Включение функции "Только мой код"**

    Простейшая оптимизация заключается в том, чтобы включить функцию **Только мой код**, которая загружает только символы для проекта. Включение этой функции может привести к значительной экономии памяти при отладке управляемых приложений (.NET). Для некоторых типов проектов этот параметр уже включен по умолчанию.

    Чтобы включить функцию **Только мой код**, выберите **Сервис** > **Параметры** > **Отладка** > **Общие** и затем **Включить только мой код**.

- **Указание символов для загрузки**

    При отладке машинного кода для загрузки файлов символов ( *.pdb*) требуется большой объем памяти. Вы можете настроить параметры отладочных символов для экономии памяти. Как правило, решение настраивается для загрузки только модулей из проекта.

    Чтобы указать загрузку символов, выберите **Сервис** > **Параметры** > **Отладка** > **Символы**.

    Задайте параметр **Только указанные модули** вместо **Все модули** и затем укажите, какие модули нужно загружать. Во время отладки также можно щелкнуть определенные модули правой кнопкой мыши в окне **Модули**, чтобы явно включить модуль в загрузку символов. (Чтобы открыть окно во время отладки, выберите **Отладка** > **Окна** > **Модули**.)

    Дополнительные сведения см. в разделе [Общие сведения о файлах символов](?view=vs-2019&preserve-view=true).

- **Отключение средств диагностики**

    Рекомендуется отключить профилирование ЦП после использования. Эта функция может потреблять очень много ресурсов. После включения профилирования ЦП это состояние распространяется и на все последующие сеансы отладки, поэтому его следует отключать явным образом. Вы можете сэкономить ресурсы, отключив средства диагностики при отладке, если некоторые предоставляемые функции вам не нужны.

    Для отключить **Средства диагностики**, запустите сеанс отладки, выберите **Средства** > **Параметры** > **Отладка** > **Общие** и снимите флажок **Включить средства диагностики при отладке**.

    Дополнительные сведения см. в статье [Средства профилирования](../profiling/profiling-feature-tour.md).

## <a name="disable-tools-and-extensions"></a>Отключение инструментов и расширений

Для повышения производительности можно отключить некоторые инструменты или расширения.

> [!TIP]
> Часто проблемы производительности можно выявить, отключая расширения по одному и проверяя уровень производительности.

### <a name="managed-language-service-roslyn"></a>Управляемые службы языка (Roslyn)

Сведения о производительности .NET Compiler Platform ("Roslyn") см. в статье [Особенности производительности для крупных решений](https://github.com/dotnet/roslyn/blob/master/docs/wiki/Performance-considerations-for-large-solutions.md).

- **Отключение полного анализа решения**

    Visual Studio проводит анализ всего решения, чтобы предоставить более полную информацию об ошибках перед началом сборки. Эта функция полезна для максимально быстрого выявления ошибок. Однако в случае крупных решений она может потреблять значительный объем ресурсов. При возникновении нехватки памяти или аналогичных проблем можно отключить эту функцию, чтобы освободить ресурсы. По умолчанию этот параметр включен для Visual Basic и отключен для C#.

    Чтобы отключить **Полный анализ решения**, выберите пункты меню **Сервис** > **Параметры** > **Текстовый редактор**, а затем — **Visual Basic** или **C#** . Выберите пункт **Дополнительно** и отмените выбор параметра **Включить полный анализ решения**.

- **Отключение CodeLens**

    Visual Studio выполняет задачу **Найти все ссылки** для каждого метода при его отображении. CodeLens предоставляет такие функции, как встроенное отображение числа ссылок. Эта работа выполняется в отдельном процессе, например *ServiceHub.RoslynCodeAnalysisService32*. В крупных решениях или системах с небольшим объемом ресурсов эта функция может значительно снижать производительность. В случае возникновения проблем с памятью, например при загрузке большого решения на компьютере с 4 ГБ памяти или высокой загрузки ЦП при выполнении этого процесса, попробуйте отключить CodeLens для высвобождения ресурсов.

    Чтобы отключить **CodeLens**, выберите **Сервис** > **Параметры** > **Текстовый редактор** > **Все языки** > **CodeLens** и отмените выбор данной функции.

    > [!NOTE]
    > Функция CodeLens доступна в выпусках Visual Studio Professional и Enterprise.

### <a name="other-tools-and-extensions"></a>Другие инструменты и расширения

- **Отключение расширений**

    Расширения — это дополнительные программные компоненты в Visual Studio, которые предоставляют новые или расширяют имеющиеся функциональные возможности. Расширения часто могут выступать источником проблем с памятью. При возникновении подобных проблем попробуйте отключать расширения по одному за раз, чтобы оценить, как это влияет на сценарий или рабочий процесс.

   ::: moniker range="vs-2017"

    Чтобы отключить расширения, перейдите в раздел **Сервис** > **Расширения и обновления** и отключите нужное расширение.

   ::: moniker-end

   ::: moniker range=">=vs-2019"

    Чтобы отключить расширения, перейдите в меню **Расширение** > **Управление расширениями** и отключите нужное расширение.

   ::: moniker-end

- **Отключение режима карты**

    В [**режиме карты**](how-to-track-your-code-by-customizing-the-scrollbar.md#display-modes) на полосе прокрутки показывается миниатюрное изображение строк кода. Режим карты включен по умолчанию.

    Чтобы отключить режим карты, последовательно выберите **Инструменты** > **Параметры** > **Текстовый редактор** > **Все языки** > **Полосы прокрутки**, а затем в разделе **Поведение** снимите флажок **Использовать режим карты для вертикальной полосы прокрутки**.

- **Отключение переноса по словам**

    При включенном [**переносе по словам**](./reference/how-to-manage-word-wrap-in-the-editor.md) отображается часть длинной строки кода, выступающая за пределы текущей ширины окна редактора кода. Перенос по словам включен по умолчанию.

    Чтобы отключить перенос по словам для проекта, над которым вы работаете в текущий момент, последовательно выберите в меню пункты **Правка** > **Дополнительно** > **Перенос по словам**. (Этот параметр можно переключать с помощью одних и тех же команд меню.)

    Чтобы отключить перенос по словам для всех проектов, последовательно выберите в меню пункты **Инструменты** > **Параметры** > **Общие** > **Текстовый редактор** > **Все языки** > **Общие**, а затем в разделе **Параметры** снимите флажок **Перенос по словам**.

- **Отключение конструктора XAML**

    Конструктор XAML по умолчанию включен, но потребляет ресурсы только при открытии файла *.xaml*. Если вы работаете с XAML-файлами, но не хотите использовать функциональные возможности конструктора, отключите его, чтобы освободить память.

    Чтобы отключить конструктор XAML, последовательно выберите в меню пункты **Инструменты** > **Параметры** > **Конструктор XAML** > **Включить конструктор XAML**, а затем снимите этот флажок.

- **Удаление рабочих нагрузок**

    Если вы не собираетесь использовать определенные рабочие нагрузки, удалите их с помощью установщика Visual Studio. Это позволяет оптимизировать расходы ресурсов при запуске и выполнении за счет пропуска ненужных пакетов и сборок.

- **Добавление неотслеживаемых файлов в локальный файл .gitignore**

    Visual Studio выполняет команду Git `git status` для неотслеживаемых файлов, чтобы вам было удобно добавлять новые файлы в репозиторий. При наличии большого количества неотслеживаемых файлов `git status` может потреблять большой объем памяти. Чтобы сделать эти файлы игнорируемыми и повысить производительность `git status`, можно добавить такие файлы или папки в локальный файл .gitignore. Чтобы получить доступ к файлу, выберите **Git** > **Параметры** > **Параметры репозитория Git**. Затем в разделе **файлы Git** щелкните **Добавить**, чтобы создать файл .gitignore, или щелкните **изменить**, если он у вас уже есть.

## <a name="force-a-garbage-collection"></a>Принудительная сборка мусора

Среда CLR использует систему управления памятью, подразумевающую сборку мусора. В этой системе память иногда используется объектами, которые больше не нужны. Это временное состояние — сборщик мусора освободит эту память, основываясь на своей эвристике производительности и использования ресурсов. Вы можете заставить среду CLR собрать всю неиспользуемую память, используя сочетание клавиш в Visual Studio. Если имеется значительный объем мусора, ожидающего сборки, то принудительная сборка мусора позволяет снизить использование памяти процессом *devenv.exe* в **диспетчере задач**. Потребность в этом методе возникает довольно редко. Тем не менее после завершения операции, потребляющей много ресурсов (такой как полная сборка, сеанс отладки или событие открытия решения), он может помочь определить объем памяти, действительно используемый процессом. Так как среда Visual Studio является смешанной (управляемый и машинный код), собственный распределитель и сборщик мусора могут конкурировать за ограниченные ресурсы памяти. В условиях высокого использования памяти это может помочь принудительно запустить сборщик мусора.

Чтобы принудительно запустить сборку мусора, используйте сочетание клавиш: **CTRL**+**ALT**+**SHIFT**+**F12**, **CTRL**+**ALT**+**SHIFT**+**F12** (нажмите два раза).

Если принудительная сборка мусора обеспечивает работоспособность сценария, направьте отчет с помощью средства обратной связи Visual Studio, так как подобное поведение, скорее всего, указывает на ошибку.

Подробное описание сборщика мусора CLR см. в статье [Основы сборки мусора](/dotnet/standard/garbage-collection/fundamentals).

## <a name="see-also"></a>См. также раздел

- [Оптимизация производительности Visual Studio](../ide/optimize-visual-studio-performance.md)
- [Быстрая загрузка решений (блог по Visual Studio)](https://devblogs.microsoft.com/visualstudio/load-solutions-faster-with-visual-studio-2017-version-15-6/)