---
title: Диагностика неработающих ссылок
description: Узнайте, как устранять неполадки в неработающих ссылках, которые могут быть вызваны чем-то другим, кроме невозможности приложений найти указанный компонент.
ms.custom: SEO-VS-2020
ms.date: 03/21/2017
ms.topic: troubleshooting
helpviewer_keywords:
- C# projects, references
- Visual Basic projects, references
- troubleshooting references
- referencing files from projects
- referencing components, troubleshooting
author: TerryGLee
ms.author: tglee
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 75e4d04641d593d8ced0c696cdca1efffd95e48d
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99971509"
---
# <a name="troubleshoot-broken-references"></a>Диагностика неработающих ссылок

Если ваше приложение пытается использовать неработающую ссылку, создается ошибка исключения. Неспособность найти компонент, на который указывает ссылка, является явным признаком ошибки, однако есть несколько ситуаций, в которых ссылка считается нерабочей. Эти варианты показаны в приведенном ниже списке:

- Неверный или неполный путь для ссылок проекта.

- Файл, на который указывает ссылка, удален.

- Файл, на который указывает ссылка, переименован.

- Сбой подключения к сети или проверки подлинности.

- Ссылка указывает на COM-компонент, который не установлен на данном компьютере.

Ниже приведены способы устранения этих проблем.

> [!NOTE]
> Ссылки на файлы в сборках задаются по абсолютным путям в файле проекта. Таким образом, в локальном окружении пользователей, работающих с несколькими разработчиками, может отсутствовать сборка, на которую указывает ссылка. Чтобы избежать этих ошибок, в таких случаях лучше добавлять ссылки между проектами. Дополнительные сведения см. в разделе [Программирование с использованием сборок](/dotnet/framework/app-domains/programming-with-assemblies).

## <a name="reference-path-is-incorrect"></a>Неправильный путь для ссылок

Если проекты используются совместно на разных компьютерах, некоторые ссылки могут быть не найдены, если компонент находится на этих компьютерах в разных папках. Ссылки сохраняются под именем файла компонента (например, *MyComponent*). Когда в проект добавляется ссылка, расположение папки для файла компонента (например, *C:\MyComponents*) добавляется к свойству проекта **ReferencePath**.

При открытии проект пытается найти эти файлы указанных компонентов, выполняя поиск в каталогах по пути для ссылок. Если проект открывается на компьютере, где компонент находится в другом каталоге, например в *D:\MyComponents*, найти ссылку не удается, и в **списке задач** отображается сообщение об ошибке.

Чтобы устранить эту проблему, можно удалить неработающую ссылку и заменить в диалоговом окне **Добавление ссылки**. Другое решение заключается в том, чтобы использовать элемент **Путь для ссылок** на страницах свойств проекта и изменить папки в списке, указав правильное расположение. Свойство **Путь для ссылок** сохраняется для каждого пользователя на каждом компьютере. Таким образом, изменение пути для ссылок не затрагивает других пользователей проекта.

> [!TIP]
> Ссылки между проектами лишены подобных проблем. Поэтому по мере возможности следует использовать их вместо ссылок на файлы.

### <a name="to-fix-a-broken-project-reference-by-correcting-the-reference-path"></a>Исправление неработающей ссылки проекта с помощью исправления пути для ссылок

1. В **обозревателе решений** щелкните правой кнопкой мыши узел проекта и выберите пункт **Свойства**.

   Открывается **конструктор проектов**.

1. Если вы используете Visual Basic, выберите страницу **Ссылки** и нажмите кнопку **Пути для ссылок**. В диалоговом окне **Пути для ссылок** введите путь к папке с элементом, на который нужно сослаться, в поле **Папка**, а затем нажмите кнопку **Добавить папку**.

    Если вы используете C#, выберите страницу **Пути для ссылок**. В поле **Папка** введите путь к папке с элементом, на который нужно сослаться, а затем нажмите кнопку **Добавить папку**.

## <a name="referenced-file-has-been-deleted"></a>Файл, на который указывает ссылка, удален.

Вполне возможно, что файл, на который указывает ссылка, был удален и больше не существует на диске.

### <a name="to-fix-a-broken-project-reference-for-a-file-that-no-longer-exists-on-your-drive"></a>Исправление неработающей ссылки проекта для файла, который больше не существует на диске

- Удалите ссылку.

- Если ссылка находится в другом расположении на компьютере, считайте ее оттуда.

## <a name="referenced-file-has-been-renamed"></a>Файл, на который указывает ссылка, переименован.

Файл, на который указывает ссылка, мог быть переименован.

### <a name="to-fix-a-broken-reference-for-a-file-that-has-been-renamed"></a>Исправление неработающей ссылки, указывающую на переименованный файл

- Удалите ссылку, а затем добавьте ссылку на переименованный файл.

- Если ссылка находится в другом расположении на компьютере, нужно считать ее оттуда.

## <a name="network-connection-or-authentication-has-failed"></a>Сбой подключения к сети или проверки подлинности

Недоступность файлов может быть вызвана несколькими возможными причинами, например ошибкой сетевого соединения или ошибкой проверки подлинности. В каждом отдельном случае могут использоваться уникальные средства восстановления. Например, вам может потребоваться обратиться к локальному администратору для получения доступа к необходимым ресурсам. Однако удаление ссылки и изменение использующего ее кода работает всегда.

## <a name="com-component-is-not-installed-on-computer"></a>На компьютере не установлен COM-компонент.

Если пользователь добавил ссылку на COM-компонент, а другой пользователь пытается выполнить этот код на компьютере, где этот компонент не установлен, второй пользователь получит сообщение о неработающей ссылке. Для исправления ошибки достаточно установить этот компонент на втором компьютере. Дополнительные сведения об использовании ссылок на COM-компоненты в проектах см. в разделе [COM-взаимодействие в приложениях .NET Framework](/dotnet/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications).

## <a name="see-also"></a>См. также раздел

- [Страница "Ссылки" в конструкторе проектов (Visual Basic)](../ide/reference/references-page-project-designer-visual-basic.md)
