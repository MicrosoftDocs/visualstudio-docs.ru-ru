---
title: Применение обновлений администратора к Visual Studio с помощью Microsoft Endpoint Configuration Manager
titleSuffix: ''
description: Узнайте, как применить обновления администратора к Visual Studio.
ms.date: 04/16/2021
ms.custom: ''
ms.topic: overview
ms.assetid: 9a3fdb28-db3d-4970-bc17-7417a985f0fb
author: j-martens
ms.author: jmartens
manager: jmartens
ms.workload:
- multiple
ms.prod: visual-studio-windows
ms.technology: vs-installation
ms.openlocfilehash: c18c460ebcffdba93279aafec2f3d76503ab2383
ms.sourcegitcommit: 5fb4a67a8208707e79dc09601e8db70b16ba7192
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "112307691"
---
# <a name="applying-administrator-updates-that-use-microsoft-endpoint-configuration-manager"></a>Применение обновлений администратора с использованием Microsoft Endpoint Configuration Manager

В этом документе описаны различные типы и характеристики обновлений администратора Visual Studio. Ниже приведены сведения о том, как и когда их следует распространять в вашей организации, какие параметры конфигурации доступны и как просматривать отчеты и устранять неполадки. Дополнительные сведения о предварительных требованиях к использованию обновлений администратора см. в статье [Включение обновлений администратора](../install/enabling-administrator-updates.md). Обновления администратора предполагают, что на компьютере уже установлена среда Visual Studio. Применение обновлений администратора не запускает новый процесс установки.

## <a name="understanding-visual-studio-administrator-updates"></a>Основные сведения об обновлениях администратора

Пакет обновлений администратора Visual Studio, который публикуется в Центре обновления Майкрософт для использования в каталоге Майкрософт и WSUS, содержит сведения, необходимые диспетчеру конфигураций для скачивания и распространения обновления Visual Studio на клиентских компьютерах. Он также содержит сведения, необходимые ИТ-администратору для принятия решения о том, какие обновления нужно распространить по всей организации. Помимо этого, его можно использовать для упрощения обслуживания сетевых макетов. Пакеты обновлений администратора Visual Studio не содержат достаточно сведений для новой установки продукта, а также не содержат каких-либо фактических двоичных файлов продукта, опубликованных в сети доставки содержимого. Обновления администратора Visual Studio являются накопительными, также как и обычные обновления Visual Studio. Можно предположить, что любое обновление Visual Studio, имеющее более высокий номер версии продукта и более позднюю дату выпуска, является надмножеством более старой, более ранней версии.

Обновления администратора Visual Studio применяются к сервисным версиям Visual Studio, которые находятся на стадии поддержки. Дополнительные сведения о том, какие базовые планы обслуживания Visual Studio все еще поддерживаются в течение определенного периода времени, см. в статье [Жизненный цикл и обслуживание продуктов Visual Studio](/visualstudio/productinfo/vs-servicing-vs). Все поддерживаемые базовые планы обслуживания Visual Studio будут находиться в безопасности.  

## <a name="types-and-characteristics-of-administrator-updates"></a>Типы и характеристики обновлений администратора

В Visual Studio есть три типа обновлений администратора:

* **Обновления системы безопасности** применимы ко всем выпускам Visual Studio (например, Enterprise, Professional, Community и т. д.). Они содержат ограниченные, узконаправленные и совместимые изменения уровня обслуживания. Обновления системы безопасности не переводят клиента на более позднюю дополнительную версию. Они предназначены обеспечить исправления уязвимостей системы безопасности для клиента, у которого уже есть определенная дополнительная версия. Обновления системы безопасности будут содержать как минимум одно исправление безопасности, однако оно может входить или не входить в компонент или рабочую нагрузку, установленные на клиентском компьютере. Например, мы могли бы исправить уязвимость системы безопасности в компонентах .NET и обозначить это обновление как обновление системы безопасности, но на самом деле это не окажет никакого значимого влияния на клиентский компьютер, на котором установлены только компоненты C++. Обновления системы безопасности также могут содержать другие исправления надежности или другие необходимые обновления компонентов. Обновления системы безопасности публикуются в [каталоге Центра обновления Майкрософт](https://www.catalog.update.microsoft.com/Home.aspx) (MUC) и службе [Windows Server Update Services](/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus), где они классифицируются как "Обновления системы безопасности".
* **Обновления компонентов** позволяют ИТ-администраторам переводить компьютеры в своей организации на более позднюю дополнительную версию Visual Studio. Обновления компонентов применяются только к выпускам Visual Studio, которые зачастую встречаются на предприятиях, например к выпускам Enterprise, Professional и номерам SKU средств разработки. Все обновления компонентов будут опубликованы в каталоге Центра обновления Майкрософт как "Пакеты дополнительных компонентов". При необходимости их можно вручную [импортировать в Configuration Manager из каталога Центра обновления Майкрософт](/mem/configmgr/sum/get-started/synchronize-software-updates#import-updates-from-the-microsoft-update-catalog). Обновления компонентов являются накопительными и будут содержать дополнительные исправления качества и предыдущие исправления для системы безопасности. Ознакомьтесь с [разделом параметров конфигурации](#understanding-configuration-options) ниже, чтобы получить инструкции по настройке клиентского компьютера таким образом, чтобы он продолжал использовать базовый план обслуживания и предотвращал доставку обновлений компонентов конкретным клиентам.
* **Исправления** также применимы только к тем выпускам Visual Studio, которые обычно встречаются на предприятиях. Они содержат ограниченные, узконаправленные и совместимые изменения уровня обслуживания. Исправления не переводят клиента на более позднюю дополнительную версию. Они предназначены обеспечить исправления производительности и надежности или другие необходимые обновления компонентов для клиента, у которого уже есть определенная дополнительная версия. Исправления накапливаются вместе с обновлениями системы безопасности. Таким образом, они будут содержать исправления для системы безопасности только в том случае, если такое исправление уже было выпущено отдельно. Исправления публикуются в каталоге Центра обновления Майкрософт как "Обновления". При необходимости их можно вручную [импортировать в Configuration Manager](/mem/configmgr/sum/get-started/synchronize-software-updates#import-updates-from-the-microsoft-update-catalog).

### <a name="decoding-the-titles-of-administrator-updates"></a>Расшифровка названий обновлений администратора

Название каждого обновления администратора описывает как применимый диапазон версий, так и полученную версию обновления.Например,

::: moniker range="vs-2017"

* **Обновление Visual Studio 2017 версии с 15.9.0 до 15.9.35**, классифицированное как "Обновление системы безопасности", будет применяться к любому выпуску Visual Studio 2017 на клиенте между версиями с 15.9.0 до 15.9.35 и обновит эти клиентские выпуски до версии 15.9.35.
* **Обновление Visual Studio 2017 версии с 15.0.0 до 15.9.0**, классифицированное как "Пакет дополнительных компонентов", будет применяться к выпускам Visual Studio 2017, лицензированным для корпоративного использования, на клиенте между версиями продукта с 15.0.0 до 15.9.0 и обновит эти клиентские выпуски до версии 15.9.0. Применение этого пакета дополнительных компонентов позволяет клиентам принимать обновления для системы безопасности. 
* **Обновление Visual Studio 2017 версии с 15.9.0 до 15.9.37**, классифицированное как просто "Обновления", будет применяться к выпускам Visual Studio 2017 на клиенте между версиями с 15.9.0 до 15.9.37 и обновит эти клиентские выпуски до версии 15.9.37.

::: moniker-end

::: moniker range="vs-2019"

* **Обновление Visual Studio 2019 версии с 16.7.0 до 16.7.12**, классифицированное как "Обновление системы безопасности", будет применяться к любому выпуску Visual Studio 2019 на клиенте между версиями 16.7.0 и 16.7.12 и обновит эти клиентские выпуски до версии 16.7.12.  
* **Обновление Visual Studio 2019 версии с 16.0.0 до 16.9.0**, классифицированное как "Пакет дополнительных компонентов", будет применяться к выпускам Visual Studio 2019, лицензированным для корпоративного использования, на клиенте между всем диапазоном версий продукта с 16.0.0 до 16.9.0 и обновит эти клиентские выпуски (которые не были настроены для использования более раннего базового плана обслуживания) до версии 16.9.0. 
* **Обновление Visual Studio 2019 версии с 16.8.0 до 16.8.7**, классифицированное как просто "Обновления", будет применяться к выпускам Visual Studio 2019, лицензированным для корпоративного использования, на клиенте между версиями с 16.8.0 до 16.8.7 и обновит эти клиентские выпуски до версии 16.8.7.

::: moniker-end

::: moniker range=">=vs-2022"

::: moniker-end

## <a name="using-configuration-manager-to-deploy-visual-studio-updates"></a>Развертывание обновлений Visual Studio с помощью Configuration Manager

### <a name="understanding-configuration-options"></a>Общие сведения о параметрах конфигурации

Существует несколько параметров конфигурации, которые можно использовать для настройки обновлений администратора Visual Studio так, чтобы они были совместимы и согласованы с предпочтениями и требованиями к развертыванию в вашей организации. Ниже перечислены наиболее распространенные параметры конфигурации. Полный список всех поддерживаемых параметров обновления администратора см. в статье [Использование параметров командной строки для установки Visual Studio](../install/use-command-line-parameters-to-install-visual-studio.md) и обратите внимание только на те, которые соответствуют действию "Обновить".

* **[Согласие на использование обновления администратора](../install/enabling-administrator-updates.md#encoding-administrator-intent-on-the-client-machines)** . Этот раздел реестра необходим для того, чтобы клиентский компьютер мог получать обновления администратора. Это ключ на уровне компьютера, который означает, что он применяется ко всем экземплярам Visual Studio, установленным на компьютере.
* **Отказ пользователя Visual Studio**. Пользователи Visual Studio могут использовать отдельный раздел реестра **AdministratorUpdatesOptOut** на уровне компьютера, чтобы *отказаться* от получения обновлений администратора Visual Studio. Этот раздел позволяет пользователю Visual Studio в некоторой степени контролировать автоматическое применение обновлений к компьютеру. Чтобы настроить на клиентском компьютере блокировку обновлений администратора, установите для ключа REG_DWORD  **AdministratorUpdatesOptOut**  значение  **1**. Отсутствие ключа или установленное значение  **0** означает, что пользователь Visual Studio хочет получать обновления администратора для Visual Studio.
    Обратите внимание, что раздел  **AdministratorUpdatesOptOut**  для кодирования предпочтений разработчика имеет приоритет над разделом  **AdministratorUpdatesEnabled** , который кодирует намерение ИТ-администратора. Если для ключа  **AdministratorUpdatesOptOut**  установлено значение  **1**, обновление будет заблокировано на клиенте, даже если для ключа  **AdministratorUpdatesEnabled**  также установлено значение  **1**.При этом действии предполагается, что ИТ-администраторы могут получить доступ к сведениям о том, какие разработчики решили отказаться, и отслеживать эти сведения, а затем обе стороны могут обсудить, чьи потребности более важны.При необходимости ИТ-администраторы всегда могут изменить любой ключ.
* **Location of the updated product bits** (Расположение обновленных фрагментов продукта). В большинстве случаев клиентские компьютеры загружают обновленные фрагменты продукта из Интернета через сеть Microsoft CDN. В этом сценарии клиентские компьютеры должны иметь доступ к сети Интернет. На некоторых предприятиях, однако, клиентские компьютеры ограничивают установкой и обновлением фрагментов только из расположения сетевого макета. Чтобы гарантировать применение обновлений администратора с помощью обновленных компонентов, находящихся во внутренней сетевой папке, необходимо выполнить следующие условия, прежде чем можно будет успешно развертывать обновление администратора. 
  * На клиентском компьютере уже должен быть запущен начальный загрузчик из этого расположения макета сети. В идеале исходную установку клиента следует выполнить с помощью начального загрузчика из макета сети, но можно также просто установить обновление с помощью обновленного загрузчика в этом же сетевом расположении. Любое из этих действий приведет к установке на клиентском компьютере подключения к этому конкретному расположению макета.
  * Расположение макета сети (к которому подключен клиент) необходимо обновить так, чтобы оно [содержало обновленные компоненты продукта](../install/update-a-network-installation-of-visual-studio.md), которые необходимо развернуть с помощью обновления администратора.

::: moniker range=">=vs-2019"

* **Закрепление базового уровня обслуживания**. Как указано выше, обновления компонентов администратора переводят установку Visual Studio на более позднюю версию с более высоким дополнительным номером. Но иногда пользователи Visual Studio предпочитают оставаться на конкретной версии, чтобы иметь стабильный и защищенный базовый уровень обслуживания и контролировать, когда переводить компьютер на более актуальную. Для настройки клиентского компьютера таким образом, чтобы он сохранял определенный уровень обслуживания и пропускал отправляемые ему нежелательные обновления компонентов администратора, необходимо создать параметр данных **BaselineStickinessVersions2019** типа Reg_SZ и назначить ему строковое значение, соответствующее предпочитаемому базовому уровню, к которому нужно привязать компьютер. Строка может содержать допустимую версию базового уровня обслуживания, например **16.7.0**.  
     Если указать значение реестра `BaselineStickinessVersions2019` в неверном формате, установка любых обновлений компонентов администратора на компьютере будет заблокирована. Обязательно обратите внимание на [поддерживаемые сроки для обновления компонентов Visual Studio](/visualstudio/productinfo/vs-servicing-vs). Кроме того, вне зависимости от наличия или значения ключа `BaselineStickinessVersions2019`, даже хотя существует техническая возможность устанавливать обновления компонентов администратора, жизненный цикл которых завершен, мы не рекомендуем делать это, потому что такие обновления не поддерживаются и потенциально небезопасны.

::: moniker-end

* **Force the update to occur even if Visual Studio is in use** (Принудительно запускать обновление, даже если Visual Studio используется). Перед установкой обновления Visual Studio необходимо закрыть. Если среда Visual Studio открыта или используется, установка обновления будет прервана. Простой способ убедиться, что среда Visual Studio закрыта, — настроить диспетчер подтверждений для применения обновления сразу после перезагрузки компьютера. Для принудительного завершения работы Visual Studio также можно использовать параметр `--force`. Принудительное завершение работы Visual Studio может привести к потере работы, поэтому используйте этот процесс с осторожностью. При запуске обновления администратора в стандартном контексте системы флаг `–-force` будет проигнорирован, поэтому потребуется настроить обновление администратора для запуска в контексте пользователя.

### <a name="methods-for-configuring-an-administrator-update"></a>Способы настройки обновления администратора

Существует три основных способа настройки обновлений администратора: раздел реестра, файл конфигурации на клиентском компьютере или изменение самого пакета развертывания Configuration Manager.   

* **Раздел реестра**. Обновления администратора ищут определенные разделы реестра в любом из стандартных расположений Visual Studio, как описано в статье [Настройка параметров по умолчанию для корпоративного развертывания](../install/set-defaults-for-enterprise-deployments.md). Параметры, которыми управляет раздел реестра, — это такие элементы, как **AdministratorUpdatesOptOut** Reg_DWORD, **AdministratorUpdatesOptOut**   Reg_DWORD и **BaselineStickinessVersions2019 Reg_SZ**. Чтобы создать и установить значения разделов реестра, требуется доступ администратора на клиентском компьютере.

* **Файл конфигурации**. Некоторые параметры можно сохранить на клиентском компьютере в дополнительном файле конфигурации. Его преимущество заключается в том, что он устанавливается только один раз и применяется ко всем будущим обновлениям администратора. Подход с использованием файла конфигурации схож с применением раздела реестра и распространяется на весь компьютер. Это означает, что файл будет применяться ко всем установкам Visual Studio, установленным на клиентском компьютере. Стандартное расположение файла конфигурации: `C:\ProgramData\Microsoft\VisualStudio\updates.config`. Однако, чтобы использовать другое расположение для хранения файла, создайте раздел реестра Reg_SZ с именем **UpdateConfigurationFile** и установите в качестве значения этого раздела путь к вашему файлу конфигурации. Этот раздел реестра можно разместить в любом расположении реестра Visual Studio, как описано в статье [Настройка параметров по умолчанию для корпоративного развертывания](../install/set-defaults-for-enterprise-deployments.md). Если вы решите добавить значение реестра для расположения настраиваемого файла конфигурации, оно будет искать этот файл. Если файл не существует, будет создано исключение и обновление завершится ошибкой.

     Файл конфигурации, находящийся в формате JSON, поддерживает параметр `installerUpdateArgs`. Это параметр представляет собой массив строк, разделенных запятыми, которые указывают дополнительные параметры, которые вы можете передать в установщик Visual Studio. Если в содержимом файла есть недопустимое поле или параметр, который не поддерживается, обновление завершится ошибкой. Дополнительные сведения см. в статье [Использование параметров командной строки для установки Visual Studio](../install/use-command-line-parameters-to-install-visual-studio.md).

   Вот пример файла конфигурации:

  ```json
  "installerUpdateArgs" : ["--quiet", "--noWeb"], 
  "checkPendingReboot" :  "true" 
  ```

* **Обновление пакета обновлений администратора в SCCM вручную**. Параметры командной строки отдельного пакета обновлений администратора в SCCM также можно изменить вручную.

## <a name="verification-reports-and-troubleshooting-error-codes"></a>Коды ошибок проверки, отчетов и устранения неполадок

### <a name="determining-that-visual-studio-was-updated"></a>Определение обновления Visual Studio

Чтобы проверить правильность установки обновления администратора, вы можете использовать один из приведенных ниже методов.

* На клиентском компьютере запустите Visual Studio, выберите  **Справка** > **О программе** и убедитесь, что номер версии совпадает с последним номером в названии предполагаемого обновления.
* Используйте инструмент **vswhere** на клиентском компьютере, чтобы определить различные версии Visual Studio на компьютере. Дополнительные сведения см. в статье  [Средства для обнаружения экземпляров Visual Studio и управления ими](../install/tools-for-managing-visual-studio-instances.md).
* При каждой попытке применения административного обновления создается несколько файлов журнала в каталоге `%temp%` клиентского компьютера, которые фиксируют ход операции обновления.Отсортируйте папку по дате и ищите файлы, которые начинаются на  `dd_updatedriver`,  `dd_bootstrapper`,  `dd_client` и  `dd_setup`  для административных обновлений, начального загрузчика, Visual Studio Installer и программы установки соответственно.Убедитесь, что в этих файлах журнала содержится значение 0, означающее, что обновление было успешно применено. Обратите внимание, что эти файлы журнала также можно использовать для проверки использования файла конфигурации. Дополнительные сведения см. на странице [Средство сбора журналов для Visual Studio](https://www.microsoft.com/download/details.aspx?id=12493).

### <a name="error-codes-and-conditions"></a>Коды ошибок и их условия

>[!IMPORTANT]
> Не забывайте, что перед установкой обновления необходимо закрыть Visual Studio. Если среда Visual Studio открыта или используется, процесс установки обновления будет отменен.

Административные обновления могут возвращать приведенные ниже коды возврата.  

| Код ошибки | Определение                                                                                                                                                                                                  |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0          | Административное обновление было успешно установлено.                                                                                                                                                       |
| 1001       | Запущены Visual Studio Installer или связанный процесс установки. Обновление не применяется.                                                                                                                   |
| 1002       | Надстройка Visual Studio Installer приостановлена. Обновление не применяется.                                                                                                                                               |
| 1003       | Среда Visual Studio запущена. Обновление не применяется. Это условие можно переопределить с помощью флага `--force`.                                                                                              |
| 1004       | Подключение к Интернету не обнаружено.Обновлению не удалось связаться с расположением в Интернете, в котором хранятся обновленные файлы. Обновление не применяется.                                                                          |
| 1005       | Для параметра реестра  **AdministratorUpdatesEnabled**  задано значение **0** или не задано вообще. Обновление не применяется.                                                                                            |
| 1006       | Для параметра реестра  **AdministratorUpdatesOptOut**  задано значение **1**. Обновление не применяется. Ключ предназначен для клиентских компьютеров, которые не должен обновлять администратор.                     |
| 1007       | Надстройка Visual Studio Installer не установлена.                                                                                                                                                               |
| 1008       | Значение реестра **BaselineStickinessVersions2019** имеет непонятный формат. Значение реестра должно включать в себя слово **All** или допустимые версии с явно заданным номером сборки 0, например X.Y.0. |
| 3010       | Требуется перезагрузить систему.Обновление могло быть применено или не применено. Перезагрузите компьютер и повторите попытку обновления.                                                                                |
| Другое      | При попытке применить обновление произошла ошибка.Обновление не применяется.                                                                                                                                   |

Полный список кодов ошибок клиентов см. в статье  [Использование параметров командной строки для установки Visual Studio](use-command-line-parameters-to-install-visual-studio.md).

## <a name="feedback-and-support"></a>Отзывы и поддержка

[!INCLUDE[install_get_support_md](includes/install_get_support_md.md)]

Вы можете использовать приведенные ниже методы, чтобы оставить отзыв об обновлениях администратора Visual Studio или сообщить о проблемах, которые влияют на обновления.

* Ознакомьтесь с руководством [Устранение неполадок при установке и обновлении Visual Studio](../install/troubleshooting-installation-issues.md).
* Задавайте вопросы в сообществе на [форуме вопросов и ответов по настройке Visual Studio](/answers/topics/vs-setup.html).
* Перейдите на [страницу поддержки Visual Studio](https://visualstudio.microsoft.com/vs/support/) и проверьте, указана ли ваша проблема в разделе с часто задаваемыми вопросами.  Вы также можете получить помощь в чате, нажав кнопку [Ссылка на службу поддержки](https://visualstudio.microsoft.com/vs/support/#talktous).
* [Отправьте отзыв о возможностях или сообщите о проблеме](https://aka.ms/vs/wsus/feedback), касающейся применения обновлений администратора, команде Visual Studio.
* Свяжитесь с менеджером по технической поддержке вашей организации для корпорации Майкрософт.

## <a name="see-also"></a>См. также раздел

* [Включение обновлений администратора](../install/enabling-administrator-updates.md)
* [Руководство администратора Visual Studio](../install/visual-studio-administrator-guide.md)
* [Жизненный цикл и обслуживание продуктов Visual Studio](/visualstudio/productinfo/vs-servicing-vs)
* [Заметки о выпуске Visual Studio 2019](/visualstudio/releases/2019/release-notes)
* [Заметки о выпуске Visual Studio 2017](/visualstudio/releasenotes/vs2017-relnotes)
* [Установка Visual Studio](../install/install-visual-studio.md)
* [Использование параметров командной строки для установки Visual Studio](../install/use-command-line-parameters-to-install-visual-studio.md)
* [Средства для обнаружения экземпляров Visual Studio и управления ими](../install/tools-for-managing-visual-studio-instances.md)
* [Создание сетевой установки Visual Studio](../install/create-a-network-installation-of-visual-studio.md)
* [Как определить параметры в файле ответов](../install/automated-installation-with-response-file.md)
* [Управление обновлением сетевых развертываний Visual Studio](../install/controlling-updates-to-visual-studio-deployments.md)
* [Часто задаваемые вопросы о каталоге Центра обновления Майкрософт](https://www.catalog.update.microsoft.com/faq.aspx)
* [Документация по Microsoft Endpoint Configuration Manager (SCCM)](/mem/configmgr)
* [Импорт обновлений из каталога Майкрософт в Configuration Manager](/mem/configmgr/sum/get-started/synchronize-software-updates#import-updates-from-the-microsoft-update-catalog)
* [Документация по Windows Server Update Services (WSUS)](/windows-server/administration/windows-server-update-services/get-started-windows-server-update-services-wsus)
