---
title: Система управления версиями Team Foundation (TFVC)
description: Подключение Visual Studio для Mac к Team Foundation Server или Azure DevOps с использованием системы управления версиями Team Foundation (TFVC).
author: heiligerdankgesang
ms.author: dominicn
ms.date: 06/25/2019
ms.technology: vs-ide-general
ms.assetid: 52D3D26A-4D01-4FD1-AAA1-AE7D7BD39746
ms.topic: troubleshooting
ms.openlocfilehash: b9aa9b718ad4618502a58185c27333d689c74300
ms.sourcegitcommit: fcfd0fc7702a47c81832ea97cf721cca5173e930
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2020
ms.locfileid: "97729383"
---
# <a name="connecting-to-team-foundation-version-control"></a>Подключение к системе управления версиями Team Foundation

> [!NOTE]
> Для получения наилучших результатов управления версиями в macOS вместо системы управления версиями Team Foundation (TFVC) рекомендуется использовать Git. Git поддерживается в Visual Studio для Mac и является параметром по умолчанию для репозиториев, размещенных в Team Foundation Server (TFS) или Azure DevOps. Дополнительные сведения об использовании Git с TFS или Azure DevOps см. в статье [Настройка репозитория Git](./set-up-git-repository.md).
>
> Если вы ранее использовали предварительную версию расширения TFVC для Visual Studio для Mac, после обновления до Visual Studio 2019 для Mac оно больше не будет поддерживаться.

Azure Repos предоставляет две модели управления версиями: [Git](/azure/devops/repos/git/?view=azure-devops&preserve-view=true), распределенную систему контроля версий, и [систему управления версиями Team Foundation](/azure/devops/repos/tfvc/index?view=azure-devops&preserve-view=true) (TFVC), централизованную систему контроля версий.

Visual Studio для Mac обеспечивает полную поддержку репозиториев Git, но требует некоторых обходных путей для работы с TFVC. Если на сегодняшний день для управления версиями вы используете TFVC, ниже приведены несколько решений, которые можно использовать для доступа к исходному коду, размещенному в TFVC:

* [Использование Visual Studio Code и расширения Azure Repos для графического пользовательского интерфейса.](#use-visual-studio-code-and-the-azure-repos-extension)
* [Подключение к репозиторию с помощью клиента командной строки Team Explorer Everywhere (TEE-CLC).](#connecting-using-the-team-explorer-everywhere-command-line-client)
* [Подключение к системе управления версиями Team Foundation с помощью расширения Visual Studio для Mac (не поддерживаемого).](#connect-to-tfvc-using-the-team-foundation-version-control-extension)

Перечисленные выше параметры будут рассмотрены в последующих разделах этой статьи.

## <a name="requirements"></a>Требования

* Visual Studio Community, Professional или Enterprise для Mac версии 7.8 или более поздней.
* Azure DevOps, Team Foundation Server 2013 или более поздней версии или Azure DevOps Services 2018 или более поздней версии.
* Проект в Azure DevOps или Team Foundation Server и Azure DevOps Server, настроенный на использование системы управления версиями Team Foundation.

## <a name="use-visual-studio-code-and-the-azure-repos-extension"></a>Использование Visual Studio Code и расширения Azure Repos

Если вы предпочитаете работать с графическим интерфейсом для управления файлами в системе управления версиями, в таком случае корпорация Майкрософт предоставляет поддерживаемое решение для расширения Azure Repos для Visual Studio Code. Чтобы приступить к работе, загрузите [Visual Studio Code](https://code.visualstudio.com) и узнайте, как [настроить расширение Azure Repos](https://marketplace.visualstudio.com/items?itemName=ms-vsts.team).

## <a name="connecting-using-the-team-explorer-everywhere-command-line-client"></a>Подключение с помощью клиента командной строки Team Explorer Everywhere

Если вы предпочитаете использовать Терминал macOS, в таком случае клиент командной строки Team Explorer Everywhere (TEE-CLC) предоставит поддерживаемый способ подключения к вашему источнику в TFVC.

Чтобы настроить подключение к TFVC и зафиксировать изменения, вы можете выполнить следующие шаги.

### <a name="setting-up-the-tee-clc"></a>Настройка TEE-CLC

Существует два способа настройки TEE-CLC.

* Использовать Homebrew для установки клиента или
* загрузить и установить клиент вручную.

Самым простым решением является **использование Homebrew**, диспетчера пакетов для macOS. Установка с помощью этого метода.

1. Запустите приложение Терминала macOS.
1. Установите Homebrew с помощью Терминала и инструкции на [главной странице Homebrew](https://brew.sh/).
1. После этого выполните следующую команду из Терминала: `brew install tee-clc`

Чтобы **настроить TEE-CLC вручную** выполните следующее.

1. [Загрузите последнюю версию TEE-CLC](https://github.com/Microsoft/team-explorer-everywhere/releases) на странице выпусков репозитория Team Explorer Everywhere на GitHub (например, на момент написания этой статьи — это tee-clc-14.134.0.zip).
1. Извлеките содержимое ZIP-файла в папку на диске.
1. Откройте приложение Терминала macOS и используйте команду `cd`, чтобы перейти в папку, которую вы использовали на предыдущем шаге.
1. Выполните команду `./tf` в папке, чтобы проверить рабочее состояние клиента командной строки. Вам может быть предложено установить Java или другие зависимости.

После установки TEE-CLC вы можете выполнить команду `tf eula`, чтобы просмотреть и принять лицензионное соглашение для клиента.

Наконец, для проверки подлинности в вашей среде TFS или Azure DevOps вам необходимо создать личный маркер доступа на сервере. Просмотрите дополнительные сведения о [проверке подлинности с помощью личных маркеров доступа](/azure/devops/integrate/get-started/authentication/pats?view=azure-devops&preserve-view=true). При создании личного маркера доступа для использования с TFVC во время его настройки предоставьте полный доступ.

### <a name="using-the-tee-clc-to-connect-to-your-repo"></a>Использование TEE-CLC для подключения к репозиторию

Чтобы подключиться к исходному коду, необходимо сначала создать рабочую область с помощью команды `tf workspace`. Например, следующие команды подключаются к организации в Azure DevOps, которая называется MyOrganization. 

```bash
export TF_AUTO_SAVE_CREDENTIALS=1
tf workspace -new MyWorkspace -collection:https://dev.azure.com/MyOrganization
```

Параметр среды `TF_AUTO_SAVE_CREDENTIALS` используется для сохранения учетных данных, поэтому их не нужно будет вводить несколько раз. При запросе имени пользователя используйте личный маркер доступа, который был создан в предыдущем разделе, и пустой пароль.

Для создания сопоставления исходных файлов с локальной папкой используйте команду `tf workfold`. В следующем примере будет сопоставлена ​​папка с именем WebApp.Services из проекта TFVC MyRepository и настроена для копирования в локальную папку ~/Projects/ (то есть в папку Projects в домашней папке текущих пользователей).

```bash
tf workfold -map $/MyRepository/WebApp.Services -workspace:MyWorkspace ~/Projects/
```

Наконец используйте следующую команду для получения исходных файлов с сервера и скопируйте их локально.

```bash
tf get
```

### <a name="committing-changes-using-the-tee-clc"></a>Фиксация изменений с помощью TEE-CLC

После внесения изменений в файлы Visual Studio для Mac можно вернутся обратно в окно Терминала для возврата изменений. Команда `tf add` используется для добавления файлов в список ожидающих изменений для возврата, а команда `tf checkin` выполняет фактический возврат к серверу. Команда `checkin` содержит параметры для добавления комментария или сопоставления связанного с ним рабочего элемента. В следующем фрагменте кода все файлы в папке `WebApp.Services` рекурсивно добавляются для возврата после изменений. Затем код проверяется с помощью комментария и связывается с рабочим элементом, который имеет идентификатор "42".

```bash
cd WebApp.Services
tf add * /recursive
tf checkin -comment:"Replaced 'Northwand' typos with the correct word Northwind" -associate:42
```

Чтобы узнать больше об этих или других командах, используйте следующую команду Терминала.

`tf help`

## <a name="connect-to-tfvc-using-the-team-foundation-version-control-extension"></a>Подключение к TFVC с помощью расширения системы управления версиями Team Foundation

> [!NOTE]
> Для получения наилучших результатов управления версиями в macOS вместо системы управления версиями Team Foundation (TFVC) рекомендуется использовать Git. Git поддерживается в Visual Studio для Mac и является параметром по умолчанию для репозиториев, размещенных в Team Foundation Server (TFS) или Azure DevOps. Дополнительные сведения об использовании Git с TFS или Azure DevOps см. в статье [Настройка репозитория Git](./set-up-git-repository.md).
>
> Если вы ранее использовали предварительную версию расширения TFVC для Visual Studio для Mac, после обновления до Visual Studio 2019 для Mac оно больше не будет поддерживаться.

В коллекции Visual Studio для Mac есть расширение системы управления версиями Team Foundation, которое предлагает ограниченную поддержку для подключения к TFVC. Расширение не поддерживается и имеет несколько известных проблем, поэтому при его использовании ваша работа может отличаться.

Чтобы установить расширение, запустите Visual Studio для Mac и выберите меню **Visual Studio > Расширения**. На вкладке **Gallery** выберите **Version Control > Team Foundation Version Control for TFS and Azure DevOps** и щелкните **Установить...**.

![Диспетчер расширений](media/tfvc-install.png)

Следуйте инструкциям для установки расширения. После установки перезапустите интегрированную среду разработки.

### <a name="updating-the-extension"></a>Обновление расширения

Обновления для расширения TFVC выходят периодически. Для доступа к ним выберите **Visual Studio > Расширения...** в меню и откройте вкладку **Обновления**. Выберите расширение в списке и нажмите кнопку **Обновить**:

Нажмите кнопку **Установить** в следующем диалоговом окне, чтобы удалить старый пакет и установить новый.

### <a name="using-the-extension"></a>Использование расширения

После установки расширения в меню выберите **Version Control > TFS/Azure DevOps > Open from Remote Repository...**.

![Элемент меню, чтобы открыть расширение](media/tfvc-source-control-explorer-devops.png)

Вначале выберите VSTS или Team Foundation Server и нажмите кнопку **Продолжить**:

![Соединение с сервером](media/tfvc-choose-server-type-devops.png)

#### <a name="azure-repos-authentication"></a>Проверка подлинности Azure Repos

При выборе проекта, размещенного в Azure Repos, вам предлагается ввести сведения о своей учетной записи Майкрософт:

![Подключение к Azure Repos](media/tfvc-vsts-login.png)

#### <a name="tfs-authentication"></a>Проверка подлинности TFS

Чтобы подключиться к TFS, введите сведения о сервере и свои учетные данные. Введите домен для использования проверки подлинности NTLM, в противном случае оставьте поле пустым, чтобы использовать обычную проверку подлинности. Выберите **Добавить сервер**.

![Вход на сервер TFS](media/tfvc-login.png)

### <a name="selecting-a-project"></a>Выбор проекта

Успешно пройдя проверку подлинности, вы можете просмотреть список репозиториев, которые связаны с этой учетной записью, в диалоговом окне **Открыть из системы управления версиями**:

![Диалоговое окно "Открыть из системы управления версиями" с отображаемыми проектами](media/tfvc-vsts-projects.png)

Это диалоговое окно упорядочено по следующим узлам:

- Организация или коллекция Azure DevOps — отображает все организации, подключенные к учетной записи Майкрософт, под которой вы вошли в систему.
- Проекты — в каждой организации или коллекции может быть несколько проектов. В проекте размещены исходный код, рабочие элементы и автоматические сборки.

На этом этапе вы можете выполнять поиск и фильтрацию по имени проекта или организации.

#### <a name="adding-a-new-server"></a>Добавление нового сервера

Чтобы добавить новый сервер в список, нажмите кнопку **Добавить узел** в диалоговом окне **Открыть из системы управления версиями**:

![Выделенная кнопка для добавления нового сервера в список](media/tfvc-add-new-server.png)

Выберите поставщика из списка и введите свои учетные данные:

![Диалоговое окно с параметром для поставщика системы управления версиями](media/tfvc-add-new-creds-devops.png)

### <a name="creating-a-new-workspace"></a>Создание новой рабочей области

Чтобы приступить к работе с проектом, нужна _рабочая область_. Если у вас нет рабочей области, ее можно создать в поле со списком **Рабочая область** в диалоговом окне **Открыть из системы управления версиями**:

![Параметр "Создание новой рабочей области" в поле со списком](media/tfvc-create-new-workspace.png)

Задайте имя и локальный путь для новой рабочей области и выберите **Создание рабочей области**:

![Ввод имени и локального пути для новой рабочей области](media/tfvc-local-workspace.png)

### <a name="using-the-source-code-explorer"></a>Использование обозревателя исходного кода

Создав рабочую область и сопоставив ее с проектом, можно приступать к работе с _обозревателем исходного кода_.

Чтобы открыть обозреватель исходного кода, выберите пункт меню **Управление версиями > TFS/Azure DevOps > Обозреватель управления исходным кодом**.

Обозреватель исходного кода позволяет перемещаться по всем сопоставленным проектам, файлам и папкам. Он также позволяет выполнять все основные действия системы управления версиями, такие как:

- Получение последней версии
- Получение конкретной версии
- Извлечение и возврат файлов
- Блокировка и разблокировка файлов
- Добавление, удаление и переименование файлов
- Просмотр истории
- Сравнивать изменения.

Многие из этих действий доступны посредством контекстных действий с проектом:

![Действия контекстного меню для проекта](media/tfvc-sourcecode-actions.png)

### <a name="managing-workspaces"></a>Управление рабочими областями

Если вы еще не создали рабочую область, как описано в разделе [Создание рабочей области](#creating-a-new-workspace), обозреватель исходного кода будет пуст:

![Пустой обозреватель исходного кода](media/tfvc-setup-empty-sce.png)

Чтобы настроить для удаленного проекта локальную рабочую область, сделайте следующее:

1. Выберите **Сервер** в поле со списком.
1. Обратите внимание на то, что "рабочих областей нет", а локальный путь — "Не сопоставлен". Выберите ссылку **Не сопоставлен**, чтобы открыть диалоговое окно **Создание новой рабочей области**.
1. Укажите имя рабочей области и нажмите кнопку **Добавить рабочую папку**, чтобы привязать к проекту локальную папку на компьютере.

    ![Диалоговое окно "Создание новой рабочей области", показывающее параметры по умолчанию](media/tfvc-workspace1.png)

1. Выберите папку "$" для сопоставления всех проектов на сервере с одной рабочей областью или выберите отдельный проект и нажмите кнопку **ОК**:

    ![Диалоговое окно "Поиск папки", показывающее все проекты](media/tfvc-workspace2.png)

1. Выберите расположение на локальном компьютере, с которым вы хотите сопоставить проекты, а затем нажмите кнопку **Выбрать папку**.
1. Подтвердите сведения о новой рабочей области, нажав кнопку **ОК**.

    ![Диалоговое окно "Создание новой рабочей области" с добавленной рабочей папкой](media/tfvc-workspace3.png)

После настройки рабочей области ее можно изменить или удалить, нажав кнопку **Управление рабочими областями** в обозревателе исходного кода.

![Управление рабочими областями](media/tfvc-workspace4.png)

## <a name="troubleshooting-and-known-issues"></a>Устранение неполадок и известные проблемы

#### <a name="problems-using-basic-authentication"></a>Проблемы при использовании обычной проверки подлинности

Для проверки подлинности связи с сервером можно использовать следующие параметры:

- OAuth
- Базовый
- Ntlm

Для использования обычной проверки подлинности нужно включить **альтернативные учетные данные** в Azure DevOps Services, выполнив следующие действия:

1. Войдите в Azure DevOps своей организации с правами владельца (https:\//dev.azure.com/ваша_организация/имя_проекта).

2. На панели инструментов организации нажмите на значок шестеренки и выберите пункт **Политика**:

    ![Снимок экрана: панель инструментов организации в Azure DevOps с нажатым значком шестеренки, а также политика, выбранная в раскрывающемся меню.](media/tfvc-auth2.png)

3. Проверьте параметры подключения для приложения. Измените эти параметры в зависимости от политик безопасности:

    ![Снимок экрана: экран "Политика" в Azure DevOps Services с параметрами для политик подключения приложения.](media/tfvc-auth.png)

#### <a name="i-do-not-see-anything-in-tfvc"></a>В TFVC ничего не отображается

Для настройки системы управления версиями Team Foundation (TFVC) на компьютере разработки **необходимо** создать рабочую область, как описано в разделе [Управление рабочими областями](#managing-workspaces).

В обозревателе управления исходным кодом нажмите кнопку **Управление рабочими областями**. Выполните процедуру по сопоставлению проекта с папкой на компьютере разработки.

#### <a name="i-do-not-see-any--all-of-my-projects"></a>Я не вижу свои проекты (все или некоторые)

После проверки подлинности вы должны увидеть список проектов. По умолчанию отображаются только проекты TFS. Для просмотра других типов проектов установите флажок "Показать все проекты".

Имейте в виду, что проекты, которые находятся на сервере, не будут отображаться, если у вас нет нужных привилегий.

##### <a name="i-am-getting-the-error-cannot-create-the-workspace-please-try-again"></a>Выводится ошибка "Не удается создать рабочую область. Повторите попытку"

При попытке [создать рабочую область](#creating-a-new-workspace) необходимо убедиться в том, что выполняются следующие условия:

- в имени рабочей области не используются недопустимые символы;
- максимальная длина имени — 64 символа;
- локальный путь не может использоваться другими рабочими областями.

### <a name="see-also"></a>См. также

- [Разработка и совместное использование кода в TFVC с использованием Visual Studio (в Windows)](/azure/devops/repos/tfvc/share-your-code-in-tfvc-vs)